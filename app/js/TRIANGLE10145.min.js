"use strict";var TRIANGLE=TRIANGLE||{},i=0,j=0,k=0,x=0,y=0,z=0;function hex2dec(e){console.log(parseInt(e,16))}function dec2hex(e){console.log(e.toString(16))}TRIANGLE.version="1.01.45",TRIANGLE.images={load:function(){AJAX.get("scripts/imageList.php","",function(e){document.getElementById("echoImageList").innerHTML=e.responseText})},insert:function(e){if(TRIANGLE.item){if(TRIANGLE.isType.imageItem(TRIANGLE.item.objRef))return TRIANGLE.item.image.src=e.replace(/http(s?):\/\//g,"//"),TRIANGLE.item.image.style.width="100%",TRIANGLE.item.image.style.height="auto",TRIANGLE.item.image.style.margin="",TRIANGLE.item.objRef.style.overflow="",TRIANGLE.item.objRef.style.height="auto",TRIANGLE.item.objRef.style.minHeight="auto",TRIANGLE.item.objRef.removeAttribute("crop-map"),TRIANGLE.item.objRef.removeAttribute("crop-ratio"),TRIANGLE.selectionBorder.update(),TRIANGLE.importItem.single(TRIANGLE.item.index),void TRIANGLE.menu.closeSideMenu();if(!TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef))if(TRIANGLE.images.setBackground)TRIANGLE.item.objRef.style.backgroundImage="url('"+e+"')",TRIANGLE.item.objRef.style.backgroundSize="cover",TRIANGLE.item.objRef.style.backgroundRepeat="no-repeat",TRIANGLE.item.objRef.style.backgroundPosition="center top",TRIANGLE.images.setBackground=!1,TRIANGLE.updateTemplateItems();else{TRIANGLE.isType.containsNbsp(TRIANGLE.item.objRef)&&TRIANGLE.stripNbsp(TRIANGLE.item.objRef),(i=document.createElement("div")).className="templateItem childItem imageItem",i.style.display="inline-block",i.style.height="auto",i.style.minHeight="auto",i.style.width="auto",i.style.maxWidth="100%",(n=document.createElement("img")).src=e,n.style.width="100%",n.style.height="auto",TRIANGLE.checkPadding(TRIANGLE.item.objRef),i.appendChild(n),TRIANGLE.item.append(i),TRIANGLE.selectionBorder.update(),TRIANGLE.updateTemplateItems();var t=TRIANGLE.item.objRef.children.length,o=TRIANGLE.item.objRef.children[t-1].getAttribute("index");TRIANGLE.importItem.single(o)}}else{var i,n;if(TRIANGLE.images.setBackground)document.getElementById("bodyBgData").style.backgroundImage=document.body.style.backgroundImage="url('"+e+"')",document.getElementById("bodyBgData").style.backgroundRepeat=document.body.style.backgroundRepeat="repeat",TRIANGLE.updateTemplateItems();else(i=document.createElement("div")).className="templateItem childItem imageItem",i.style.display="inline-block",i.style.height="auto",i.style.minHeight="auto",i.style.width="auto",i.style.maxWidth="100%",(n=document.createElement("img")).src=e,n.style.width="100%",n.style.height="100%",i.appendChild(n),document.getElementById("template").appendChild(i),TRIANGLE.updateTemplateItems(),TRIANGLE.importItem.single(TRIANGLE.templateItems.length-1)}TRIANGLE.menu.closeSideMenu()},setBackground:!1,removeBackground:function(){TRIANGLE.item?(TRIANGLE.item.objRef.style.backgroundImage="",TRIANGLE.item.objRef.style.backgroundSize=""):document.getElementById("bodyBgData").style.backgroundImage=document.body.style.backgroundImage=document.getElementById("bodyBgData").style.backgroundRepeat=document.body.style.backgroundRepeat=""},crop:{toggleMenu:function(){var e=document.getElementById("cropImageMenu");"none"===e.style.display?e.style.display="block":e.style.display="none"},active:!1,transferImage:function(){var e=TRIANGLE.item.objRef.getBoundingClientRect(),t=TRIANGLE.item.image,o=t.cloneNode(),i=TRIANGLE.item.image.getBoundingClientRect(),n=document.getElementById("cropImageContainer"),r=document.getElementById("cropImageHandles"),l=window.innerWidth-TRIANGLE.scrollbarWidth,s=window.innerHeight;if(TRIANGLE.item.cropMap)var a=TRIANGLE.item.cropMap.split(",")[0],d=TRIANGLE.item.cropMap.split(",")[1],m=TRIANGLE.item.cropMap.split(",")[2],c=TRIANGLE.item.cropMap.split(",")[3];n.style.marginTop=(s-504)/2+"px",document.getElementById("cropImageBg").style.backgroundImage="url('"+t.src+"')",r.innerHTML="",r.appendChild(o),o=r.children[0];var I=500,E=500,p=e.width/i.width,R=e.height/i.height;i.width>i.height?(E*=i.height/i.width,o.style.marginLeft=m||"",o.style.marginTop=c||"",o.style.width=I+"px",o.style.height=E+"px",r.style.width=p*I+2+"px",r.style.maxWidth=I+2+"px",r.style.height=R*E+2+"px",r.style.maxHeight=E+2+"px",r.style.left=a||"",r.style.top=d||s/2-E/2-1+"px"):i.width<i.height?(I*=i.width/i.height,o.style.marginLeft=m||"",o.style.marginTop=c||"",o.style.width=I+"px",o.style.height=E+"px",r.style.width=p*I+2+"px",r.style.maxWidth=I+2+"px",r.style.height=R*E+2+"px",r.style.maxHeight=E+2+"px",r.style.top=d||"",r.style.left=a||l/2-I/2-1+"px"):(o.style.marginLeft=m||"",o.style.marginTop=c||"",o.style.width=I+"px",o.style.height=E+"px",r.style.width=p*I+2+"px",r.style.maxWidth=I+2+"px",r.style.height=R*E+2+"px",r.style.maxHeight=E+2+"px",r.style.top=d||"",r.style.left=a||"")},showHandles:function(){document.getElementById("cropImageContainer");var e=document.getElementById("cropImageHandles").getBoundingClientRect(),t=(window.innerWidth,TRIANGLE.scrollbarWidth,window.innerHeight,document.getElementsByClassName("cropHandle"));for(i=0;i<t.length;i++)t[i].style.display="block";document.getElementById("cropTopLeft").style.left=e.left-4-1+"px",document.getElementById("cropTopLeft").style.top=e.top-4-2+"px",document.getElementById("cropTopMid").style.left=e.left+e.width/2-4+"px",document.getElementById("cropTopMid").style.top=document.getElementById("cropTopLeft").style.top,document.getElementById("cropTopRight").style.left=e.right-4+1+"px",document.getElementById("cropTopRight").style.top=document.getElementById("cropTopMid").style.top;var o=document.getElementById("cropTopLeft").style.left,n=document.getElementById("cropTopMid").style.left,r=document.getElementById("cropTopRight").style.left;document.getElementById("cropLeftMid").style.left=o,document.getElementById("cropLeftMid").style.top=e.top+e.height/2-4+1+"px",document.getElementById("cropRightMid").style.left=r,document.getElementById("cropRightMid").style.top=document.getElementById("cropLeftMid").style.top,document.getElementById("cropBotLeft").style.left=o,document.getElementById("cropBotLeft").style.top=e.top+e.height-4+"px",document.getElementById("cropBotMid").style.left=n,document.getElementById("cropBotMid").style.top=document.getElementById("cropBotLeft").style.top,document.getElementById("cropBotRight").style.left=r,document.getElementById("cropBotRight").style.top=document.getElementById("cropBotLeft").style.top},addHandleEventListeners:function(){document.getElementById("cropTopLeft").addEventListener("mouseover",TRIANGLE.images.crop.XY),document.getElementById("cropTopLeft").addEventListener("mousedown",TRIANGLE.images.crop.initiate),document.getElementById("cropTopMid").addEventListener("mouseover",TRIANGLE.images.crop.Y),document.getElementById("cropTopMid").addEventListener("mousedown",TRIANGLE.images.crop.initiate),document.getElementById("cropTopRight").addEventListener("mouseover",TRIANGLE.images.crop.XY),document.getElementById("cropTopRight").addEventListener("mousedown",TRIANGLE.images.crop.initiate),document.getElementById("cropLeftMid").addEventListener("mouseover",TRIANGLE.images.crop.X),document.getElementById("cropLeftMid").addEventListener("mousedown",TRIANGLE.images.crop.initiate),document.getElementById("cropRightMid").addEventListener("mouseover",TRIANGLE.images.crop.X),document.getElementById("cropRightMid").addEventListener("mousedown",TRIANGLE.images.crop.initiate),document.getElementById("cropBotLeft").addEventListener("mouseover",TRIANGLE.images.crop.XY),document.getElementById("cropBotLeft").addEventListener("mousedown",TRIANGLE.images.crop.initiate),document.getElementById("cropBotMid").addEventListener("mouseover",TRIANGLE.images.crop.Y),document.getElementById("cropBotMid").addEventListener("mousedown",TRIANGLE.images.crop.initiate),document.getElementById("cropBotRight").addEventListener("mouseover",TRIANGLE.images.crop.XY),document.getElementById("cropBotRight").addEventListener("mousedown",TRIANGLE.images.crop.initiate)},itemIndex:-1,direction:null,X:function(){TRIANGLE.images.crop.direction="X"},Y:function(){TRIANGLE.images.crop.direction="Y"},XY:function(){TRIANGLE.images.crop.direction="XY"},handleID:null,createBorder:function(){TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)&&(TRIANGLE.images.crop.active=!0,TRIANGLE.images.crop.itemIndex=TRIANGLE.item.index,TRIANGLE.images.crop.transferImage(),TRIANGLE.images.crop.toggleMenu(),TRIANGLE.images.crop.showHandles())},initiate:function(){document.body.addEventListener("mousemove",TRIANGLE.images.crop.start),document.body.addEventListener("mouseup",TRIANGLE.images.crop.stop),TRIANGLE.images.crop.handleID=this.id},start:function(e){if(TRIANGLE.images.crop.active){TRIANGLE.images.crop.removeHandles();var t=e.clientX,o=e.clientY,i=document.getElementById("cropImageContainer").getBoundingClientRect(),n=document.getElementById("cropImageHandles"),r=n.getBoundingClientRect(),l=n.children[0],s=l.getBoundingClientRect(),a=i.right-(504-s.width)/2+2,d=i.left+(504-s.width)/2-1,m=i.top+(504-s.height)/2-1,c=i.bottom-(504-s.height)/2+2;"X"!==TRIANGLE.images.crop.direction&&"XY"!==TRIANGLE.images.crop.direction||(/Left/g.test(TRIANGLE.images.crop.handleID)?t>d&&t<a-2?(n.style.width=r.right-t+"px",n.style.left=t+"px",l.style.marginLeft=d-t+"px"):t<d&&(n.style.width=r.right-d+"px",n.style.left=d+"px",l.style.marginLeft=""):t>d+2&&t<a?n.style.width=t-r.left+"px":t>a&&(n.style.width=a-r.left-1+"px")),"Y"!==TRIANGLE.images.crop.direction&&"XY"!==TRIANGLE.images.crop.direction||(/Top/g.test(TRIANGLE.images.crop.handleID)?o>m&&o<c-2?(n.style.height=r.bottom-o+"px",n.style.top=o+"px",l.style.marginTop=m-o+"px"):o<m&&(n.style.height=r.bottom-m+"px",n.style.top=m+"px",l.style.marginTop=""):o>m+2&&o<c?n.style.height=o-r.top+"px":o>c&&(n.style.height=c-r.top-1+"px"))}},stop:function(){document.body.removeEventListener("mousemove",TRIANGLE.images.crop.start),document.body.removeEventListener("mouseup",TRIANGLE.images.crop.stop),TRIANGLE.images.crop.showHandles()},cancel:function(){TRIANGLE.images.crop.active=!1,TRIANGLE.importItem.single(TRIANGLE.images.crop.itemIndex),TRIANGLE.images.crop.itemIndex=-1,TRIANGLE.images.crop.toggleMenu()},applyCrop:function(){document.getElementById("cropImageContainer").getBoundingClientRect();var e=document.getElementById("cropImageHandles"),t=e.getBoundingClientRect(),o=e.children[0],i=o.getBoundingClientRect();e.getBoundingClientRect();TRIANGLE.selectItem(TRIANGLE.images.crop.itemIndex);var n=TRIANGLE.item.objRef.getBoundingClientRect();TRIANGLE.item.objRef.style.overflow="hidden";var r=i.width/(t.width-2)*100,l=(i.height,t.height,(t.left+1-i.left)/(t.width-2)*100);l<.5&&(l=0);var s=(t.top+1-i.top)/(t.width-2)*100;s<.5&&(s=0),TRIANGLE.item.objRef.setAttribute("crop-map",e.style.left+","+e.style.top+","+o.style.marginLeft+","+o.style.marginTop);var a=(t.width-2)/(t.height-2);TRIANGLE.item.objRef.setAttribute("crop-ratio",a),TRIANGLE.item.objRef.style.height=TRIANGLE.item.objRef.style.minHeight=Math.round(n.width/a)+"px",TRIANGLE.item.image.style.width=r+"%",TRIANGLE.item.image.style.height="auto",TRIANGLE.item.image.style.marginLeft=l>0?-1*l+"%":"",TRIANGLE.item.image.style.marginTop=s>0?-1*s+"%":"",TRIANGLE.images.crop.cancel(),TRIANGLE.selectItem(TRIANGLE.item.index)},removeHandles:function(){var e=document.getElementsByClassName("cropHandle");for(i=0;i<e.length;i++)e[i].style.display="none"}},autoSize:function(){if(TRIANGLE.item&&TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)){if(TRIANGLE.item.objRef.style.width="100%",TRIANGLE.item.cropRatio){var e=TRIANGLE.item.cropRatio,t=TRIANGLE.item.objRef.getBoundingClientRect().width,o=(TRIANGLE.item.objRef.getBoundingClientRect().height,Math.round(t/e));TRIANGLE.item.objRef.style.height=TRIANGLE.item.objRef.style.minHeight=o+"px"}else TRIANGLE.item.objRef.style.height="auto",TRIANGLE.item.objRef.style.minHeight="auto";TRIANGLE.item.image.width="100%",TRIANGLE.item.image.height="auto",TRIANGLE.selectionBorder.update(),TRIANGLE.updateTemplateItems(),TRIANGLE.importItem.single(TRIANGLE.item.index)}}},TRIANGLE.library={load:function(){AJAX.get("scripts/libraryList.php","",function(e){document.getElementById("echoLibrary").innerHTML=e.responseText})},loadUserIDs:function(){var e="instance="+TRIANGLE.instance;AJAX.get("scripts/userIDlist.php",e,function(e){document.getElementById("echoUserIDs").innerHTML=e.responseText})},loadUserClasses:function(){var e="instance="+TRIANGLE.instance;AJAX.get("scripts/userClassList.php",e,function(e){document.getElementById("echoUserClasses").innerHTML=e.responseText})},insertTemplate:function(e){var t="instance="+TRIANGLE.instance+"&templateName="+e;AJAX.get("scripts/insertPremadeTemplate.php",t,function(e){TRIANGLE.template.blank();var t=TRIANGLE.json.decompress(e.responseText);TRIANGLE.json.decode(t),TRIANGLE.library.loadUserIDs(),TRIANGLE.updateTemplateItems(),TRIANGLE.loadTemplate.updateUserIDs(),TRIANGLE.colors.updateBodyBg(),TRIANGLE.dragDrop.updateItemMap(),TRIANGLE.currentTemplate=TRIANGLE.currentPage=!1,setTimeout(TRIANGLE.updateTemplateItems,100)}),TRIANGLE.updateTemplateItems()},insert:function(e,t){if(!TRIANGLE.item||!TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef)){var o="category="+encodeURIComponent(e)+"&name="+encodeURIComponent(t);AJAX.get("scripts/insertLibraryItem.php",o,function(e){var t=e.responseText;TRIANGLE.item?(TRIANGLE.checkPadding(TRIANGLE.item.objRef),TRIANGLE.item.objRef.innerHTML=t+TRIANGLE.item.objRef.innerHTML):(document.getElementById("template").innerHTML+=t,window.scrollTo(0,document.body.scrollHeight)),TRIANGLE.library.convertStandbyItems(),setTimeout(function(){TRIANGLE.item&&TRIANGLE.importItem.single(TRIANGLE.item.index)},50),TRIANGLE.updateTemplateItems(!0)})}},convertStandbyItems:function(){var e=document.getElementById("template").getElementsByClassName("standby");for(i=0;i<e.length;i++){var t=e[i].className.replace("standby","templateItem");e[i].className=t}},insertUserID:function(e){if(!TRIANGLE.item||!TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef)){var t="instance="+TRIANGLE.instance+"&name="+e;AJAX.get("scripts/insertUserID.php",t,function(t){var o=TRIANGLE.json.toHTML(t.responseText),i=TRIANGLE.getElementByUserId(e);TRIANGLE.item?(TRIANGLE.checkPadding(TRIANGLE.item.objRef),TRIANGLE.item.objRef.innerHTML+=o,i&&TRIANGLE.item.objRef.lastChild.removeAttribute("user-id")):(document.getElementById("template").innerHTML+=o,i&&document.getElementById("template").lastChild.removeAttribute("user-id"),window.scrollTo(0,document.body.scrollHeight)),setTimeout(TRIANGLE.selectionBorder.update,50),TRIANGLE.updateTemplateItems(!0)})}},insertUserClass:function(e){if(!TRIANGLE.item||!TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef)){var t="instance="+TRIANGLE.instance+"&name="+e;AJAX.get("scripts/insertUserClass.php",t,function(t){var o=JSON.parse(t.responseText),i=document.createElement("div");i.setAttribute("user-class",e),i.style.cssText=o[e],i.className="templateItem",TRIANGLE.item?(TRIANGLE.item.append(i),setTimeout(TRIANGLE.selectionBorder.update,50)):(document.getElementById("template").appendChild(i),window.scrollTo(0,document.body.scrollHeight)),TRIANGLE.updateTemplateItems(!0)})}},removeDuplicateUserIDs:function e(t){if(!/\w+/g.test(t))return t;var o=TRIANGLE.getElementByUserId(t);if(!o){var n=document.getElementById("echoUserIDs");for(i=0;i<n.children.length&&t!==(o=n.children[i].innerHTML);i++)o=!1}if(o&&o!=TRIANGLE.item.objRef){var r="1";""!==t.replace(/\D+/g,"")&&/\d+/g.test(t.replace(/\D+/g,""))&&(r=parseInt(t.replace(/\D+/g,"")),r++),t=t.replace(/\d+/g,"")+r.toString(),TRIANGLE.getElementByUserId(t)?e(t):document.getElementById("userID").value=t}return t},previewItem:function(e){TRIANGLE.updateTemplateItems();var t=document.getElementById("library"+e);TRIANGLE.effects.hover.transferStyles(t.children[0]);var o=window.open();o.document.write('<title>Preview Library Item</title><link rel="stylesheet" href="index-style.css" type="text/css" media="screen"><style>*{cursor:auto}.templateItem{cursor:auto}.textBox a{pointer-events:auto}'+document.getElementById("hoverData").innerHTML+"</style>"+t.innerHTML),o.document.body.style.backgroundColor=document.body.style.backgroundColor;var n=o.document.getElementsByClassName("templateItem");for(i=0;i<n.length;i++)n[i].getAttribute("hover-style")&&n[i].removeAttribute("style")}},TRIANGLE.developer={insertSnippet:function(){var e=document.getElementById("snippetInsertion").value;if(e&&/[^\s]+/g.test(e))if(TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef))TRIANGLE.item.objRef.innerHTML=e;else{var t=document.createElement("div");t.className="templateItem childItem snippetItem",t.style.backgroundColor="inherit",t.style.minHeight="1px",t.style.height="auto",t.innerHTML=e,TRIANGLE.item?TRIANGLE.item.append(t):document.getElementById("template").appendChild(t),TRIANGLE.selectionBorder.update(),TRIANGLE.updateTemplateItems(!0)}},handleTabs:function(e,t){if(9===t.keyCode){var o=e.selectionStart,i=e.selectionEnd,n=e.value;e.value=n.substring(0,o)+"    "+n.substring(i),e.selectionStart=e.selectionEnd=o+4,t.preventDefault()}},saveEdits:null,currentCode:null,editCode:function(e,t){TRIANGLE.developer.currentCode=e;var o=document.getElementById(e),i=document.getElementById("codeEditor");document.getElementById("currentCode").innerHTML="Currently Editing: "+t,i.value=o.value,document.getElementById("codeEditorWrapper").style.display="block",TRIANGLE.developer.saveEdits=function(){document.getElementById(e).value=i.value,document.getElementById(e).onchange()},document.getElementById("marginFix").style.height=i.parentElement.getBoundingClientRect().height+170+"px",TRIANGLE.selectionBorder.update()},exitCodeEditor:function(){var e=document.getElementById(TRIANGLE.developer.currentCode),t=document.getElementById("codeEditor");document.getElementById("codeEditorWrapper").style.display="none",e.value=t.value,t.value="",TRIANGLE.developer.saveEdits=null,TRIANGLE.developer.currentCode=null,document.getElementById("marginFix").style.height="170px",TRIANGLE.selectionBorder.update()},styleTagContent:"",globalStyleTagContent:"",scriptTagContent:"",globalScriptTagContent:"",saveStyleTag:function(e){TRIANGLE.developer.styleTagContent=e},saveGlobalStyleTag:function(e){TRIANGLE.developer.globalStyleTagContent=e},saveScriptTag:function(e){TRIANGLE.developer.scriptTagContent=e},saveGlobalScriptTag:function(e){TRIANGLE.developer.globalScriptTagContent=e}},TRIANGLE.colors={setColorBoxEvents:function(){document.getElementById("colorMainBg").addEventListener("click",function(){TRIANGLE.colors.fillCanvas(this.style.backgroundColor),TRIANGLE.colors.showCanvasMenu(this,function(){document.body.style.backgroundColor=TRIANGLE.colors.canvasColorChoice,document.getElementById("bodyBgData").style.backgroundColor=TRIANGLE.colors.canvasColorChoice}),TRIANGLE.colors.canvasPaletteTarget="bodyBg"}),document.getElementById("colorElementBg").addEventListener("click",function(){TRIANGLE.item&&(TRIANGLE.colors.fillCanvas(this.style.backgroundColor),TRIANGLE.colors.showCanvasMenu(this,function(){TRIANGLE.saveItem.createAnimation("background-color",TRIANGLE.item.bgColor,TRIANGLE.colors.canvasColorChoice,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.item.objRef.style.backgroundColor=TRIANGLE.colors.canvasColorChoice}),TRIANGLE.colors.canvasPaletteTarget="backgroundColor")}),document.getElementById("colorListBorderL").addEventListener("click",function(){TRIANGLE.item&&(TRIANGLE.colors.fillCanvas(this.style.backgroundColor),TRIANGLE.colors.showCanvasMenu(this,function(){TRIANGLE.saveItem.createAnimation("border-left-color",TRIANGLE.item.borderLeftColor,TRIANGLE.colors.canvasColorChoice,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.item.objRef.style.borderLeftColor=TRIANGLE.colors.canvasColorChoice,TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.colors.canvasPaletteTarget="borderLeftColor")}),document.getElementById("colorListBorderR").addEventListener("click",function(){TRIANGLE.item&&(TRIANGLE.colors.fillCanvas(this.style.backgroundColor),TRIANGLE.colors.showCanvasMenu(this,function(){TRIANGLE.saveItem.createAnimation("border-right-color",TRIANGLE.item.borderRightColor,TRIANGLE.colors.canvasColorChoice,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.item.objRef.style.borderRightColor=TRIANGLE.colors.canvasColorChoice,TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.colors.canvasPaletteTarget="borderRightColor")}),document.getElementById("colorListBorderT").addEventListener("click",function(){TRIANGLE.item&&(TRIANGLE.colors.fillCanvas(this.style.backgroundColor),TRIANGLE.colors.showCanvasMenu(this,function(){TRIANGLE.saveItem.createAnimation("border-top-color",TRIANGLE.item.borderTopColor,TRIANGLE.colors.canvasColorChoice,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.item.objRef.style.borderTopColor=TRIANGLE.colors.canvasColorChoice,TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.colors.canvasPaletteTarget="borderTopColor")}),document.getElementById("colorListBorderB").addEventListener("click",function(){TRIANGLE.item&&(TRIANGLE.colors.fillCanvas(this.style.backgroundColor),TRIANGLE.colors.showCanvasMenu(this,function(){TRIANGLE.saveItem.createAnimation("border-bottom-color",TRIANGLE.item.borderBottomColor,TRIANGLE.colors.canvasColorChoice,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.item.objRef.style.borderBottomColor=TRIANGLE.colors.canvasColorChoice,TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.colors.canvasPaletteTarget="borderBottomColor")}),document.getElementById("colorBoxShadow").addEventListener("click",function(){TRIANGLE.item&&(TRIANGLE.colors.fillCanvas(TRIANGLE.colors.getBoxShadowColor(TRIANGLE.item.objRef)),TRIANGLE.colors.showCanvasMenu(this,function(){var e=document.getElementById("boxShadowH"),t=document.getElementById("boxShadowV"),o=document.getElementById("boxShadowBlur");document.getElementById("boxShadowColor");if(0==parseInt(e.value)&&0==parseInt(t.value)&&0==parseInt(o.value)||""==e.value&&""==t.value&&""==o.value)TRIANGLE.saveItem.createAnimation("box-shadow",TRIANGLE.item.boxShadow,"",function(){TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.item.objRef.style.boxShadow="";else{var i=parseInt(e.value)+"px "+parseInt(t.value)+"px "+parseInt(o.value)+"px "+TRIANGLE.colors.canvasColorChoice;TRIANGLE.saveItem.createAnimation("box-shadow",TRIANGLE.item.boxShadow,i,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.item.objRef.style.boxShadow=i}}),TRIANGLE.colors.canvasPaletteTarget="boxShadow")}),document.getElementById("colorFont").addEventListener("click",function(){TRIANGLE.item&&(TRIANGLE.colors.showCanvasMenu(this,function(){TRIANGLE.saveItem.createAnimation("color",TRIANGLE.item.fontColor,TRIANGLE.colors.canvasColorChoice,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.item.objRef.style.color=TRIANGLE.colors.canvasColorChoice}),TRIANGLE.colors.canvasPaletteTarget="color")}),document.getElementById("canvasBlack").addEventListener("mouseover",function(){document.getElementById("canvasPreviewColor").style.backgroundColor="black"}),document.getElementById("canvasWhite").addEventListener("mouseover",function(){document.getElementById("canvasPreviewColor").style.backgroundColor="white"})},objectReference:"",styleCallback:null,canvasColorChoice:document.getElementById("canvasColorChoice").style.backgroundColor,showCanvasMenu:function(e,t){TRIANGLE.colors.objectReference=e;var o=document.getElementById("canvasWrapper"),i=e.getBoundingClientRect();TRIANGLE.colors.styleCallback=t,o.style.top=i.bottom+"px",o.style.left=i.left+"px",o.style.display="inline-block"},applyCanvasColor:function(){TRIANGLE.colors.objectReference.style.backgroundColor=TRIANGLE.colors.canvasColorChoice,TRIANGLE.colors.styleCallback&&"function"==typeof TRIANGLE.colors.styleCallback&&TRIANGLE.colors.styleCallback(),TRIANGLE.colors.cancelCanvasMenu(),TRIANGLE.saveItem.equalizeUserClasses(TRIANGLE.item.userClass)},cancelCanvasMenu:function(){document.getElementById("canvasPalette").style.display="none",document.getElementById("canvasWrapper").style.display="none"},fillCanvas:function(e){"inherit"!==e&&e||(e="white"),document.getElementById("canvasCrosshair").style.top="8px",document.getElementById("canvasCrosshair").style.left="202px",document.getElementById("saturationMarker").style.top="207px",TRIANGLE.colors.canvasColorChoice=e,document.getElementById("canvasPreviewColor").style.backgroundColor=e,document.getElementById("canvasColorChoice").style.backgroundColor=e;var t=document.getElementById("canvasHueBar"),o=document.getElementById("canvasSaturationBar"),i=document.getElementById("canvasColorMenu");if(t.getContext){t.addEventListener("mousemove",TRIANGLE.colors.canvasPreviewColor),t.addEventListener("click",TRIANGLE.colors.canvasChooseColor),o.addEventListener("mousemove",TRIANGLE.colors.canvasPreviewColor),o.addEventListener("click",TRIANGLE.colors.canvasChooseColor),i.addEventListener("mousemove",TRIANGLE.colors.canvasPreviewColor),i.addEventListener("click",TRIANGLE.colors.canvasChooseColor);var n=t.getContext("2d"),r=n.createLinearGradient(0,0,20,200);r.addColorStop(0,"red"),r.addColorStop(.2,"orange"),r.addColorStop(.4,"yellow"),r.addColorStop(.6,"green"),r.addColorStop(.8,"blue"),r.addColorStop(1,"purple"),n.fillStyle=r,n.fillRect(0,0,20,200);var l=o.getContext("2d"),s=l.createLinearGradient(0,0,20,200);s.addColorStop(0,"#ffffff"),s.addColorStop(1,e),l.fillStyle=s,l.fillRect(0,0,20,200);var a=i.getContext("2d"),d=a.createLinearGradient(0,200,200,0);d.addColorStop(0,"#000000"),d.addColorStop(1,e),a.fillStyle=d,a.fillRect(0,0,200,200)}},canvasPreviewColor:function(e){var t=this.getBoundingClientRect(),o=e.clientX-t.left,i=e.clientY-t.top,n=this.getContext("2d").getImageData(o,i,1,1).data;n="#"+("000000"+TRIANGLE.colors.convertCanvasData(n)).slice(-6);document.getElementById("canvasPreviewColor").style.backgroundColor=n},canvasChooseColor:function(e){var t=this.getBoundingClientRect(),o=e.clientX-t.left,i=e.clientY-t.top,n=(r=this.getContext("2d")).getImageData(o,i,1,1).data;n="#"+("000000"+TRIANGLE.colors.convertCanvasData(n)).slice(-6);if(TRIANGLE.colors.canvasColorChoice=n,document.getElementById("canvasColorChoice").style.backgroundColor=n,"canvasColorMenu"==this.getAttribute("id")){document.getElementById("canvasCrosshair").style.left=o+5+"px",document.getElementById("canvasCrosshair").style.top=i+5+"px";var r,l=(r=document.getElementById("canvasSaturationBar").getContext("2d")).createLinearGradient(0,0,20,200);l.addColorStop(0,"#ffffff"),l.addColorStop(1,n),r.fillStyle=l,r.fillRect(0,0,20,200),document.getElementById("saturationMarker").style.top="207px"}else"canvasSaturationBar"==this.getAttribute("id")?document.getElementById("saturationMarker").style.top=i+8+"px":"canvasHueBar"==this.getAttribute("id")&&TRIANGLE.colors.fillCanvas(n)},canvasPaletteTarget:null,toggleCanvasPalette:function(){var e=document.getElementById("canvasPalette");if("none"===e.style.display){e.innerHTML="",TRIANGLE.colors.createPalette(!0,!0);var t=document.getElementById("colorPalette").getElementsByClassName("colorPaletteItem");for(i=0;i<t.length;i++){var o=t[i].cloneNode(!0);o.setAttribute("onClick","TRIANGLE.colors.fillCanvas(this.style.backgroundColor)"),e.appendChild(o),(i+1)%10==0&&(e.innerHTML+="<br>")}e.style.display="block"}else e.style.display="none"},applyCanvasPaletteColor:function(e){var t=TRIANGLE.colors.canvasPaletteTarget,o=e.style.backgroundColor;if("bodyBg"===t)document.body.style.backgroundColor=o,document.getElementById("bodyBgData").style.backgroundColor=o;else if("boxShadow"===t){var i=TRIANGLE.item.boxShadow.split(" ");isNaN(parseFloat(i[0]))?(i[0]=o,TRIANGLE.item.objRef.style.boxShadow=i.join(" ")):isNaN(parseFloat(i[1]))?(i[1]=o,TRIANGLE.item.objRef.style.boxShadow=i.join(" ")):isNaN(parseFloat(i[2]))?(i[2]=o,TRIANGLE.item.objRef.style.boxShadow=i.join(" ")):isNaN(parseFloat(i[3]))&&(i[3]=o,TRIANGLE.item.objRef.style.boxShadow=i.join(" "))}else TRIANGLE.item.objRef.style[t]=o;TRIANGLE.saveItem.equalizeUserClasses(TRIANGLE.item.userClass)},convertCanvasData:function(e){return(e[0]<<16|e[1]<<8|e[2]).toString(16)},colorDropIndex:-1,colorDropper:function(){if(TRIANGLE.item){for(TRIANGLE.colors.colorDropIndex=TRIANGLE.item.index,i=0;i<TRIANGLE.templateItems.length;i++)TRIANGLE.isType.imageItem(TRIANGLE.templateItems[i])||TRIANGLE.templateItems[i].addEventListener("mousedown",TRIANGLE.colors.colorDropChoose),TRIANGLE.templateItems[i].style.cursor="crosshair";var e=document.getElementsByClassName("colorPaletteItem");for(i=0;i<e.length;i++)e[i].addEventListener("mousedown",TRIANGLE.colors.colorDropChoose),e[i].style.cursor="crosshair";document.getElementById("colorDropper").style.cursor="crosshair"}},colorDropChoose:function(){for("inherit"===this.style.backgroundColor?document.getElementById("item"+TRIANGLE.colors.colorDropIndex).style.backgroundColor=this.parentNode.style.backgroundColor:document.getElementById("item"+TRIANGLE.colors.colorDropIndex).style.backgroundColor=this.style.backgroundColor,i=0;i<TRIANGLE.templateItems.length;i++)TRIANGLE.templateItems[i].removeEventListener("mousedown",TRIANGLE.colors.colorDropChoose),TRIANGLE.templateItems[i].style.cursor="";var e=document.getElementsByClassName("colorPaletteItem");for(i=0;i<e.length;i++)e[i].removeEventListener("mousedown",TRIANGLE.colors.colorDropChoose),e[i].style.cursor="";document.getElementById("colorDropper").style.cursor="",TRIANGLE.importItem.single(TRIANGLE.colors.colorDropIndex),TRIANGLE.colors.colorDropIndex=-1,TRIANGLE.selectionBorder.update()},cancelColorDropper:function(){for(i=0;i<TRIANGLE.templateItems.length;i++)TRIANGLE.templateItems[i].removeEventListener("mousedown",TRIANGLE.colors.colorDropChoose),TRIANGLE.templateItems[i].style.cursor="";document.getElementById("colorDropper").style.cursor="",TRIANGLE.colors.colorDropIndex=-1},createPalette:function(e,t){document.getElementById("paletteItemsBg").innerHTML="",document.getElementById("paletteItemsFont").innerHTML="",document.getElementById("paletteItemsBorder").innerHTML="",document.getElementById("paletteItemsShadow").innerHTML="";var o=document.getElementById("colorPalette"),n={paletteItemsBg:[],paletteItemsFont:[],paletteItemsBorder:[],paletteItemsShadow:[]};for(i=0;i<TRIANGLE.templateItems.length;i++){l(document.body.style.backgroundColor,"paletteItemsBg"),l(TRIANGLE.templateItems[i].style.backgroundColor,"paletteItemsBg"),l(TRIANGLE.templateItems[i].style.color,"paletteItemsFont"),l(TRIANGLE.templateItems[i].style.borderLeftColor,"paletteItemsBorder"),l(TRIANGLE.templateItems[i].style.borderRightColor,"paletteItemsBorder"),l(TRIANGLE.templateItems[i].style.borderTopColor,"paletteItemsBorder"),l(TRIANGLE.templateItems[i].style.borderBottomColor,"paletteItemsBorder");var r=TRIANGLE.templateItems[i].style.boxShadow;r=(r=r.replace(/rgb\((\d+), (\d+), (\d+)\)/g,"rgb($1,$2,$3)")).split(" "),isNaN(parseFloat(r[0]))?l(r[0],"paletteItemsShadow"):isNaN(parseFloat(r[1]))?l(r[1],"paletteItemsShadow"):isNaN(parseFloat(r[2]))?l(r[2],"paletteItemsShadow"):isNaN(parseFloat(r[3]))&&l(r[3],"paletteItemsShadow")}function l(e,t){e&&"inherit"!=e&&-1===n[t].indexOf(e)&&(n[t][j]=e,function(e,t){var o=document.createElement("div");o.className="colorPaletteItem",o.style.backgroundColor=e,document.getElementById(t).appendChild(o,document.getElementById("paletteFloat"))}(n[t][j],t),j++)}!function(){var e=document.getElementById("paletteItemsBg").getElementsByClassName("colorPaletteItem");for(i=0;i<e.length;i++)e[i].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'backgroundColor')"),e[i].setAttribute("onMouseOver","TRIANGLE.tooltip.show(TRIANGLE.colors.rgbToHex(this.style.backgroundColor));"),e[i].setAttribute("onMouseOut","TRIANGLE.tooltip.hide();"),e[i].setAttribute("onMouseMove","TRIANGLE.tooltip.update(event);");var t=document.getElementById("paletteItemsFont").getElementsByClassName("colorPaletteItem");for(i=0;i<t.length;i++)t[i].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'color')"),t[i].setAttribute("onMouseOver","TRIANGLE.tooltip.show(TRIANGLE.colors.rgbToHex(this.style.backgroundColor));"),t[i].setAttribute("onMouseOut","TRIANGLE.tooltip.hide();"),t[i].setAttribute("onMouseMove","TRIANGLE.tooltip.update(event);");var o=document.getElementById("paletteItemsBorder").getElementsByClassName("colorPaletteItem");for(i=0;i<o.length;i++)o[i].setAttribute("onMouseOver","TRIANGLE.colors.askBorderSide(this);TRIANGLE.tooltip.show(TRIANGLE.colors.rgbToHex(this.style.backgroundColor));"),o[i].setAttribute("onMouseOut","document.getElementById('askBorderSide').style.display = 'none';TRIANGLE.tooltip.hide();"),o[i].setAttribute("onMouseMove","TRIANGLE.tooltip.update(event);");var n=document.getElementById("paletteItemsShadow").getElementsByClassName("colorPaletteItem");for(i=0;i<n.length;i++)n[i].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'shadow')"),n[i].setAttribute("onMouseOver","TRIANGLE.tooltip.show(TRIANGLE.colors.rgbToHex(this.style.backgroundColor));"),n[i].setAttribute("onMouseOut","TRIANGLE.tooltip.hide();"),n[i].setAttribute("onMouseMove","TRIANGLE.tooltip.update(event);")}(),""!==document.getElementById("paletteItemsBg").innerHTML&&(document.getElementById("paletteItemsBg").innerHTML="Background<br><hr>"+document.getElementById("paletteItemsBg").innerHTML+"<div class='clear'></div><hr>"),""!==document.getElementById("paletteItemsFont").innerHTML&&(document.getElementById("paletteItemsFont").innerHTML="Font<br><hr>"+document.getElementById("paletteItemsFont").innerHTML+"<div class='clear'></div><hr>"),""!==document.getElementById("paletteItemsBorder").innerHTML&&(document.getElementById("paletteItemsBorder").innerHTML="Border<br><hr>"+document.getElementById("paletteItemsBorder").innerHTML+"<div class='clear'></div><hr>"),""!==document.getElementById("paletteItemsShadow").innerHTML&&(document.getElementById("paletteItemsShadow").innerHTML="Box Shadow<br><hr>"+document.getElementById("paletteItemsShadow").innerHTML+"<div class='clear'></div><hr>"),e||(o.style.display="block"),t||(o.style.left=document.getElementById("createPalette").getBoundingClientRect().left+"px",o.style.top=document.getElementById("createPalette").getBoundingClientRect().bottom+12+"px"),0===TRIANGLE.templateItems.length&&(document.getElementById("paletteItemsBg").innerHTML="No colors to display")},closePalette:function(){document.getElementById("colorPalette").style.display="none"},askBorderColorChoice:null,askBorderSide:function(e){var t=document.getElementById("askBorderSide");TRIANGLE.colors.askBorderColorChoice=e.style.backgroundColor,t.style.left=e.getBoundingClientRect().left+"px",t.style.top=e.getBoundingClientRect().bottom+"px",t.children[0].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'border', 'left');"),t.children[1].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'border', 'right');"),t.children[2].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'border', 'top');"),t.children[3].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'border', 'bottom');"),t.children[4].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'border', 'all');"),t.style.display="block"},applyPaletteColor:function(e,t,o){if(TRIANGLE.item){var i=e.style.backgroundColor;"border"==t&&o?("left"!=o&&"all"!=o||(TRIANGLE.item.borderLeft?TRIANGLE.item.objRef.style.borderLeftColor=TRIANGLE.colors.askBorderColorChoice:TRIANGLE.item.objRef.style.borderLeft="2px solid "+TRIANGLE.colors.askBorderColorChoice),"right"!=o&&"all"!=o||(TRIANGLE.item.borderRight?TRIANGLE.item.objRef.style.borderRightColor=TRIANGLE.colors.askBorderColorChoice:TRIANGLE.item.objRef.style.borderRight="2px solid "+TRIANGLE.colors.askBorderColorChoice),"top"!=o&&"all"!=o||(TRIANGLE.item.borderTop?TRIANGLE.item.objRef.style.borderTopColor=TRIANGLE.colors.askBorderColorChoice:TRIANGLE.item.objRef.style.borderTop="2px solid "+TRIANGLE.colors.askBorderColorChoice),"bottom"!=o&&"all"!=o||(TRIANGLE.item.borderBottom?TRIANGLE.item.objRef.style.borderBottomColor=TRIANGLE.colors.askBorderColorChoice:TRIANGLE.item.objRef.style.borderBottom="2px solid "+TRIANGLE.colors.askBorderColorChoice)):"shadow"==t?TRIANGLE.colors.setBoxShadowColor(TRIANGLE.item.objRef,i):TRIANGLE.item.objRef.style[t]=i,TRIANGLE.importItem.single(TRIANGLE.item.index),TRIANGLE.saveItem.equalizeUserClasses(TRIANGLE.item.userClass)}},dragPalette:{xInitial:null,yInitial:null,active:!1,initiate:function(e){var t=document.getElementById("colorPalette");TRIANGLE.colors.dragPalette.active=!0,document.addEventListener("mousemove",TRIANGLE.colors.dragPalette.start),document.addEventListener("mouseup",TRIANGLE.colors.dragPalette.stop),TRIANGLE.colors.dragPalette.xInitial=e.clientX-t.getBoundingClientRect().left,TRIANGLE.colors.dragPalette.yInitial=e.clientY-t.getBoundingClientRect().top},start:function(e){if(TRIANGLE.colors.dragPalette.active){var t=document.getElementById("colorPalette");t.getBoundingClientRect();t.style.left=e.clientX-TRIANGLE.colors.dragPalette.xInitial+"px",t.style.top=e.clientY-TRIANGLE.colors.dragPalette.yInitial+"px"}},stop:function(){TRIANGLE.colors.dragPalette.active=!1,document.removeEventListener("mousemove",TRIANGLE.colors.dragPalette.start),document.removeEventListener("mouseup",TRIANGLE.colors.dragPalette.stop)}},getBoxShadowColor:function(e){var t=e.style.boxShadow;return t=(t=t.replace(/rgb\((\d+), (\d+), (\d+)\)/g,"rgb($1,$2,$3)")).split(" "),isNaN(parseFloat(t[0]))?t[0]:isNaN(parseFloat(t[1]))?t[1]:isNaN(parseFloat(t[2]))?t[2]:isNaN(parseFloat(t[3]))?t[3]:void 0},setBoxShadowColor:function(e,t){var o=e.style.boxShadow;""!==o?(o=(o=o.replace(/rgb\((\d+), (\d+), (\d+)\)/g,"rgb($1,$2,$3)")).split(" "),isNaN(parseFloat(o[0]))?(o[0]=t,e.style.boxShadow=o.join(" ")):isNaN(parseFloat(o[1]))?(o[1]=t,e.style.boxShadow=o.join(" ")):isNaN(parseFloat(o[2]))?(o[2]=t,e.style.boxShadow=o.join(" ")):isNaN(parseFloat(o[3]))&&(o[3]=t,e.style.boxShadow=o.join(" "))):e.style.boxShadow="5px 5px 5px "+t},rgbToHex:function(e){if(/rgb/.test(e)){var t=e.replace(/[^\d,]/g,"").split(",");return"#"+((1<<24)+(parseInt(t[0])<<16)+(parseInt(t[1])<<8)+parseInt(t[2])).toString(16).slice(1)}return e},hexToRgb:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},updateBodyBg:function(){document.body.style.backgroundColor=document.getElementById("bodyBgData").style.backgroundColor,document.body.style.backgroundImage=document.getElementById("bodyBgData").style.backgroundImage,document.getElementById("colorMainBg").style.backgroundColor=document.getElementById("bodyBgData").style.backgroundColor},oppositeColor:function(e){return"#"+("000000"+("0xffffff"^"0x"+(e=e.replace(/#/g,""))).toString(16)).slice(-6)}},TRIANGLE.text={insertTextBox:function(e){var t=document.createElement("div");if(t.style.backgroundColor="inherit",t.style.height="auto",t.style.width="100%",t.style.fontSize="14px",t.style.lineHeight=1,t.style.fontFamily="Arial",t.className="templateItem textBox",t.innerHTML=e||"New text box",TRIANGLE.item&&!TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef))"black"===TRIANGLE.item.objRef.style.backgroundColor||"#000000"===TRIANGLE.item.objRef.style.backgroundColor||"rgb(0, 0, 0)"===TRIANGLE.item.objRef.style.backgroundColor?t.style.color="white":t.style.color="black",TRIANGLE.isType.containsNbsp(TRIANGLE.item.objRef)&&TRIANGLE.stripNbsp(TRIANGLE.item.objRef),TRIANGLE.checkPadding(TRIANGLE.item.objRef),TRIANGLE.item.objRef.appendChild(t),TRIANGLE.selectionBorder.update(),TRIANGLE.updateTemplateItems(!0);else{if(TRIANGLE.item)return;"black"===document.body.style.backgroundColor||"#000000"===document.body.style.backgroundColor||"rgb(0, 0, 0)"===document.body.style.backgroundColor?t.style.color="white":t.style.color="black",document.getElementById("template").appendChild(t),TRIANGLE.selectionBorder.update(),TRIANGLE.updateTemplateItems(!0)}},originalTextPosition:null,clearPastedStyles:function(e){TRIANGLE.item&&TRIANGLE.item.objRef.isContentEditable&&setTimeout(function(){var e=TRIANGLE.text.getSelectionCoords().r,t=document.createRange();t.setStart(TRIANGLE.text.originalTextPosition.startContainer,TRIANGLE.text.originalTextPosition.startOffset),t.setEnd(e.endContainer,e.endOffset);var o=window.getSelection();o.removeAllRanges(),o.addRange(t),document.execCommand("removeFormat"),t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),o.removeAllRanges(),o.addRange(t),TRIANGLE.selectionBorder.update()},20)},editText:function(){var e=TRIANGLE.item;e.objRef.removeEventListener("dblclick",TRIANGLE.text.editText),e.objRef.addEventListener("keyup",TRIANGLE.selectionBorder.update),e.objRef.addEventListener("paste",TRIANGLE.text.clearPastedStyles),e.objRef.contentEditable="true",e.objRef.focus(),e.objRef.style.cursor="text","New text box"!=e.objRef.innerHTML&&"Field Label"!=e.objRef.innerHTML||(e.objRef.innerHTML="&nbsp;"),document.getElementById("selectionBorder").style.border="1px dashed black",TRIANGLE.resize.removeHandles()},checkTextEditing:function(e){TRIANGLE.item;var t=document.getElementsByClassName("textBox");for(x=0;x<t.length;x++)t[x].isContentEditable&&t[x]!==document.activeElement&&(TRIANGLE.text.clearTextSelection(),t[x].contentEditable="false",t[x].style.cursor="",t[x].removeEventListener("keyup",TRIANGLE.selectionBorder.update),t[x].removeEventListener("paste",TRIANGLE.text.clearPastedStyles),0!==t[x].innerHTML.length&&"<br>"!=t[x].innerHTML&&"&nbsp;"!=t[x].innerHTML&&0!==o(t[x])||(t[x].innerHTML="New text box"));function o(e){var t=0;3==e.nodeType&&(t=1);for(var i=0;i<e.childNodes.length;++i)t+=o(e.childNodes[i]);return t}},preventTextSelect:function(){for(i=0;i<TRIANGLE.templateItems.length;i++)TRIANGLE.templateItems[i].style.cssText+="-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;"},allowTextSelect:function(){for(i=0;i<TRIANGLE.templateItems.length;i++)TRIANGLE.templateItems[i].style.cssText=TRIANGLE.templateItems[i].style.cssText.replace(/-webkit-touch-callout: none;|-webkit-user-select: none;|-khtml-user-select: none;|-moz-user-select: none;|-ms-user-select: none;|user-select: none;/g,"")},clearTextSelection:function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},bold:function(){var e=TRIANGLE.item;e&&TRIANGLE.isType.textBox(e.objRef)&&(e.objRef.isContentEditable?document.execCommand("bold"):/<\/*(b|strong)>/g.test(e.objRef.innerHTML)?e.objRef.innerHTML=e.objRef.innerHTML.replace(/<\/*(b|strong)>/g,""):e.objRef.innerHTML="<b>"+e.objRef.innerHTML+"</b>")},italic:function(){var e=TRIANGLE.item;e&&TRIANGLE.isType.textBox(e.objRef)&&(e.objRef.isContentEditable?document.execCommand("italic"):/<\/*(i|em)>/g.test(e.objRef.innerHTML)?e.objRef.innerHTML=e.objRef.innerHTML.replace(/<\/*(i|em)>/g,""):e.objRef.innerHTML="<i>"+e.objRef.innerHTML+"</i>")},underline:function(){TRIANGLE.item&&TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&(TRIANGLE.item.objRef.isContentEditable?document.execCommand("underline"):/<\/*u>/g.test(TRIANGLE.item.objRef.innerHTML)?TRIANGLE.item.objRef.innerHTML=TRIANGLE.item.objRef.innerHTML.replace(/<\/*u>/g,""):TRIANGLE.item.objRef.innerHTML="<u>"+TRIANGLE.item.objRef.innerHTML+"</u>")},align:function(e){if(TRIANGLE.item)if(TRIANGLE.item.objRef.isContentEditable)switch(e){case"left":document.execCommand("justifyLeft");break;case"center":document.execCommand("justifyCenter");break;case"right":document.execCommand("justifyRight")}else TRIANGLE.item.objRef.style.textAlign=e},importedHyperlink:null,savedTextRange:null,createHyperlink:function(){if(TRIANGLE.item)if(TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&TRIANGLE.item.objRef.isContentEditable){var e=TRIANGLE.text.getSelectionCoords();(t=document.getElementById("hyperlinkMenu")).style.display="inline-block",t.style.left=e.x+"px",t.getBoundingClientRect().right>window.innerWidth?(t.style.left="auto",t.style.right=0):t.style.right="auto",t.style.top=e.y+"px",TRIANGLE.text.savedTextRange=e.r,document.getElementById("hyperlinkURL").focus()}else{TRIANGLE.pages.loadPages("","select");var t,o=TRIANGLE.item.objRef.getBoundingClientRect();(t=document.getElementById("hyperlinkMenu")).style.display="inline-block",t.style.left=o.left+"px",t.getBoundingClientRect().right>window.innerWidth?(t.style.left="auto",t.style.right=0):t.style.right="auto",t.style.top=o.bottom+"px",t.getBoundingClientRect().bottom>window.innerHeight?(t.style.top="auto",t.style.bottom=0):t.style.bottom="auto",document.getElementById("hyperlinkURL").focus()}},applyHyperlink:function(){if(TRIANGLE.item&&TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&TRIANGLE.item.objRef.isContentEditable){if(TRIANGLE.text.replaceTextSelection(),0!==(o=document.getElementById("hyperlinkPage")).selectedIndex){var e=o.options[o.selectedIndex].value+".php";TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&TRIANGLE.item.objRef.isContentEditable?document.execCommand("createLink",null,e):TRIANGLE.item.objRef.setAttribute("link-to",e)}else if(""!==document.getElementById("hyperlinkURL").value){var t=document.getElementById("hyperlinkURL").value;TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&TRIANGLE.item.objRef.isContentEditable?document.execCommand("createLink",null,t):TRIANGLE.item.objRef.setAttribute("link-to",t)}TRIANGLE.text.underline(),TRIANGLE.text.cancelHyperlink()}else if(TRIANGLE.item){var o;if(0!==(o=document.getElementById("hyperlinkPage")).selectedIndex){e=o.options[o.selectedIndex].value+".php";TRIANGLE.item.objRef.setAttribute("link-to",e)}else if(""!==document.getElementById("hyperlinkURL").value){t=document.getElementById("hyperlinkURL").value;TRIANGLE.item.objRef.setAttribute("link-to",t)}TRIANGLE.text.cancelHyperlink()}else TRIANGLE.text.cancelHyperlink();TRIANGLE.importItem.single(TRIANGLE.item.index)},cancelHyperlink:function(){document.getElementById("hyperlinkURL").value="",document.getElementById("hyperlinkPage").selectedIndex=0,document.getElementById("hyperlinkMenu").style.display="none"},deleteHyperlink:function(){if(TRIANGLE.item){if(TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&TRIANGLE.item.objRef.isContentEditable)document.execCommand("unlink");else{var e=TRIANGLE.item.objRef.firstChild,t=e.tagName;TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&1===TRIANGLE.item.objRef.children.length&&"A"===t?TRIANGLE.item.objRef.innerHTML=e.innerHTML:TRIANGLE.item.objRef.getAttribute("link-to")&&(TRIANGLE.item.objRef.removeAttribute("link-to"),TRIANGLE.item.objRef.removeAttribute("target"))}/<u>/.test(TRIANGLE.item.objRef.innerHTML)&&TRIANGLE.text.underline(),document.getElementById("hrefHyperlink").value="",document.getElementById("hrefTarget").value=0}},changeLinkTarget:function(e){if(0===e.selectedIndex)null!=TRIANGLE.text.importedHyperlink?TRIANGLE.text.importedHyperlink.removeAttribute("target"):TRIANGLE.isType.textBox(TRIANGLE.item.objRef)?TRIANGLE.item.objRef.firstChild.removeAttribute("target"):TRIANGLE.item.objRef.removeAttribute("target");else{var t=e.options[e.selectedIndex].text;TRIANGLE.text.importedHyperlink?TRIANGLE.text.importedHyperlink.setAttribute("target",t):TRIANGLE.isType.textBox(TRIANGLE.item.objRef)?TRIANGLE.item.objRef.firstChild.setAttribute("target",t):TRIANGLE.item.objRef.setAttribute("target",t)}},insertUnorderedList:function(){TRIANGLE.item&&TRIANGLE.item.objRef.isContentEditable&&(document.execCommand("insertUnorderedList"),TRIANGLE.selectionBorder.update())},insertOrderedList:function(){TRIANGLE.item&&TRIANGLE.item.objRef.isContentEditable&&(document.execCommand("insertOrderedList"),TRIANGLE.selectionBorder.update())},insertHorizontalRule:function(){TRIANGLE.item&&TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&(TRIANGLE.item.objRef.isContentEditable?document.execCommand("insertHorizontalRule"):TRIANGLE.item.objRef.innerHTML+="<hr>",TRIANGLE.selectionBorder.update())},changeFont:function(e){if(TRIANGLE.isType.textBox(TRIANGLE.item.objRef)){var t=e.options[e.selectedIndex],o=t.text,i=document.getElementById("fontData");if(t.getAttribute("font-url")){var n=t.getAttribute("font-url"),r=n.replace(/'/g,'"');r=(r=(r=encodeURIComponent(r)).replace(/\./g,"\\.")).replace(/%0A/g,"");var l=new RegExp(r),s=i.innerHTML;s=s.replace(/'/g,'"'),s=encodeURIComponent(s),l.test(s)||(i.innerHTML+=n)}TRIANGLE.item.objRef.isContentEditable?(document.execCommand("styleWithCSS",null,!0),document.execCommand("fontName",null,o),document.execCommand("styleWithCSS",null,!1)):TRIANGLE.item.objRef.style.fontFamily=o,TRIANGLE.selectionBorder.update()}},deleteUnusedFonts:function(){var e=document.getElementById("fontType");for(i=0;i<e.options.length;i++)if("Arial"!==e.options[i].innerHTML){var t=0;for(x=0;x<TRIANGLE.templateItems.length;x++)if(TRIANGLE.isType.textBox(TRIANGLE.templateItems[x])){var o=TRIANGLE.templateItems[x].style.fontFamily;(o=(o=o.replace(/'/g,"")).replace(/"/g,""))===e.options[i].text&&t++}if(0===t&&e.options[i].getAttribute("font-url")){var n=e.options[i].getAttribute("font-url");n=n.replace(/'/g,'"'),n=(n=(n=encodeURIComponent(n)).replace(/\./g,"\\.")).replace(/%0A/g,"");var r=new RegExp(n),l=document.getElementById("fontData"),s=l.innerHTML;s=s.replace(/'/g,'"'),s=encodeURIComponent(s),r.test(s)&&(s=s.replace(r,""),l.innerHTML=decodeURIComponent(s))}}},changeFontColor:function(e){var t=TRIANGLE.item;TRIANGLE.isType.textBox(t.objRef)&&(TRIANGLE.text.replaceTextSelection(),t.objRef.isContentEditable?(document.execCommand("styleWithCSS",null,!0),document.execCommand("foreColor",null,e),document.execCommand("styleWithCSS",null,!1)):t.objRef.style.color=e)},increaseFontSize:function(){if(TRIANGLE.item&&TRIANGLE.isType.textBox(TRIANGLE.item.objRef)){var e=document.getElementById("fontSize").value,t=TRIANGLE.getUnit(e),o=parseFloat(e)+1;TRIANGLE.item.objRef.style.fontSize=o+t,document.getElementById("fontSize").value=o,TRIANGLE.selectionBorder.update()}},decreaseFontSize:function(){if(TRIANGLE.item&&TRIANGLE.isType.textBox(TRIANGLE.item.objRef)){var e=document.getElementById("fontSize").value,t=TRIANGLE.getUnit(TRIANGLE.item.fontSize),o=parseFloat(e)-1;o=o>0?o:e,TRIANGLE.item.objRef.style.fontSize=o+t,document.getElementById("fontSize").value=o,TRIANGLE.selectionBorder.update()}},changeFontSize:function(){if(TRIANGLE.item&&TRIANGLE.isType.textBox(TRIANGLE.item.objRef)){var e=document.getElementById("fontSize").value,t=TRIANGLE.getUnit(TRIANGLE.item.fontSize),o=parseFloat(e)+t;TRIANGLE.item.objRef.style.fontSize=o,TRIANGLE.selectionBorder.update()}},changeFontWeight:function(e){},getSelectionCoords:function(e){var t,o,i,n=(e=e||window).document,r=n.selection,l=0,s=0;if(r)"Control"!=r.type&&((t=r.createRange()).collapse(!0),l=t.boundingRight,s=t.boundingTop);else if(e.getSelection&&(r=e.getSelection()).rangeCount&&((t=r.getRangeAt(0).cloneRange()).getClientRects&&(t.collapse(!1),(o=t.getClientRects()).length>0&&(l=(i=o[0]).right,s=i.top)),0==l&&0==s)){var a=n.createElement("span");if(a.getClientRects){a.appendChild(n.createTextNode("​")),t.insertNode(a),l=(i=a.getClientRects()[0]).right,s=i.top;var d=a.parentNode;d.removeChild(a),d.normalize()}}return{x:l,y:s,r:TRIANGLE.text.saveTextSelection()}},saveTextSelection:function(){if(window.getSelection&&document.createRange){var e=window.getSelection().getRangeAt(0).cloneRange();return TRIANGLE.text.savedTextRange=e,e}},replaceTextSelection:function(){var e=window.getSelection();e.removeAllRanges(),e.addRange(TRIANGLE.text.savedTextRange)}},TRIANGLE.templateItems=document.getElementsByClassName("templateItem"),TRIANGLE.refreshTemplateItems=function(){var e=document.getElementById("template").getElementsByClassName("templateItem");return TRIANGLE.templateItems=null,TRIANGLE.templateItems=e,e},TRIANGLE.item,TRIANGLE.sv_item,TRIANGLE.scrollbarWidth,TRIANGLE.template={getFixedWidth:function(){TRIANGLE.popUp.open("getFixedWidthCell"),document.getElementById("customFixedWidth").value=document.getElementById("template").style.width},type:null,fixedWidth:function(){if(1===arguments.length)document.getElementById("template").style.width=arguments[0];else if(0===arguments.length){var e=document.getElementById("customFixedWidth").value;/\D/g.test(e)?document.getElementById("template").style.width=e:document.getElementById("template").style.width=e+"px"}document.getElementById("template").style.margin="0 auto",TRIANGLE.template.type="fixed",TRIANGLE.popUp.close(),TRIANGLE.selectionBorder.update()},cancelFixedWidth:function(){TRIANGLE.popUp.close()},fluidWidth:function(){document.getElementById("template").style.width="100%",document.getElementById("template").style.margin="",TRIANGLE.template.type="fluid",TRIANGLE.selectionBorder.update()},blank:function(){for(i=0;i<TRIANGLE.templateItems.length;i++)TRIANGLE.templateItems[i].removeEventListener("mousedown",TRIANGLE.importItem.single,!0),TRIANGLE.templateItems[i].removeEventListener("mouseover",TRIANGLE.hoverBorder.show,!0),TRIANGLE.templateItems[i].removeEventListener("dblclick",TRIANGLE.text.editText);document.getElementById("template").innerHTML="",document.getElementById("bodyBgData").style.backgroundColor="#FFFFFF",document.getElementById("hoverData").style.backgroundColor="#FFFFFF",document.getElementById("hoverItems").style.backgroundColor="#FFFFFF",document.getElementById("animationData").style.backgroundColor="#FFFFFF",document.getElementById("fontData").style.backgroundColor="#FFFFFF",TRIANGLE.colors.updateBodyBg(),TRIANGLE.clearSelection()},increaseOpacity:function(){var e=document.getElementById("template");e.style.opacity&&(e.style.opacity=parseFloat(e.style.opacity)+parseFloat(e.style.opacity)/10,parseFloat(e.style.opacity)>.9&&(e.style.opacity=""))},decreaseOpacity:function(){var e=document.getElementById("template");e.style.opacity?(e.style.opacity=parseFloat(e.style.opacity)-parseFloat(e.style.opacity)/10,parseFloat(e.style.opacity)<.1&&(e.style.opacity=.1)):e.style.opacity=.9}},TRIANGLE.TemplateItem=function(e){this.index=parseInt(e),this.objRef=document.getElementById("item"+this.index)?document.getElementById("item"+this.index):TRIANGLE.templateItems[this.index],this.prevItem=document.getElementById("item"+(e-1))||TRIANGLE.templateItems[e-1],this.nextItem=document.getElementById("item"+(e+1))||TRIANGLE.templateItems[e+1],this.parent=this.objRef.parentNode,this.childOf=this.objRef.getAttribute("childof")?this.objRef.getAttribute("childof"):null,this.id=this.objRef.id,this.parentId=this.objRef.parentNode.id,this.className=this.objRef.className,this.textNodes=this.objRef.getElementsByClassName("textBox").length,this.tag=this.objRef.tagName,this.resizing=!1,this.align=this.objRef.getAttribute("item-align"),this.isFirstChild=!this.prevSibling(),this.isLastChild=!this.nextSibling(),this.image=TRIANGLE.isType.imageItem(this.objRef)?this.objRef.children[0]:void 0,this.cropMap=!!this.objRef.getAttribute("crop-map")&&this.objRef.getAttribute("crop-map"),this.cropRatio=!!this.objRef.getAttribute("crop-ratio")&&parseFloat(this.objRef.getAttribute("crop-ratio")),this.linkTo=!!this.objRef.getAttribute("link-to")&&this.objRef.getAttribute("link-to"),this.userID=!!this.objRef.getAttribute("user-id")&&this.objRef.getAttribute("user-id"),this.userClass=!!this.objRef.getAttribute("user-class")&&this.objRef.getAttribute("user-class"),this.bgColor=this.objRef.style.backgroundColor,this.height=this.objRef.style.height,this.minHeight=this.objRef.style.minHeight,this.width=this.objRef.style.width,this.display=this.objRef.style.display,this.position=this.objRef.style.position,this.cssFloat=this.objRef.style.cssFloat,this.transform=this.detectTransform(),this.padding=this.objRef.style.padding,this.paddingLeft=this.objRef.style.paddingLeft,this.paddingRight=this.objRef.style.paddingRight,this.paddingTop=this.objRef.style.paddingTop,this.paddingBottom=this.objRef.style.paddingBottom,this.margin=this.objRef.style.margin,this.marginLeft=this.objRef.style.marginLeft,this.marginRight=this.objRef.style.marginRight,this.marginTop=this.objRef.style.marginTop,this.marginBottom=this.objRef.style.marginBottom,this.border=this.objRef.style.border,this.borderLeft=this.objRef.style.borderLeft,this.borderLeftWidth=this.objRef.style.borderLeftWidth,this.borderLeftStyle=this.objRef.style.borderLeftStyle,this.borderLeftColor=this.objRef.style.borderLeftColor,this.borderRight=this.objRef.style.borderRight,this.borderRightWidth=this.objRef.style.borderRightWidth,this.borderRightStyle=this.objRef.style.borderRightStyle,this.borderRightColor=this.objRef.style.borderRightColor,this.borderTop=this.objRef.style.borderTop,this.borderTopWidth=this.objRef.style.borderTopWidth,this.borderTopStyle=this.objRef.style.borderTopStyle,this.borderTopColor=this.objRef.style.borderTopColor,this.borderBottom=this.objRef.style.borderBottom,this.borderBottomWidth=this.objRef.style.borderBottomWidth,this.borderBottomStyle=this.objRef.style.borderBottomStyle,this.borderBottomColor=this.objRef.style.borderBottomColor,this.boxShadow=this.objRef.style.boxShadow,this.fontFamily=this.objRef.style.fontFamily,this.fontColor=this.objRef.style.color,this.fontSize=this.objRef.style.fontSize,this.fontWeight=this.objRef.style.fontWeight,this.lineHeight=this.objRef.style.lineHeight,this.textDecorationColor=this.objRef.style.textDecorationColor,this.flexFlow=this.objRef.style.flexFlow,this.alignItems=this.objRef.style.alignItems,this.justifyContent=this.objRef.style.justifyContent,this.transition=this.objRef.style.transition,this.animation=this.objRef.style.animation,this.hover={},this.hover.cssText=this.objRef.getAttribute("hover-style"),this.hoverObj=document.getElementById(this.id+"hover"),this.hoverVersion=!!this.hoverObj},TRIANGLE.TemplateItem.prototype.append=function(e){this.objRef.appendChild(e)},TRIANGLE.TemplateItem.prototype.remove=function(){this.parent.removeChild(this.objRef)},TRIANGLE.TemplateItem.prototype.countTextNodes=function(){var e=this.objRef.getElementsByClassName("textBox"),t=e.length;for(z=0;z<e.length;z++)t+=e[z].children.length;return t},TRIANGLE.TemplateItem.prototype.addClass=function(e){this.objRef.className=this.className+" "+e},TRIANGLE.TemplateItem.prototype.removeClass=function(e){this.objRef.className=this.objRef.className.replace(e,""),this.objRef.className=this.objRef.className.replace("s+"," ")},TRIANGLE.TemplateItem.prototype.siblings=function(){var e=this.parent.children,t=[];for(j=0,k=0;k<e.length;k++)e[k].parentNode===this.parent&&e[k]!==this.objRef&&/templateItem/g.test(e[k].className)&&(t[j]=e[k],j++);return t},TRIANGLE.TemplateItem.prototype.prevSibling=function(){var e=this.parent.children;for(k=e.length-1;k>=0;k--){if(e[k]===this.objRef)var t=this.index;if(parseInt(e[k].getAttribute("index"))<t&&e[k].parentNode===this.parent)return e[k]}},TRIANGLE.TemplateItem.prototype.nextSibling=function(){var e=this.parent.children;for(k=0;k<e.length;k++){if(e[k]===this.objRef)var t=this.index;if(parseInt(e[k].getAttribute("index"))>t&&e[k].parentNode===this.parent)return e[k]}},TRIANGLE.TemplateItem.prototype.detectTransform=function(){return this.objRef.style.transform?this.objRef.style.transform:this.objRef.style.WebkitTransform?this.objRef.style.WebkitTransform:this.objRef.style.msTransform?this.objRef.style.msTransform:void 0},TRIANGLE.TemplateItem.prototype.isAbove=function(e){var t=this.siblings();for(k=0;k<t.length;k++)if(t[k]===document.getElementById("item"+e)){var o=this.objRef.getBoundingClientRect(),i=t[k].getBoundingClientRect();return i.bottom<=o.top&&o.top-i.bottom<=200}},TRIANGLE.TemplateItem.prototype.isBelow=function(e){var t=this.siblings();for(k=0;k<t.length;k++)if(t[k]===document.getElementById("item"+e)){var o=this.objRef.getBoundingClientRect(),i=t[k].getBoundingClientRect();return i.top>=o.bottom&&i.bottom-o.bottom<=200}},TRIANGLE.TemplateItem.prototype.searchParentTree=function(e){for(var t=this.objRef,o=new RegExp(e);"template"!=t.id&&!o.test(t.className);)t=t.parentNode;return"template"!=t.id},Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var e=0,t=this.length;e<t;e++)this[e]&&this[e].parentElement&&this[e].parentElement.removeChild(this[e])},TRIANGLE.dragDrop={eatClick:null,draggingElem:null,draggingCopy:null,active:!1,applyDrag:function(e){TRIANGLE.dragDrop.eatClick=setTimeout(TRIANGLE.dragDrop.start,200)},start:function(e){if(!TRIANGLE.item.objRef.isContentEditable&&"BUTTON"!==TRIANGLE.item.tag&&!TRIANGLE.isType.formField(TRIANGLE.item.objRef)){TRIANGLE.dragDrop.active=!0,TRIANGLE.dragDrop.draggingElem=TRIANGLE.item.objRef,TRIANGLE.dragDrop.draggingElem.style.opacity="0.5",TRIANGLE.dragDrop.draggingCopy=TRIANGLE.createAnother(TRIANGLE.dragDrop.draggingElem);var t=TRIANGLE.dragDrop.draggingElem.getBoundingClientRect();TRIANGLE.dragDrop.draggingCopy.style.width=t.width+"px",TRIANGLE.dragDrop.draggingCopy.style.height=TRIANGLE.dragDrop.draggingCopy.style.minHeight=t.height+"px",TRIANGLE.dragDrop.draggingCopy.style.position="fixed",TRIANGLE.dragDrop.draggingCopy.style.opacity="0.7",TRIANGLE.dragDrop.draggingCopy.style.zIndex="2",TRIANGLE.dragDrop.draggingCopy.style.visibility="hidden",TRIANGLE.dragDrop.draggingCopy.style.pointerEvents="none",TRIANGLE.dragDrop.draggingCopy.style.transform="scale(0.5,0.5)",TRIANGLE.dragDrop.draggingCopy.id="draggingCopy",TRIANGLE.dragDrop.draggingCopy.className="draggingCopy",document.body.appendChild(TRIANGLE.dragDrop.draggingCopy),document.addEventListener("mousemove",TRIANGLE.dragDrop.updatePosition),document.addEventListener("mousemove",TRIANGLE.dragDrop.dragVis),TRIANGLE.text.preventTextSelect()}},updatePosition:function(e){"hidden"==TRIANGLE.dragDrop.draggingCopy.style.visibility&&(TRIANGLE.dragDrop.draggingCopy.style.visibility="visible"),TRIANGLE.dragDrop.draggingCopy.style.top=e.clientY-TRIANGLE.dragDrop.draggingCopy.getBoundingClientRect().height+"px",TRIANGLE.dragDrop.draggingCopy.style.left=e.clientX-TRIANGLE.dragDrop.draggingCopy.getBoundingClientRect().width+"px"},stop:function(e){var t=TRIANGLE.item;if(clearTimeout(TRIANGLE.dragDrop.eatClick),TRIANGLE.dragDrop.active)if(TRIANGLE.dragDrop.draggingElem.style.opacity="",TRIANGLE.dragDrop.draggingCopy&&document.body.removeChild(TRIANGLE.dragDrop.draggingCopy),document.getElementById("draggingCopy")&&document.body.removeChild("draggingCopy"),TRIANGLE.hoveredElem!==TRIANGLE.dragDrop.draggingElem&&TRIANGLE.hoveredElem!==TRIANGLE.dragDrop.draggingElem.parentNode){var o=TRIANGLE.createAnother(TRIANGLE.item.objRef);if(document.getElementById("visBox")){TRIANGLE.dragDrop.draggingElem.remove(),document.getElementById("visBox").style.cssFloat&&(o.style.cssFloat=document.getElementById("visBox").style.cssFloat,o.setAttribute("item-align",o.style.cssFloat));var i=document.getElementById("visBox").parentNode;"template"!==i.getAttribute("id")&&TRIANGLE.checkPadding(i),i.insertBefore(o,document.getElementById("visBox")),TRIANGLE.dragDrop.removeVisBox()}else TRIANGLE.hoveredElem&&!TRIANGLE.isType.bannedInsertion(TRIANGLE.hoveredElem)&&(TRIANGLE.checkPadding(TRIANGLE.hoveredElem),TRIANGLE.hoveredElem.appendChild(o),TRIANGLE.dragDrop.draggingElem.remove());TRIANGLE.clearSelection(),TRIANGLE.updateTemplateItems(),TRIANGLE.text.clearTextSelection()}else if(TRIANGLE.hoveredElem==TRIANGLE.dragDrop.draggingElem.parentNode&&document.getElementById("visBox")){o=TRIANGLE.createAnother(t.objRef);TRIANGLE.dragDrop.draggingElem.remove(),document.getElementById("visBox").style.cssFloat&&(o.style.cssFloat=document.getElementById("visBox").style.cssFloat,o.setAttribute("item-align",o.style.cssFloat)),document.getElementById("visBox").parentNode.insertBefore(o,document.getElementById("visBox")),TRIANGLE.dragDrop.removeVisBox()}TRIANGLE.dragDrop.active=!1,TRIANGLE.dragDrop.draggingElem=!1,TRIANGLE.updateTemplateItems(!0),document.removeEventListener("mousemove",TRIANGLE.dragDrop.updatePosition),document.removeEventListener("mousemove",TRIANGLE.dragDrop.dragVis),TRIANGLE.text.allowTextSelect(),TRIANGLE.updateTemplateItems()},itemMap:{left:[],right:[],top:[],bottom:[],height:[],width:[],minY:[],maxY:[],minX:[],maxX:[]},updateItemMap:function(){for(i=0;i<TRIANGLE.templateItems.length;i++){var e=TRIANGLE.templateItems[i].getBoundingClientRect();TRIANGLE.dragDrop.itemMap.left[i]=e.left,TRIANGLE.dragDrop.itemMap.right[i]=e.right,TRIANGLE.dragDrop.itemMap.top[i]=e.top,TRIANGLE.dragDrop.itemMap.bottom[i]=e.bottom,TRIANGLE.dragDrop.itemMap.height[i]=e.height,TRIANGLE.dragDrop.itemMap.width[i]=e.width;var t=e.height/3;TRIANGLE.dragDrop.itemMap.minY[i]=e.top+t,TRIANGLE.dragDrop.itemMap.maxY[i]=e.bottom-t,TRIANGLE.dragDrop.itemMap.minX[i]=e.left+t,TRIANGLE.dragDrop.itemMap.maxX[i]=e.right-t}},prevHoverElem:null,dragVis:function(e){if(TRIANGLE.hoveredElem){var t=parseInt(TRIANGLE.hoveredElem.getAttribute("index"));if("template"!=TRIANGLE.hoveredElem.parentNode.id)var o=parseInt(TRIANGLE.hoveredElem.parentNode.getAttribute("index"));TRIANGLE.hoveredElem.nextSibling&&TRIANGLE.isType.templateItem(TRIANGLE.hoveredElem.nextSibling)&&parseInt(TRIANGLE.hoveredElem.nextSibling.getAttribute("index"));var n=void 0;TRIANGLE.hoveredElem.previousSibling&&TRIANGLE.isType.templateItem(TRIANGLE.hoveredElem.previousSibling)&&(n=parseInt(TRIANGLE.hoveredElem.previousSibling.getAttribute("index")));var r=void 0;TRIANGLE.hoveredElem.children[0]&&TRIANGLE.hoveredElem.children[0].getAttribute("index")&&(r=parseInt(TRIANGLE.hoveredElem.children[0].getAttribute("index")));var l=void 0;TRIANGLE.hoveredElem.children[0]&&TRIANGLE.isType.templateItem(TRIANGLE.hoveredElem.lastChild)&&(l=parseInt(TRIANGLE.hoveredElem.lastChild.getAttribute("index")))}if(TRIANGLE.dragDrop.draggingElem)var s=parseInt(TRIANGLE.dragDrop.draggingElem.getAttribute("index"));if(TRIANGLE.hoveredElem!==TRIANGLE.dragDrop.draggingElem){var a=document.getElementById("template"),d=TRIANGLE.templateItems.length-1;if(!(function(e){var t=[],o=document.getElementById("item"+e).querySelectorAll(".templateItem");for(i=0;i<o.length;i++)t[i]=parseInt(o[i].getAttribute("index"));return t}(s).indexOf(parseInt(t))>-1))if(e.clientY<TRIANGLE.dragDrop.itemMap.top[0]&&0!=s)TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.templateItems[0]),console.log("Drag and drop: before all");else if(e.clientY>TRIANGLE.dragDrop.itemMap.bottom[d]&&s!=d)TRIANGLE.dragDrop.createVisBox("inside",a),console.log("Drag and drop: after all");else if(r&&e.clientY>=TRIANGLE.dragDrop.itemMap.top[t]&&e.clientY<=TRIANGLE.dragDrop.itemMap.minY[r]&&s!=r)TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.hoveredElem.children[0]),console.log("Drag and drop: first child");else if(e.clientY<=TRIANGLE.dragDrop.itemMap.minY[t]&&e.clientY>=TRIANGLE.dragDrop.itemMap.maxY[n]&&s!=t)TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.hoveredElem),console.log("Drag and drop: before hovered, after previous row");else if(e.clientY>=TRIANGLE.dragDrop.itemMap.maxY[t]&&e.clientY<=TRIANGLE.dragDrop.itemMap.bottom[o]&&s!=l)TRIANGLE.dragDrop.createVisBox("after",TRIANGLE.hoveredElem),console.log("Drag and drop: last child");else if(e.clientY<TRIANGLE.dragDrop.itemMap.maxY[t]&&e.clientY>TRIANGLE.dragDrop.itemMap.minY[t]){if(s===t)return void TRIANGLE.dragDrop.removeVisBox();if(1===TRIANGLE.hoveredElem.children.length&&TRIANGLE.hoveredElem.children[0].getAttribute("index")==s)return void TRIANGLE.dragDrop.removeVisBox();e.clientX<TRIANGLE.dragDrop.itemMap.maxX[t]&&e.clientX>TRIANGLE.dragDrop.itemMap.minX[t]?(console.log("inside"),TRIANGLE.dragDrop.createVisBox("inside",TRIANGLE.hoveredElem)):t-1<0&&e.clientX<TRIANGLE.dragDrop.itemMap.minX[t]+5?TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.hoveredElem):e.clientX>TRIANGLE.dragDrop.itemMap.right[t-1]&&e.clientX<=TRIANGLE.dragDrop.itemMap.minX[t]&&"right"!=TRIANGLE.hoveredElem.style.cssFloat?TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.hoveredElem):e.clientX<=TRIANGLE.dragDrop.itemMap.minX[t]&&"right"!=TRIANGLE.hoveredElem.style.cssFloat?TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.hoveredElem):e.clientX<TRIANGLE.dragDrop.itemMap.left[t-1]&&e.clientX>=TRIANGLE.dragDrop.itemMap.maxX[t]&&"right"===TRIANGLE.hoveredElem.style.cssFloat?TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.hoveredElem):e.clientX>=TRIANGLE.dragDrop.itemMap.maxX[t]&&"right"===TRIANGLE.hoveredElem.style.cssFloat?TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.hoveredElem):TRIANGLE.dragDrop.createVisBox("inside",TRIANGLE.hoveredElem)}}},createVisBox:function(e,t,o){if(TRIANGLE.dragDrop.removeVisBox(),!document.getElementById("visBox")&&t&&t.parentNode){var i=document.createElement("div"),n=TRIANGLE.dragDrop.draggingElem.getBoundingClientRect();i.style.height=n.height+"px",i.style.width=TRIANGLE.dragDrop.draggingElem.style.width,"auto"===TRIANGLE.dragDrop.draggingElem.style.marginLeft&&(i.style.marginLeft="auto"),"auto"===TRIANGLE.dragDrop.draggingElem.style.marginRight&&(i.style.marginRight="auto");var r=!1,l=document.createElement("div");l.setAttribute("id","clearVisFloatBefore");var s=document.createElement("div");s.setAttribute("id","clearVisFloatAfter"),"left"===TRIANGLE.dragDrop.draggingElem.style.cssFloat?(i.style.cssFloat="left",r=!0):"right"===TRIANGLE.dragDrop.draggingElem.style.cssFloat&&(i.style.cssFloat="right",r=!0),i.setAttribute("id","visBox"),i.addEventListener("mouseover",TRIANGLE.dragDrop.maintainVisBox),i.addEventListener("mouseout",TRIANGLE.dragDrop.removeVisBox);var a=document.createElement("div");a.setAttribute("id","visBoxInner"),i.appendChild(a);document.createElement("div");if("before"!==e&&e?"after"===e?t.nextSibling?(t.parentNode.insertBefore(i,t.nextSibling),r&&!i.nextSibling.style.cssFloat&&t.parentNode.insertBefore(l,t.nextSibling.nextSibling)):(t.parentNode.appendChild(i),r&&i.parentNode.appendChild(s)):"inside"!==e||TRIANGLE.isType.bannedInsertion(t)||(t.appendChild(i),r&&i.parentNode.appendChild(s)):(t.parentNode.insertBefore(i,t),r&&!t.style.cssFloat&&t.parentNode.insertBefore(l,t)),!r){var d=i.nextSibling,m=i.previousSibling;d?i.parentNode.insertBefore(s,d):i.parentNode.appendChild(s),m&&i.parentNode.insertBefore(l,i)}}TRIANGLE.dragDrop.updateItemMap(),TRIANGLE.selectionBorder.remove(),TRIANGLE.hoverBorder.hide(),TRIANGLE.dragDrop.prevHoverElem=TRIANGLE.hoveredElem},removeVisBox:function(){document.getElementById("visBox")&&(document.getElementById("visBox").removeEventListener("mouseover",TRIANGLE.dragDrop.maintainVisBox),document.getElementById("visBox").removeEventListener("mouseout",TRIANGLE.dragDrop.removeVisBox),document.getElementById("clearVisFloat")&&document.getElementById("clearVisFloat").remove(),document.getElementById("clearVisFloatBefore")&&document.getElementById("clearVisFloatBefore").remove(),document.getElementById("clearVisFloatAfter")&&document.getElementById("clearVisFloatAfter").remove(),document.getElementById("visBox").remove(),TRIANGLE.dragDrop.updateItemMap(),TRIANGLE.selectionBorder.remove())},maintainVisBox:function(e){TRIANGLE.hoveredElem=TRIANGLE.dragDrop.prevHoverElem}},TRIANGLE.resetClearFloat=function(){for(;document.getElementsByClassName("clearFloat").length>0;){document.getElementsByClassName("clearFloat")[0].remove()}},TRIANGLE.insertClearFloats=function(){if(TRIANGLE.sv_item.cssFloat){var e=document.createElement("div");if(e.className="clearFloat",e.style.clear="both",TRIANGLE.sv_item.nextSibling()&&TRIANGLE.sv_item.nextSibling().style.cssFloat)return;for(TRIANGLE.sv_item.nextSibling()&&!TRIANGLE.sv_item.nextSibling().style.cssFloat?TRIANGLE.sv_item.parent.insertBefore(e,TRIANGLE.sv_item.nextSibling()):TRIANGLE.sv_item.nextSibling()||TRIANGLE.sv_item.parent.appendChild(e),document.getElementById("visBox")&&!document.getElementById("visBox").style.cssFloat&&document.getElementById("visBox").parentNode.insertBefore(e,document.getElementById("visBox")),x=0;x<TRIANGLE.sv_item.parent.children.length;x++){var t=TRIANGLE.sv_item.parent.children[x],o=t.nextSibling;TRIANGLE.isType.clearFloat(t)&&o&&TRIANGLE.isType.clearFloat(o)&&t.parentNode.removeChild(o)}}},TRIANGLE.updateTemplateItems=function(e){for(TRIANGLE.templateItems=TRIANGLE.refreshTemplateItems(),TRIANGLE.dragDrop.removeVisBox(),TRIANGLE.resetClearFloat(),i=0;i<TRIANGLE.templateItems.length;i++){if(TRIANGLE.sv_item=new TRIANGLE.TemplateItem(i),TRIANGLE.sv_item.objRef.removeEventListener("mousedown",TRIANGLE.importItem.single,!0),TRIANGLE.sv_item.objRef.addEventListener("mousedown",TRIANGLE.importItem.single,!0),/templateItem/g.test(TRIANGLE.sv_item.parent.className)?/childItem/g.test(TRIANGLE.sv_item.className)||(TRIANGLE.sv_item.objRef.className+=" childItem"):TRIANGLE.sv_item.objRef.addEventListener("mousedown",TRIANGLE.dragDrop.applyDrag,!0),TRIANGLE.sv_item.objRef.removeEventListener("mouseover",TRIANGLE.hoverBorder.show,!0),TRIANGLE.sv_item.objRef.addEventListener("mouseover",TRIANGLE.hoverBorder.show,!0),TRIANGLE.isType.textBox(TRIANGLE.sv_item.objRef)?(TRIANGLE.sv_item.objRef.removeEventListener("dblclick",TRIANGLE.text.editText),TRIANGLE.sv_item.objRef.addEventListener("dblclick",TRIANGLE.text.editText)):TRIANGLE.sv_item.objRef.removeEventListener("dblclick",TRIANGLE.text.editText),TRIANGLE.templateItems[i].setAttribute("id","item"+i),TRIANGLE.templateItems[i].setAttribute("index",i),TRIANGLE.isType.childItem(TRIANGLE.sv_item.objRef)){var t=TRIANGLE.sv_item.parent.getAttribute("id");TRIANGLE.sv_item.objRef.setAttribute("childof",t),"template"===t&&TRIANGLE.sv_item.removeClass("childItem")}"table"!==TRIANGLE.sv_item.display||TRIANGLE.sv_item.objRef.innerHTML||(TRIANGLE.sv_item.objRef.style.display="",TRIANGLE.sv_item.objRef.style.height="auto"),TRIANGLE.isType.formField(TRIANGLE.sv_item.objRef)?TRIANGLE.sv_item.objRef.setAttribute("name","item"+i):TRIANGLE.sv_item.objRef.removeAttribute("name"),TRIANGLE.insertClearFloats()}TRIANGLE.dragDrop.updateItemMap(),e&&TRIANGLE.updateTemplateItems()},TRIANGLE.updateTemplateItems(),TRIANGLE.selectItem=function(e){TRIANGLE.item=new TRIANGLE.TemplateItem(e)},TRIANGLE.getOriginalIndex=function(e){var t=!1;return e&&!isNaN(e)&&isFinite(e)&&(t=parseInt(e)),t},TRIANGLE.isType={templateItem:function(e){if(e){var t=e.className;return!!/templateItem/g.test(t)}},childItem:function(e){if(e){var t=e.className;return!!/childItem/g.test(t)}},textBox:function(e){if(e){var t=e.className;return!!/textBox/g.test(t)}},imageItem:function(e){if(e){var t=e.tagName,o=e.className;return!(!/img/gi.test(t)&&!/imageItem/g.test(o))}},snippetItem:function(e){if(e){var t=e.className;return!!/snippetItem/g.test(t)}},verticalAlign:function(e){if(e)return!("table"!==e.style.display||!/style="[^"]*vertical-align:\s*middle;[^"]*"/.test(e.innerHTML))},bannedInsertion:function(e){return!!(TRIANGLE.isType.textBox(e)||TRIANGLE.isType.imageItem(e)||TRIANGLE.isType.formField(e)||TRIANGLE.isType.formBtn(e)||TRIANGLE.isType.snippetItem(e)||TRIANGLE.isType.verticalAlign(e)||"table"===e.style.display)},preventDelete:function(e){return!1},preventDrag:function(e){return!!(TRIANGLE.isType.textBox(e)||TRIANGLE.isType.formField(e)||TRIANGLE.isType.imageItem(e))},itemLabel:function(e){return!!e&&("form"===e.tagName.toLowerCase()?"Form":!!TRIANGLE.isType.snippetItem(e)&&"Code Snippet")},clearFloat:function(e){if(e){var t=e.className;return!!/clearFloat/g.test(t)}},formField:function(e){if(e){var t=e.className;return!!/formField/g.test(t)}},formBtn:function(e){if(e)return"BUTTON"===e.tagName.toUpperCase()},containsNbsp:function(e){return!(!e||"&nbsp;"!=e.innerHTML&&"&nbsp;"!=e.childNodes[0])}},TRIANGLE.stripNbsp=function(e){"&nbsp;"==e.childNodes[0]?e.removeChild(e.childNodes[0]):"&nbsp;"==e.innerHTML&&(e.innerHTML="")},TRIANGLE.contentWidth=function(e){var t,o=document.createElement("div");return o.id="measureContentWidth",e.appendChild(o),t=document.getElementById("measureContentWidth").getBoundingClientRect().width,e.removeChild(document.getElementById("measureContentWidth")),t},TRIANGLE.randomColor=function(){return"rgb("+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+")"},TRIANGLE.getUnit=function(e){if(e){var t=e.match(/\D+/g);return!!t&&t[t.length-1]}return!1},TRIANGLE.menu={displaySubMenu:function(e){var t=document.getElementsByClassName("subMenu");for(i=0;i<t.length;i++)t[i].style.display="none";document.getElementById(e).style.display="block"},addMenuBtnEvent:function(){var e=document.getElementsByClassName("mainOption");for(i=0;i<e.length;i++){var t=e[i].getAttribute("onClick");t+="TRIANGLE.menu.menuBtnActive(this);",e[i].setAttribute("onClick",t)}},menuBtnActive:function(e){var t=document.getElementsByClassName("mainOption");for(i=0;i<t.length;i++)t[i].style.backgroundColor="",t[i].style.color="";e.style.backgroundColor="#E6E6E6",e.style.color="#000000"},addOptionLabelEvents:function(){var e,t=document.getElementsByClassName("optionLabel");for(i=0;i<t.length;i++)e=t[i].getAttribute("id"),t[i].parentElement.setAttribute("onMouseOver","TRIANGLE.menu.optionLabel('"+e+"');"),t[i].parentElement.setAttribute("onMouseOut","TRIANGLE.menu.optionLabel('"+e+"');")},optionLabel:function(e){"block"!==document.getElementById(e).style.display?document.getElementById(e).style.display="block":document.getElementById(e).style.display="none"},toggleMenuDisplay:function(e,t){var o=document.getElementById("menu").querySelectorAll(".hidden");if("none"==document.getElementById(e).style.display){for(i=0;i<o.length;i++)o[i].style.display="none";document.getElementById(e).style.display=t}else document.getElementById(e).style.display="none"},sideMenuId:null,openSideMenu:function(e){TRIANGLE.menu.sideMenuId=e,document.getElementById(e).style.display="block",document.getElementById("sideMenu").className="sideMenuOpen"},closeSideMenu:function(){TRIANGLE.menu.sideMenuId&&(document.getElementById("sideMenu").className="sideMenuClose",document.getElementById(TRIANGLE.menu.sideMenuId).style.display="none",TRIANGLE.menu.sideMenuId=null)},displayLibraryCategory:function(e){var t=document.getElementById(e);"none"!==t.style.display?t.style.display="none":t.style.display="block"}},TRIANGLE.appendRow=function(){TRIANGLE.selectionBorder.remove();var e,t=document.createElement("div");t.className="templateItem",t.style.backgroundColor="#508CA4",t.style.minHeight="100px",t.style.height="auto",t.style.width="100%",t.style.position="relative",TRIANGLE.item?(document.getElementById("template").insertBefore(t,TRIANGLE.item.objRef.nextSibling),e=TRIANGLE.item.index+1):(document.getElementById("template").appendChild(t),window.scrollTo(0,document.body.scrollHeight),e=TRIANGLE.templateItems.length-1),TRIANGLE.updateTemplateItems(),TRIANGLE.clearSelection(),TRIANGLE.selectItem(e),TRIANGLE.saveItem.createAnimation("min-height",0,"100px",function(){TRIANGLE.importItem.single(TRIANGLE.item.index)})},TRIANGLE.insertNewChild=function(){if(!(TRIANGLE.item&&TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef)||TRIANGLE.item.objRef.children[0]&&"table-cell"==TRIANGLE.item.objRef.children[0].style.display)){TRIANGLE.isType.containsNbsp(TRIANGLE.item.objRef)&&TRIANGLE.stripNbsp(TRIANGLE.item.objRef),TRIANGLE.checkPadding(TRIANGLE.item.objRef);var e=document.createElement("div");e.className="templateItem childItem",e.style.backgroundColor="#BFD7EA",e.style.minHeight="100px",e.style.height="auto",e.style.width="100%",e.style.position="relative",TRIANGLE.item.append(e),TRIANGLE.updateTemplateItems(!0),TRIANGLE.selectionBorder.remove();var t=TRIANGLE.item.objRef.children.length,o=TRIANGLE.item.objRef.children[t-1].getAttribute("index");TRIANGLE.selectItem(o),TRIANGLE.saveItem.createAnimation("min-height",0,"100px",function(){TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.updateTemplateItems()}},TRIANGLE.selectParent=function(){if(TRIANGLE.item){var e=TRIANGLE.item.objRef.parentElement;if("template"==e.id)return;var t=parseInt(e.getAttribute("index"));TRIANGLE.importItem.single(t)}},TRIANGLE.checkPadding=function(e){0!==parseInt(e.style.paddingLeft)&&e.style.paddingLeft||0!==parseInt(e.style.paddingRight)&&e.style.paddingRight||0!==parseInt(e.style.paddingTop)&&e.style.paddingTop||0!==parseInt(e.style.paddingBottom)&&e.style.paddingBottom||(e.style.paddingTop="10px",e.style.paddingRight="10px",e.style.paddingBottom="10px",e.style.paddingLeft="10px")},TRIANGLE.tooltip={show:function(e){document.getElementById("tooltip").innerHTML=e,document.getElementById("tooltip").style.display="block"},update:function(e){document.getElementById("tooltip").style.top=e.clientY+15+"px",document.getElementById("tooltip").style.left=e.clientX+15+"px"},hide:function(){document.getElementById("tooltip").style.display="none"}},TRIANGLE.generateBorder=function(e){var t=document.createElement("div");t.style.border="1px solid #478BE3",t.setAttribute("id","showHoverBorder"),t.style.position="fixed",t.style.height=e.height+6+"px",t.style.width=e.width+6+"px",t.style.top=e.top-3+"px",t.style.left=e.left-3+"px",t.style.zIndex=1;var o=document.createElement("div");return o.style.height="100%",o.style.width="100%",o.style.border="1px solid #478BE3",o.style.padding="1px",o.setAttribute("id","noClickThru"),t.appendChild(o),t},TRIANGLE.hoveredElem=!1,TRIANGLE.hoverBorder={show:function(e){if(!(TRIANGLE.resize.active||TRIANGLE.saveItem.animationActive||TRIANGLE.images.crop.active)){TRIANGLE.hoverBorder.hide();var t=this.getBoundingClientRect();document.getElementById("template").appendChild(TRIANGLE.generateBorder(t)),TRIANGLE.hoveredElem=this;var o=TRIANGLE.isType.itemLabel(this),i=this.getAttribute("user-id"),n=this.getAttribute("user-class"),r=this.getAttribute("href")||this.getAttribute("link-to");o?(document.addEventListener("mousemove",TRIANGLE.tooltip.update),TRIANGLE.tooltip.show(o)):i?(document.addEventListener("mousemove",TRIANGLE.tooltip.update),TRIANGLE.tooltip.show("ID: "+i)):n?(document.addEventListener("mousemove",TRIANGLE.tooltip.update),TRIANGLE.tooltip.show("Class: "+n)):r?(document.addEventListener("mousemove",TRIANGLE.tooltip.update),r.length>30&&(r=r.slice(0,30)+"..."),TRIANGLE.tooltip.show("Link: "+r)):(document.removeEventListener("mousemove",TRIANGLE.tooltip.update),TRIANGLE.tooltip.hide())}},hide:function(){document.getElementById("showHoverBorder")&&(document.getElementById("template").removeChild(document.getElementById("showHoverBorder")),TRIANGLE.hoveredElem=!1,TRIANGLE.tooltip.hide(),document.removeEventListener("mousemove",TRIANGLE.tooltip.update))}},TRIANGLE.selectionBorder={style:"1px solid #90F3FF",create:function(){if(TRIANGLE.item){TRIANGLE.hoverBorder.hide(),TRIANGLE.selectionBorder.remove();var e=TRIANGLE.item.objRef.getBoundingClientRect();document.getElementById("template").appendChild(TRIANGLE.generateBorder(e)),document.getElementById("showHoverBorder").setAttribute("id","selectionBorder");var t=document.getElementById("selectionBorder");TRIANGLE.item.objRef.isContentEditable?t.style.border="1px dashed black":t.style.border=TRIANGLE.selectionBorder.style,t.style.zIndex=2,TRIANGLE.resize.showHandles()}else if(document.getElementById("showHoverBorder")){document.getElementById("showHoverBorder").id="selectionBorder",(t=document.getElementById("selectionBorder")).style.border=TRIANGLE.selectionBorder.style,TRIANGLE.resize.showHandles()}TRIANGLE.unsaved=!0},remove:function(){document.getElementById("selectionBorder")&&(document.getElementById("template").removeChild(document.getElementById("selectionBorder")),TRIANGLE.resize.removeHandles())},update:function(){document.getElementById("selectionBorder")&&(TRIANGLE.selectionBorder.remove(),TRIANGLE.selectionBorder.create())}},TRIANGLE.resize={showHandles:function(){if("table-cell"!==TRIANGLE.item.display&&!TRIANGLE.item.objRef.isContentEditable){var e,t,o=TRIANGLE.scrollbarWidth,i=TRIANGLE.item.objRef.getBoundingClientRect(),n=document.getElementById("selectionBorder"),r="resizeHandle",l=TRIANGLE.isType.imageItem(TRIANGLE.item.objRef),s=document.createElement("div");if(s.style.width="8px",s.style.height="8px",s.style.cursor="row-resize",s.className="marginHandle",s.style.top=i.top-4-2+"px",s.style.left=i.left+(i.width/2-4)+"px",n.appendChild(s),s.addEventListener("mouseover",TRIANGLE.resize.margin.top),s.addEventListener("mousedown",TRIANGLE.resize.margin.initiate),l)if("right"!=TRIANGLE.item.align){var a=document.createElement("div");a.style.width="8px",a.style.height="8px",a.style.cursor="ne-resize",a.className=r,a.style.top=i.top-8+2+"px",i.right>=window.innerWidth-o?a.style.left=window.innerWidth-o-8+"px":a.style.left=i.right-2+"px",n.appendChild(a),a.addEventListener("mouseover",TRIANGLE.resize.XY),a.addEventListener("mousedown",TRIANGLE.resize.initiate);var d=document.createElement("div");d.style.width="8px",d.style.height="8px",d.style.cursor="se-resize",d.className=r,d.style.top=i.bottom-2+"px",i.right>=window.innerWidth-o?d.style.left=window.innerWidth-o-8+"px":d.style.left=i.right-2+"px",n.appendChild(d),d.addEventListener("mouseover",TRIANGLE.resize.XY),d.addEventListener("mousedown",TRIANGLE.resize.initiate)}else{var m=document.createElement("div");m.style.width="8px",m.style.height="8px",m.style.cursor="nw-resize",m.className=r,m.style.top=i.top-8+2+"px",i.left<=0?m.style.left="5px":m.style.left=i.left-4-2+"px",n.appendChild(m),m.addEventListener("mouseover",TRIANGLE.resize.XY),m.addEventListener("mousedown",TRIANGLE.resize.initiate);var c=document.createElement("div");c.style.width="8px",c.style.height="8px",c.style.cursor="sw-resize",c.className=r,c.style.top=i.bottom-2+"px",i.left<=0?c.style.left="5px":c.style.left=i.left-4-2+"px",n.appendChild(c),c.addEventListener("mouseover",TRIANGLE.resize.XY),c.addEventListener("mousedown",TRIANGLE.resize.initiate)}else{var I=document.createElement("div");I.style.width="8px",I.style.height="8px",I.style.cursor="s-resize",I.className=r,I.style.top=i.bottom-2+"px",I.style.left=i.left+(i.width/2-4)+"px",n.appendChild(I),I.addEventListener("mouseover",TRIANGLE.resize.Y),I.addEventListener("mousedown",TRIANGLE.resize.initiate)}if("right"!==TRIANGLE.item.align)(t=document.createElement("div")).style.width="8px",t.style.height="8px",t.style.cursor="e-resize",t.className=r,t.style.top=i.top+(i.height/2-4)+"px",i.right>=window.innerWidth-o?t.style.left=window.innerWidth-o-8+"px":t.style.left=i.right-2+"px",n.appendChild(t),l?t.addEventListener("mouseover",TRIANGLE.resize.XY):t.addEventListener("mouseover",TRIANGLE.resize.X),t.addEventListener("mousedown",TRIANGLE.resize.initiate),(e=document.createElement("div")).style.width="8px",e.style.height="8px",e.style.cursor="col-resize",e.className="marginHandle",e.style.top=i.top+(i.height/2-4)+"px",i.left<=0?e.style.left="5px":e.style.left=i.left-4-2+"px",n.appendChild(e),e.addEventListener("mouseover",TRIANGLE.resize.margin.left),e.addEventListener("mousedown",TRIANGLE.resize.margin.initiate);else(e=document.createElement("div")).style.width="8px",e.style.height="8px",e.style.cursor="e-resize",e.className=r,e.style.top=i.top+(i.height/2-4)+"px",i.left<=0?e.style.left="5px":e.style.left=i.left-4-2+"px",n.appendChild(e),l?e.addEventListener("mouseover",TRIANGLE.resize.XY):e.addEventListener("mouseover",TRIANGLE.resize.X),e.addEventListener("mousedown",TRIANGLE.resize.initiate),(t=document.createElement("div")).style.width="8px",t.style.height="8px",t.style.cursor="col-resize",t.className="marginHandle",t.style.top=i.top+(i.height/2-4)+"px",i.right>=window.innerWidth-o?t.style.left=window.innerWidth-o-8+"px":t.style.left=i.right-2+"px",n.appendChild(t),t.addEventListener("mouseover",TRIANGLE.resize.margin.right),t.addEventListener("mousedown",TRIANGLE.resize.margin.initiate)}},activeElem:-1,active:!1,direction:"X or Y or XY",XYratio:null,contentWidth:null,X:function(){TRIANGLE.resize.active||(TRIANGLE.resize.activeElem=TRIANGLE.item.index,TRIANGLE.resize.direction="X")},Y:function(){TRIANGLE.resize.active||(TRIANGLE.resize.activeElem=TRIANGLE.item.index,TRIANGLE.resize.direction="Y")},XY:function(){if(!TRIANGLE.resize.active){TRIANGLE.resize.activeElem=TRIANGLE.item.index,TRIANGLE.resize.direction="XY";var e=TRIANGLE.item.objRef.getBoundingClientRect();TRIANGLE.resize.XYratio=e.width/e.height}},initiate:function(e){TRIANGLE.resize.active=!0,TRIANGLE.selectItem(TRIANGLE.resize.activeElem),document.body.addEventListener("mouseup",TRIANGLE.resize.stop),document.body.addEventListener("mousemove",TRIANGLE.resize.start),TRIANGLE.item.objRef.style.maxWidth="100%",document.getElementById("dimensionLabels").style.display="inline-block",document.getElementById("widthLabel").innerHTML="W: "+TRIANGLE.item.width,document.getElementById("heightLabel").innerHTML="H: "+TRIANGLE.item.minHeight,TRIANGLE.resize.contentWidth=TRIANGLE.contentWidth(TRIANGLE.item.parent),TRIANGLE.text.preventTextSelect()},stop:function(){TRIANGLE.importItem.single(TRIANGLE.item.index),TRIANGLE.resize.activeElem=-1,TRIANGLE.resize.active=!1,TRIANGLE.resize.direction=!1,TRIANGLE.resize.contentWidth=null,document.getElementById("bottomMarker").style.marginTop=0,TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)||(TRIANGLE.item.objRef.style.maxWidth=""),"%"===TRIANGLE.getUnit(TRIANGLE.item.width)&&parseFloat(TRIANGLE.item.width)>100?(TRIANGLE.item.objRef.style.width="100%",TRIANGLE.updateTemplateItems(),TRIANGLE.importItem.single(TRIANGLE.item.index)):"%"!==TRIANGLE.getUnit(TRIANGLE.item.width)&&parseFloat(TRIANGLE.item.width)>TRIANGLE.item.parent.getBoundingClientRect().width&&(TRIANGLE.item.objRef.style.width="100%",TRIANGLE.updateTemplateItems(),TRIANGLE.importItem.single(TRIANGLE.item.index)),TRIANGLE.item.objRef.style.width=document.getElementById("widthLabel").innerHTML.replace(/W: /g,""),document.body.removeEventListener("mouseup",TRIANGLE.resize.stop),document.body.removeEventListener("mousemove",TRIANGLE.resize.start),TRIANGLE.selectionBorder.create(),TRIANGLE.text.clearTextSelection(),TRIANGLE.saveItem.equalizeUserClasses(TRIANGLE.item.userClass),TRIANGLE.text.allowTextSelect(),TRIANGLE.tooltip.hide()},start:function(e){TRIANGLE.locateColumns();var t=TRIANGLE.item;if(TRIANGLE.resize.active){var o=e.clientX,n=e.clientY,r=TRIANGLE.item.objRef.getBoundingClientRect(),l=TRIANGLE.item.parent.getBoundingClientRect(),s=document.getElementById("widthLabel"),a=document.getElementById("heightLabel"),d=e.shiftKey?30:3;if("X"===TRIANGLE.resize.direction){if("right"!==t.align&&o>r.left+2){R();var m=TRIANGLE.item.nextSibling()?TRIANGLE.item.nextSibling().getBoundingClientRect():null,c=TRIANGLE.item.prevSibling()?TRIANGLE.item.prevSibling().getBoundingClientRect():null;m&&o>=m.left-3&&o<=m.left+3&&(o=m.left),"%"===TRIANGLE.getUnit(t.width)?(o<=r.left+TRIANGLE.resize.contentWidth/2+d&&o>=r.left+TRIANGLE.resize.contentWidth/2-d?t.objRef.style.width="50%":o<=r.left+TRIANGLE.resize.contentWidth/3+d&&o>=r.left+TRIANGLE.resize.contentWidth/3-d?t.objRef.style.width="33.33%":o<=r.left+2*TRIANGLE.resize.contentWidth/3+d&&o>=r.left+2*TRIANGLE.resize.contentWidth/3-d?t.objRef.style.width="66.66%":t.objRef.style.width=Math.ceil((o-r.left)/TRIANGLE.resize.contentWidth*1e4)/100+"%",parseFloat(t.objRef.style.width)>100?s.innerHTML="W: 100%":s.innerHTML="W: "+t.objRef.style.width):parseFloat(t.objRef.style.width)>l.width?(t.objRef.style.width=Math.floor(o-r.left)+"px",s.innerHTML="W: 100%"):(t.objRef.style.width=Math.floor(o-r.left)+"px",s.innerHTML="W: "+t.objRef.style.width)}else{if(!("right"===t.align&&o<r.right-2))return;R();m=TRIANGLE.item.nextSibling()?TRIANGLE.item.nextSibling().getBoundingClientRect():null;if((c=TRIANGLE.item.prevSibling()?TRIANGLE.item.prevSibling().getBoundingClientRect():null)&&o<=c.right+3&&o>=c.right-3)o=c.right;else for(i=0;i<TRIANGLE.templateItems.length;i++)o<=TRIANGLE.columnMap.right[i]+3&&o>=TRIANGLE.columnMap.right[i]-3&&(o=TRIANGLE.columnMap.right[i]);"%"===TRIANGLE.getUnit(t.width)?(o<=r.right-TRIANGLE.resize.contentWidth/2+d&&o>=r.right-TRIANGLE.resize.contentWidth/2-d?t.objRef.style.width="50%":o<=r.right-TRIANGLE.resize.contentWidth/3+d&&o>=r.right-TRIANGLE.resize.contentWidth/3-d?t.objRef.style.width="33.33%":o<=r.right-2*TRIANGLE.resize.contentWidth/3+d&&o>=r.right-2*TRIANGLE.resize.contentWidth/3-d?t.objRef.style.width="66.66%":t.objRef.style.width=Math.ceil((r.right-o)/TRIANGLE.resize.contentWidth*1e4)/100+"%",parseFloat(t.objRef.style.width)>100?s.innerHTML="W: 100%":s.innerHTML="W: "+t.objRef.style.width):parseFloat(t.objRef.style.width)>l.width?(t.objRef.style.width=Math.floor(r.right-o)+"px",s.innerHTML="W: 100%"):(t.objRef.style.width=Math.floor(r.right-o)+"px",s.innerHTML="W: "+t.objRef.style.width)}TRIANGLE.selectionBorder.update(),TRIANGLE.tooltip.update(e),TRIANGLE.tooltip.show(s.innerHTML)}else if("Y"===TRIANGLE.resize.direction){if(!(n>r.top+2))return;t.objRef.style.minHeight=Math.floor(n-r.top)+"px",TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)&&(t.objRef.style.height=t.objRef.style.minHeight),(t.transform||"table"==t.display)&&(t.objRef.style.height=t.objRef.style.minHeight),t.isLastChild&&(document.getElementById("bottomMarker").style.marginTop=window.innerHeight+"px"),u(),TRIANGLE.selectionBorder.update(),a.innerHTML="H: "+t.objRef.style.minHeight,TRIANGLE.selectionBorder.update(),TRIANGLE.tooltip.update(e),TRIANGLE.tooltip.show(a.innerHTML)}else if("XY"===TRIANGLE.resize.direction){if("right"!==TRIANGLE.item.align){if(o>r.left+2){var I=R();if((p=Math.round(o-r.left))>TRIANGLE.resize.contentWidth)return;t.objRef.style.width=p+"px",t.objRef.style.minHeight=Math.round(p/TRIANGLE.resize.XYratio)+"px",t.objRef.style.height=t.objRef.style.minHeight;var E=u();if(I||E)return void TRIANGLE.selectionBorder.update()}}else if(o<r.right-2){var p;I=R();if((p=Math.round(r.right-o))>TRIANGLE.resize.contentWidth)return;t.objRef.style.width=p+"px",t.objRef.style.minHeight=Math.round(p/TRIANGLE.resize.XYratio)+"px",t.objRef.style.height=t.objRef.style.minHeight;E=u();if(I||E())return void TRIANGLE.selectionBorder.update()}s.innerHTML="W: "+t.objRef.style.width,a.innerHTML="H: "+t.objRef.style.minHeight}TRIANGLE.selectionBorder.create(),TRIANGLE.saveItem.equalizeUserClasses(TRIANGLE.item.userClass)}function R(){var e=!1,t=TRIANGLE.templateItems.length;for(i=0;i<t;i++)(TRIANGLE.item.isAbove(i)||TRIANGLE.item.isBelow(i))&&(o>=TRIANGLE.columnMap.left[i]-3&&o<=TRIANGLE.columnMap.left[i]+3?(o=TRIANGLE.columnMap.left[i],e=!0):o>=TRIANGLE.columnMap.right[i]-3&&o<=TRIANGLE.columnMap.right[i]+3&&(o=TRIANGLE.columnMap.right[i],e=!0));return e}function u(){var e=!1,o=t.nextSibling()?t.nextSibling().getAttribute("index"):null;return TRIANGLE.item.isBelow(parseInt(o))||(t.nextSibling()&&n>=t.nextSibling().getBoundingClientRect().bottom-3&&n<=t.nextSibling().getBoundingClientRect().bottom+3?(t.objRef.style.minHeight=t.nextSibling().getBoundingClientRect().bottom-r.top+"px",e=!0):t.prevSibling()&&n>=t.prevSibling().getBoundingClientRect().bottom-3&&n<=t.prevSibling().getBoundingClientRect().bottom+3&&(t.objRef.style.minHeight=t.prevSibling().getBoundingClientRect().bottom-r.top+"px",e=!0)),e}TRIANGLE.text.clearTextSelection()},removeHandles:function(){for(;document.getElementsByClassName("resizeHandle").length>0;){var e=document.getElementsByClassName("resizeHandle");e[0].removeEventListener("mouseover",TRIANGLE.resize.Y),e[0].removeEventListener("mouseover",TRIANGLE.resize.X),e[0].removeEventListener("mouseover",TRIANGLE.resize.XY),e[0].remove()}for(;document.getElementsByClassName("marginHandle").length>0;){var t=document.getElementsByClassName("marginHandle");t[0].removeEventListener("mouseover",TRIANGLE.resize.margin.top),t[0].removeEventListener("mouseover",TRIANGLE.resize.margin.right),t[0].removeEventListener("mouseover",TRIANGLE.resize.margin.bottom),t[0].removeEventListener("mouseover",TRIANGLE.resize.margin.left),t[0].remove()}},margin:{top:function(){TRIANGLE.resize.active||(TRIANGLE.resize.activeElem=TRIANGLE.item.index,TRIANGLE.resize.direction="marginTop")},bottom:function(){TRIANGLE.resize.active||(TRIANGLE.resize.activeElem=TRIANGLE.item.index,TRIANGLE.resize.direction="marginBottom")},left:function(){TRIANGLE.resize.active||(TRIANGLE.resize.activeElem=TRIANGLE.item.index,TRIANGLE.resize.direction="marginLeft")},right:function(){TRIANGLE.resize.active||(TRIANGLE.resize.activeElem=TRIANGLE.item.index,TRIANGLE.resize.direction="marginRight")},side:null,currentMargin:null,initiate:function(){TRIANGLE.resize.active=!0,TRIANGLE.selectItem(TRIANGLE.resize.activeElem),document.body.addEventListener("mouseup",TRIANGLE.resize.margin.stop),document.body.addEventListener("mousemove",TRIANGLE.resize.margin.start),document.getElementById("dimensionLabels").style.display="inline-block",document.getElementById("widthLabel").innerHTML="M: "+TRIANGLE.item[TRIANGLE.resize.direction],document.getElementById("heightLabel").innerHTML="",TRIANGLE.resize.margin.side=TRIANGLE.resize.direction.replace(/margin/,"").toLowerCase(),TRIANGLE.resize.margin.currentMargin=TRIANGLE.item.objRef.getBoundingClientRect()[TRIANGLE.resize.margin.side]-parseFloat(window.getComputedStyle(TRIANGLE.item.objRef).getPropertyValue(TRIANGLE.resize.direction.replace(/([A-Z])/,"-$1").toLowerCase())),TRIANGLE.text.preventTextSelect()},stop:function(){TRIANGLE.importItem.single(TRIANGLE.item.index),TRIANGLE.resize.activeElem=-1,TRIANGLE.resize.active=!1,TRIANGLE.resize.direction=!1,document.getElementById("bottomMarker").style.marginTop=0,TRIANGLE.updateTemplateItems(),TRIANGLE.importItem.single(TRIANGLE.item.index),document.body.removeEventListener("mouseup",TRIANGLE.resize.margin.stop),document.body.removeEventListener("mousemove",TRIANGLE.resize.margin.start),TRIANGLE.selectionBorder.create(),TRIANGLE.text.clearTextSelection(),TRIANGLE.text.allowTextSelect(),TRIANGLE.saveItem.equalizeUserClasses(TRIANGLE.item.userClass),TRIANGLE.tooltip.hide()},start:function(e){var t=TRIANGLE.item;if(TRIANGLE.resize.active){t.objRef.getBoundingClientRect();var o,i,n,r=document.getElementById("widthLabel"),l=e.shiftKey?5:1;if("marginTop"===TRIANGLE.resize.direction||"marginBottom"===TRIANGLE.resize.direction)i="marginTop"===TRIANGLE.resize.direction?"marginBottom":"marginTop",n=(o=e.clientY)<TRIANGLE.resize.margin.currentMargin;else{if("marginLeft"!==TRIANGLE.resize.direction&&"marginRight"!==TRIANGLE.resize.direction)return;i="marginLeft"===TRIANGLE.resize.direction?"marginRight":"marginLeft",o=e.clientX,n="marginLeft"===TRIANGLE.resize.direction?o<TRIANGLE.resize.margin.currentMargin:o>TRIANGLE.resize.margin.currentMargin}"%"===TRIANGLE.getUnit(t[TRIANGLE.resize.direction])?t.objRef.style[TRIANGLE.resize.direction]=Math.abs(Math.ceil((o-TRIANGLE.resize.margin.currentMargin)/t.parent.getBoundingClientRect().width*1e4)/100)+"%":t.objRef.style[TRIANGLE.resize.direction]=Math.floor(Math.abs(o-TRIANGLE.resize.margin.currentMargin)/l)*l+"px",n&&(t.objRef.style[TRIANGLE.resize.direction]=0),function(){var e=!1;if("top"===TRIANGLE.resize.margin.side||"bottom"===TRIANGLE.resize.margin.side){var i=!!t.nextSibling()&&t.nextSibling().getBoundingClientRect(),n=!!t.prevSibling()&&t.prevSibling().getBoundingClientRect();i&&o>=i[TRIANGLE.resize.margin.side]-3&&o<=i[TRIANGLE.resize.margin.side]+3?(t.objRef.style[TRIANGLE.resize.direction]=t.nextSibling().style[TRIANGLE.resize.direction],e=!0):n&&o>=n[TRIANGLE.resize.margin.side]-3&&o<=n[TRIANGLE.resize.margin.side]+3&&(t.objRef.style[TRIANGLE.resize.direction]=t.prevSibling().style[TRIANGLE.resize.direction],e=!0)}}(),e.altKey&&(t.objRef.style[i]=t.objRef.style[TRIANGLE.resize.direction]),r.innerHTML="M: "+t.objRef.style[TRIANGLE.resize.direction],TRIANGLE.selectionBorder.update(),TRIANGLE.tooltip.update(e),TRIANGLE.tooltip.show(r.innerHTML)}}}},TRIANGLE.importItem={group:[],groupIndex:function(e,t){if(e=parseInt(e),-1===TRIANGLE.importItem.group.indexOf(e))TRIANGLE.importItem.group[TRIANGLE.importItem.group.length]=e,TRIANGLE.importItem.group.sort();else if(TRIANGLE.importItem.group.length>1){var o=TRIANGLE.importItem.group.indexOf(parseInt(e));TRIANGLE.importItem.group.splice(o,1)}},currentUserClass:!1,single:function(e,t){if(isNaN(parseInt(e))){t=e;try{e=this.getAttribute("index")}catch(e){return void console.log(e.message)}t.shiftKey?TRIANGLE.importItem.groupIndex(e,t):TRIANGLE.importItem.group=[parseInt(e)]}else t&&t.shiftKey?TRIANGLE.importItem.groupIndex(e,t):isNaN(parseInt(e))||(TRIANGLE.importItem.group=[parseInt(e)]);var o,n,r,l,s,a,d,m,c,I,E,p,R,u,T,g,L,A,N,y,G=e;if(arguments.length>1)G=arguments[0];else if(1===arguments.length&&(/\d/.test(arguments[0])||parseInt(arguments[0])))G=arguments[0];else{if(!this)return;G=this.getAttribute("index")}function f(e,t,o){document.getElementById(e).setAttribute("onClick",t+"("+o+");")}TRIANGLE.selectItem(G),TRIANGLE.selectionBorder.create(t),document.body.addEventListener("keyup",TRIANGLE.keyEvents.whichKey.item),function(){var e=TRIANGLE.item.bgColor;/rgba/.test(e)||(e=TRIANGLE.colors.rgbToHex(TRIANGLE.item.bgColor));document.getElementById("bgColor").value=e}(),o=TRIANGLE.item.minHeight,document.getElementById("height").value=o,document.getElementById("heightLabel").innerHTML="H: "+o,document.getElementById("dimensionLabels").style.display="inline-block",n=TRIANGLE.item.width,document.getElementById("width").value=n,document.getElementById("widthLabel").innerHTML="W: "+n,document.getElementById("dimensionLabels").style.display="inline-block",r=TRIANGLE.item.display,document.getElementById("display").value=r,l=TRIANGLE.item.paddingLeft,s=TRIANGLE.item.paddingRight,a=TRIANGLE.item.paddingTop,d=TRIANGLE.item.paddingBottom,m=document.getElementById("paddingL"),c=document.getElementById("paddingR"),I=document.getElementById("paddingT"),E=document.getElementById("paddingB"),m.value=l,c.value=s,I.value=a,E.value=d,p=TRIANGLE.item.marginLeft,R=TRIANGLE.item.marginRight,u=TRIANGLE.item.marginTop,T=TRIANGLE.item.marginBottom,g=document.getElementById("marginL"),L=document.getElementById("marginR"),A=document.getElementById("marginT"),N=document.getElementById("marginB"),g.value=p,L.value=R,A.value=u,N.value=T,function(){var e=TRIANGLE.item.borderLeftWidth,t=TRIANGLE.item.borderLeftStyle,o=TRIANGLE.item.borderLeftColor,i=document.getElementById("borderLwidth"),n=document.getElementById("borderLtype"),r=(n.options[n.selectedIndex].text,document.getElementById("borderLcolor"));i.value=e?parseInt(e):"";"solid"===t?n.selectedIndex=0:"dashed"===t?n.selectedIndex=1:"dotted"===t&&(n.selectedIndex=2);""!==i.value&&(/rgb/.test(o)?r.value=TRIANGLE.colors.rgbToHex(o):r.value=o);var l=TRIANGLE.item.borderRightWidth,s=TRIANGLE.item.borderRightStyle,a=TRIANGLE.item.borderRightColor,d=document.getElementById("borderRwidth"),m=document.getElementById("borderRtype"),c=(m.options[m.selectedIndex].text,document.getElementById("borderRcolor"));d.value=l?parseInt(l):"";"solid"===s?m.selectedIndex=0:"dashed"===s?m.selectedIndex=1:"dotted"===s&&(m.selectedIndex=2);""!==d.value&&(/rgb/.test(a)?c.value=TRIANGLE.colors.rgbToHex(a):c.value=a);var I=TRIANGLE.item.borderTopWidth,E=TRIANGLE.item.borderTopStyle,p=TRIANGLE.item.borderTopColor,R=document.getElementById("borderTwidth"),u=document.getElementById("borderTtype"),T=(u.options[u.selectedIndex].text,document.getElementById("borderTcolor"));R.value=I?parseInt(I):"";"solid"===E?u.selectedIndex=0:"dashed"===E?u.selectedIndex=1:"dotted"===E&&(u.selectedIndex=2);""!==R.value&&(/rgb/.test(p)?T.value=TRIANGLE.colors.rgbToHex(p):T.value=p);var g=TRIANGLE.item.borderBottomWidth,L=TRIANGLE.item.borderBottomStyle,A=TRIANGLE.item.borderBottomColor,N=document.getElementById("borderBwidth"),y=document.getElementById("borderBtype"),G=(y.options[y.selectedIndex].text,document.getElementById("borderBcolor"));N.value=g?parseInt(g):"";"solid"===L?y.selectedIndex=0:"dashed"===L?y.selectedIndex=1:"dotted"===L&&(y.selectedIndex=2);""!==N.value&&(/rgb/.test(A)?G.value=TRIANGLE.colors.rgbToHex(A):G.value=A)}(),function(){var e=TRIANGLE.item.boxShadow.replace(/rgb\((\d+), (\d+), (\d+)\)/g,"rgb($1,$2,$3)").split(" "),t=document.getElementById("boxShadowH"),o=document.getElementById("boxShadowV"),i=document.getElementById("boxShadowBlur"),n=document.getElementById("boxShadowColor");isNaN(parseInt(e[0]))?(n.value=e[0],t.value=e[1],o.value=e[2],i.value=e[3]):isNaN(parseInt(e[1]))?(n.value=e[1],t.value=e[0],o.value=e[2],i.value=e[3]):isNaN(parseInt(e[2]))?(n.value=e[2],t.value=e[0],o.value=e[1],i.value=e[3]):isNaN(parseInt(e[3]))&&(n.value=e[3],t.value=e[0],o.value=e[1],i.value=e[2]);""!=t.value&&"undefined"!=t.value||(t.value="");""!=o.value&&"undefined"!=o.value||(o.value="");""!=i.value&&"undefined"!=i.value||(i.value="");""!=n.value&&"undefined"!=n.value||(n.value="black")}(),TRIANGLE.importItem.importColors(),function(){var e=TRIANGLE.colors.rgbToHex(TRIANGLE.item.fontColor),t=document.getElementById("fontColor"),o=TRIANGLE.item.fontSize,n=document.getElementById("fontSize"),r=TRIANGLE.item.lineHeight,l=document.getElementById("fontLineHeight"),s=document.getElementById("fontType"),a=TRIANGLE.item.fontWeight,d=document.getElementById("fontWeight");for(t.value=e,n.value=isNaN(parseFloat(o))?null:parseFloat(o),l.value=r,d.value=a,i=0;i<s.options.length;i++){var m=s.options[i].text;if(m==TRIANGLE.item.fontFamily.replace(/'|"/g,"")){s.selectedIndex=i;break}}}(),TRIANGLE.item.userID?document.getElementById("userID").value=TRIANGLE.item.userID:document.getElementById("userID").value="",TRIANGLE.item.userClass?(document.getElementById("userClass").value=TRIANGLE.item.userClass,TRIANGLE.importItem.currentUserClass=TRIANGLE.item.objRef):(document.getElementById("userClass").value="",TRIANGLE.importItem.currentUserClass=!1),function(){if(null===TRIANGLE.text.importedHyperlink){var e,t=TRIANGLE.item.objRef.firstChild?TRIANGLE.item.objRef.firstChild.tagName:null;if(TRIANGLE.item.linkTo||"A"===t)(e=TRIANGLE.item.linkTo?TRIANGLE.item.linkTo:TRIANGLE.item.objRef.children[0].getAttribute("href"))?(document.getElementById("hrefHyperlink").disabled=!1,document.getElementById("hrefHyperlink").value=e):document.getElementById("hrefHyperlink").disabled=!0;else document.getElementById("hrefHyperlink").disabled=!0}}(),function(){if(null===TRIANGLE.text.importedHyperlink){var e=TRIANGLE.item.objRef.firstChild?TRIANGLE.item.objRef.firstChild.tagName:null,t=document.getElementById("hrefTarget");if(1===TRIANGLE.item.objRef.children.length&&"A"===e){var o=TRIANGLE.item.objRef.children[0].getAttribute("target");t.disabled=!1;var n=0;for(i=0;i<t.length;i++)o===t.options[i].text&&(n=i);t.selectedIndex=n}else if(TRIANGLE.item.linkTo){var o=TRIANGLE.item.objRef.getAttribute("target");t.disabled=!1;var n=0;for(i=0;i<t.length;i++)o===t.options[i].text&&(n=i);t.selectedIndex=n}else t.selectedIndex=0,t.disabled=!0}}(),function(){if(TRIANGLE.isType.snippetItem(TRIANGLE.item.objRef)){var e=TRIANGLE.item.objRef.innerHTML;document.getElementById("snippetInsertion").value=e,"snippetInsertion"===TRIANGLE.developer.currentCode&&(document.getElementById("codeEditor").value=e)}else document.getElementById("snippetInsertion").value="","snippetInsertion"===TRIANGLE.developer.currentCode&&(document.getElementById("codeEditor").value="")}(),"form"===TRIANGLE.item.tag.toLowerCase()&&TRIANGLE.item.objRef.getAttribute("form-email")?document.getElementById("formEmail").value=TRIANGLE.item.objRef.getAttribute("form-email"):document.getElementById("formEmail").value="",y=TRIANGLE.item.objRef.style.cssText.replace(/;\s*/g,";\n"),document.getElementById("cssStyles").value=y,"cssStyles"===TRIANGLE.developer.currentCode&&(document.getElementById("codeEditor").value=y),function(){if(TRIANGLE.item.objRef.getAttribute("hover-style")){var e=TRIANGLE.item.objRef.getAttribute("hover-style").replace(/;\s*/g,";\n");document.getElementById("hoverStyles").value=e,"hoverStyles"===TRIANGLE.developer.currentCode&&(document.getElementById("codeEditor").value=e)}}(),document.getElementById("opDuplicateElement").addEventListener("click",TRIANGLE.options.duplicate),document.getElementById("opInsertNewChild").addEventListener("click",TRIANGLE.insertNewChild),f("insert2columns","TRIANGLE.options.insertColumns","2"),f("insert3columns","TRIANGLE.options.insertColumns","3"),f("opDeleteElement","TRIANGLE.deleteItem",TRIANGLE.item.index),f("opShiftUp","TRIANGLE.options.shiftUp",TRIANGLE.item.index),f("opShiftDown","TRIANGLE.options.shiftDown",TRIANGLE.item.index),f("opCopyStyles","TRIANGLE.options.copyStyles",TRIANGLE.item.index),f("opPasteStyles","TRIANGLE.options.pasteStyles",TRIANGLE.item.index),function(){var e=document.getElementById("menu").getElementsByTagName("input");for(i=0;i<e.length;i++)e[i].removeEventListener("keyup",TRIANGLE.saveItem.applyChanges),e[i].addEventListener("keyup",TRIANGLE.saveItem.applyChanges)}(),document.getElementById("opDeleteElement").style.display="block",document.getElementById("opShiftUp").style.display="block",document.getElementById("opShiftDown").style.display="block",document.getElementById("opCopyStyles").style.display="block",document.getElementById("opDeselect").style.display="block",document.getElementById("insert2columns").style.display="inline-block",document.getElementById("insert3columns").style.display="inline-block",document.getElementById("opDuplicateElement").style.display="inline-block",document.getElementById("opInsertNewChild").style.display="inline-block",document.getElementById("opSelectParent").style.display="inline-block",document.getElementById("opHyperlink").style.display="inline-block",TRIANGLE.updateTemplateItems()},importColors:function(){var e=TRIANGLE.item,t=document.getElementById("colorListBorderL"),o=document.getElementById("colorListBorderR"),n=document.getElementById("colorListBorderT"),r=document.getElementById("colorListBorderB");function l(e){return!("initial"!=e&&!/-/g.test(e)&&"currentColor"!=e)}if(""!==e.bgColor&&("inherit"==e.bgColor?document.getElementById("colorElementBg").style.backgroundColor=e.parent.style.backgroundColor:document.getElementById("colorElementBg").style.backgroundColor=e.bgColor),""===e.borderLeftColor&&""===e.borderRightColor&&""===e.borderTopColor&&""===e.borderBottomColor||(""!==e.borderLeftColor&&""!==e.borderLeftWidth&&""!==e.borderLeftColor&&(l(e.borderLeftColor)&&(e.objRef.style.borderLeftColor="black",e.borderLeftColor="black"),t.style.backgroundColor=e.borderLeftColor),""!==e.borderRightColor&&""!==e.borderRightWidth&&""!==e.borderRightColor&&(l(e.borderRightColor)&&(e.objRef.style.borderRightColor="black",e.borderRightColor="black"),o.style.backgroundColor=e.borderRightColor),""!==e.borderTopColor&&""!==e.borderTopWidth&&""!==e.borderTopColor&&(l(e.borderTopColor)&&(e.objRef.style.borderTopColor="black",e.borderTopColor="black"),n.style.backgroundColor=e.borderTopColor),""!==e.borderBottomColor&&""!==e.borderBottomWidth&&""!==e.borderBottomColor&&(l(e.borderBottomColor)&&(e.objRef.style.borderBottomColor="black",e.borderBottomColor="black"),r.style.backgroundColor=e.borderBottomColor)),""!==e.boxShadow){var s=document.getElementById("colorBoxShadow"),a=e.boxShadow.split(" ");for(i=0;i<a.length;i++)if(/rgb/.test(a[i]))s.style.backgroundColor=TRIANGLE.colors.rgbToHex(a[i]+" "+a[i+1]+" "+a[i+2]);else if(/#/.test(a[i]))s.style.backgroundColor=a[i];else{if(/\d+/g.test(a[i]))continue;s.style.backgroundColor=a[i]}}TRIANGLE.isType.textBox(e.objRef)&&""!==e.fontColor&&("inherit"==e.fontColor?document.getElementById("colorFont").style.backgroundColor=e.parent.style.color:document.getElementById("colorFont").style.backgroundColor=e.fontColor)}},TRIANGLE.saveItem={applyChanges:function applyChanges(specificFunc){function saveBgColor(){var e=document.getElementById("bgColor");if(/#*(\d[a-f]*|[a-f]\d*){3,6}/g.test(e.value)&&!/rgb/.test(e.value)){var t=e.value.replace(/#/g,"");TRIANGLE.saveItem.createAnimation("background-color",TRIANGLE.item.bgColor,"#"+t,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.backgroundColor="#"+t,document.getElementById("colorElementBg").style.backgroundColor="#"+t}else TRIANGLE.saveItem.createAnimation("background-color",TRIANGLE.item.bgColor,e.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.backgroundColor=e.value,document.getElementById("colorElementBg").style.backgroundColor=e.value}function saveHeight(){var e=document.getElementById("height");0==parseInt(e.value)?TRIANGLE.item.objRef.style.minHeight="3px":TRIANGLE.getUnit(e.value)?(TRIANGLE.saveItem.createAnimation("min-height",TRIANGLE.item.minHeight,e.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.minHeight=e.value):(TRIANGLE.saveItem.createAnimation("min-height",TRIANGLE.item.minHeight,e.value+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.minHeight=e.value+"px"),TRIANGLE.item.transform||"table"===TRIANGLE.item.display?TRIANGLE.item.objRef.style.height=TRIANGLE.item.objRef.style.minHeight:TRIANGLE.item.objRef.style.height="auto"}function saveWidth(){var e=document.getElementById("width");0==parseInt(e.value)?TRIANGLE.item.objRef.style.width="3px":TRIANGLE.getUnit(e.value)?(TRIANGLE.saveItem.createAnimation("width",TRIANGLE.item.width,e.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.width=e.value):(TRIANGLE.saveItem.createAnimation("width",TRIANGLE.item.width,e.value+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.width=e.value+"px")}function saveImgHeight(){var e=document.getElementById("height");"auto"==e.value&&(TRIANGLE.item.objRef.style.height="auto"),0===parseInt(e.value)?TRIANGLE.item.objRef.style.minHeight="3px":TRIANGLE.getUnit(e.value)?"%"!=TRIANGLE.getUnit(e.value)&&(TRIANGLE.saveItem.createAnimation("min-height",TRIANGLE.item.minHeight,e.value),TRIANGLE.item.objRef.style.minHeight=e.value,parseFloat(e.value)<parseFloat(TRIANGLE.item.objRef.style.height)&&(TRIANGLE.item.objRef.style.height=e.value)):(TRIANGLE.saveItem.createAnimation("min-height",TRIANGLE.item.minHeight,e.value+"px"),TRIANGLE.item.objRef.style.minHeight=e.value+"px",parseFloat(e.value)<TRIANGLE.item.objRef.getBoundingClientRect().height&&(TRIANGLE.item.objRef.style.height=e.value+"px"));var t=TRIANGLE.item.cropRatio;t&&setTimeout(function(){TRIANGLE.selectionBorder.remove();var e=TRIANGLE.item.objRef.getBoundingClientRect().height,o=TRIANGLE.item.objRef.getBoundingClientRect().width,i=Math.round(e*t);document.getElementById("width").value=i+"px",TRIANGLE.saveItem.createAnimation("width",o+"px",i+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.width=i+"px"},325)}function saveImgWidth(){var e=document.getElementById("width");0===parseInt(e.value)?TRIANGLE.item.objRef.style.width="3px":TRIANGLE.getUnit(e.value)?(TRIANGLE.saveItem.createAnimation("width",TRIANGLE.item.width,e.value),TRIANGLE.item.objRef.style.width=e.value):(TRIANGLE.saveItem.createAnimation("width",TRIANGLE.item.width,e.value+"px"),TRIANGLE.item.objRef.style.width=e.value+"px");var t=TRIANGLE.item.cropRatio;t&&setTimeout(function(){TRIANGLE.selectionBorder.remove();var e=TRIANGLE.item.objRef.getBoundingClientRect().width,o=TRIANGLE.item.objRef.getBoundingClientRect().height,i=Math.round(e/t);document.getElementById("height").value=i+"px",i<o?(TRIANGLE.item.objRef.style.height="1px",TRIANGLE.saveItem.createAnimation("min-height",o+"px",i+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.height=TRIANGLE.item.objRef.style.minHeight=i+"px"):(TRIANGLE.saveItem.createAnimation("height",o+"px",i+"px",function(){TRIANGLE.item.objRef.style.minHeight=i+"px",TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.height=i+"px")},325)}function saveDisplay(){var e=TRIANGLE.item,t=document.getElementById("display");e.objRef.style.display=t.value,"none"==t.value&&(t.value="block")}function savePadding(){var e=TRIANGLE.item,t=document.getElementById("paddingL"),o=document.getElementById("paddingR"),i=document.getElementById("paddingT"),n=document.getElementById("paddingB");0==parseInt(t.value)?(TRIANGLE.saveItem.createAnimation("padding-left",TRIANGLE.item.paddingLeft,0,function(){TRIANGLE.selectionBorder.create()}),e.objRef.style.paddingLeft=""):TRIANGLE.getUnit(t.value)||""===t.value?(TRIANGLE.saveItem.createAnimation("padding-left",TRIANGLE.item.paddingLeft,t.value,function(){TRIANGLE.selectionBorder.create()}),e.objRef.style.paddingLeft=t.value):(TRIANGLE.saveItem.createAnimation("padding-left",TRIANGLE.item.paddingLeft,t.value+"px",function(){TRIANGLE.selectionBorder.create()}),e.objRef.style.paddingLeft=t.value+"px"),0==parseInt(o.value)?(TRIANGLE.saveItem.createAnimation("padding-right",TRIANGLE.item.paddingRight,0),e.objRef.style.paddingRight=""):TRIANGLE.getUnit(o.value)||""===o.value?(TRIANGLE.saveItem.createAnimation("padding-right",TRIANGLE.item.paddingRight,o.value,function(){TRIANGLE.selectionBorder.create()}),e.objRef.style.paddingRight=o.value):(TRIANGLE.saveItem.createAnimation("padding-right",TRIANGLE.item.paddingRight,o.value,function(){TRIANGLE.selectionBorder.create()}),e.objRef.style.paddingRight=o.value+"px"),0==parseInt(i.value)?(TRIANGLE.saveItem.createAnimation("padding-top",TRIANGLE.item.paddingTop,0,function(){TRIANGLE.selectionBorder.create()}),e.objRef.style.paddingTop=""):TRIANGLE.getUnit(i.value)||""===i.value?(TRIANGLE.saveItem.createAnimation("padding-top",TRIANGLE.item.paddingTop,i.value,function(){TRIANGLE.selectionBorder.create()}),e.objRef.style.paddingTop=i.value):(TRIANGLE.saveItem.createAnimation("padding-top",TRIANGLE.item.paddingTop,i.value+"px",function(){TRIANGLE.selectionBorder.create()}),e.objRef.style.paddingTop=i.value+"px"),0==parseInt(n.value)?(TRIANGLE.saveItem.createAnimation("padding-bottom",TRIANGLE.item.paddingBottom,0,function(){TRIANGLE.selectionBorder.create()}),e.objRef.style.paddingBottom=""):TRIANGLE.getUnit(n.value)||""===n.value?(TRIANGLE.saveItem.createAnimation("padding-bottom",TRIANGLE.item.paddingBottom,n.value,function(){TRIANGLE.selectionBorder.create()}),e.objRef.style.paddingBottom=n.value):(TRIANGLE.saveItem.createAnimation("padding-bottom",TRIANGLE.item.paddingBottom,n.value+"px",function(){TRIANGLE.selectionBorder.create()}),e.objRef.style.paddingBottom=n.value+"px")}function saveMargin(){var e=document.getElementById("marginL"),t=document.getElementById("marginR"),o=document.getElementById("marginT"),i=document.getElementById("marginB");0===parseInt(e.value)||""==e.value?(TRIANGLE.saveItem.createAnimation("margin-left",TRIANGLE.item.marginLeft,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginLeft=""):TRIANGLE.getUnit(e.value)?(TRIANGLE.saveItem.createAnimation("margin-left",TRIANGLE.item.marginLeft,e.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginLeft=e.value):(TRIANGLE.saveItem.createAnimation("margin-left",TRIANGLE.item.marginLeft,e.value+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginLeft=e.value+"px"),0===parseInt(t.value)||""==t.value?(TRIANGLE.saveItem.createAnimation("margin-right",TRIANGLE.item.marginRight,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginRight=""):TRIANGLE.getUnit(t.value)?(TRIANGLE.saveItem.createAnimation("margin-right",TRIANGLE.item.marginRight,t.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginRight=t.value):(TRIANGLE.saveItem.createAnimation("margin-right",TRIANGLE.item.marginRight,t.value+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginRight=t.value+"px"),0===parseInt(o.value)||""==o.value?(TRIANGLE.saveItem.createAnimation("margin-top",TRIANGLE.item.marginTop,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginTop=""):TRIANGLE.getUnit(o.value)?(TRIANGLE.saveItem.createAnimation("margin-top",TRIANGLE.item.marginTop,o.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginTop=o.value):(TRIANGLE.saveItem.createAnimation("margin-top",TRIANGLE.item.marginTop,o.value+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginTop=o.value+"px"),0===parseInt(i.value)||""==i.value?(TRIANGLE.saveItem.createAnimation("margin-bottom",TRIANGLE.item.marginBottom,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginBottom=""):TRIANGLE.getUnit(i.value)?(TRIANGLE.saveItem.createAnimation("margin-bottom",TRIANGLE.item.marginBottom,i.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginBottom=i.value):(TRIANGLE.saveItem.createAnimation("margin-bottom",TRIANGLE.item.marginBottom,i.value+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginBottom=i.value+"px")}function saveBorder(){var e=document.getElementById("borderLwidth"),t=document.getElementById("borderLtype"),o=t.options[t.selectedIndex].text,i=document.getElementById("borderLcolor"),n=document.getElementById("borderRwidth"),r=document.getElementById("borderRtype"),l=r.options[r.selectedIndex].text,s=document.getElementById("borderRcolor"),a=document.getElementById("borderTwidth"),d=document.getElementById("borderTtype"),m=d.options[d.selectedIndex].text,c=document.getElementById("borderTcolor"),I=document.getElementById("borderBwidth"),E=document.getElementById("borderBtype"),p=E.options[E.selectedIndex].text,R=document.getElementById("borderBcolor"),u=document.getElementById("colorListBorderL"),T=document.getElementById("colorListBorderR"),g=document.getElementById("colorListBorderT"),L=document.getElementById("colorListBorderB");if(0==parseInt(e.value)||""==e.value)TRIANGLE.saveItem.createAnimation("border-left",TRIANGLE.item.borderLeft,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderLeft="";else{var A=parseInt(e.value)+"px "+o+" "+i.value;TRIANGLE.saveItem.createAnimation("border-left",TRIANGLE.item.borderLeft,A,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderLeft=A,u.style.backgroundColor=i.value}if(0==parseInt(n.value)||""==n.value)TRIANGLE.saveItem.createAnimation("border-right",TRIANGLE.item.borderRight,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderRight="";else{var N=parseInt(n.value)+"px "+l+" "+s.value;TRIANGLE.saveItem.createAnimation("border-right",TRIANGLE.item.borderRight,N,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderRight=N,T.style.backgroundColor=s.value}if(0==parseInt(a.value)||""==a.value)TRIANGLE.saveItem.createAnimation("border-top",TRIANGLE.item.borderTop,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderTop="";else{var y=parseInt(a.value)+"px "+m+" "+c.value;TRIANGLE.saveItem.createAnimation("border-top",TRIANGLE.item.borderTop,y,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderTop=y,g.style.backgroundColor=c.value}if(0==parseInt(I.value)||""==I.value)TRIANGLE.saveItem.createAnimation("border-bottom",TRIANGLE.item.borderBottom,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderBottom="";else{var G=parseInt(I.value)+"px "+p+" "+R.value;TRIANGLE.saveItem.createAnimation("border-bottom",TRIANGLE.item.borderBottom,G,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderBottom=G,L.style.backgroundColor=R.value}}function saveBoxShadow(){var e=TRIANGLE.item,t=document.getElementById("boxShadowH"),o=document.getElementById("boxShadowV"),i=document.getElementById("boxShadowBlur"),n=document.getElementById("boxShadowColor");if(0==parseInt(t.value)&&0==parseInt(o.value)&&0==parseInt(i.value)||""==t.value&&""==o.value&&""==i.value)TRIANGLE.saveItem.createAnimation("box-shadow",TRIANGLE.item.boxShadow,"",function(){TRIANGLE.selectionBorder.create()}),e.objRef.style.boxShadow="";else{var r=parseInt(t.value)+"px "+parseInt(o.value)+"px "+parseInt(i.value)+"px "+n.value;TRIANGLE.saveItem.createAnimation("box-shadow",TRIANGLE.item.boxShadow,r,function(){TRIANGLE.selectionBorder.create()}),e.objRef.style.boxShadow=r}}function saveFont(){if(TRIANGLE.isType.textBox(TRIANGLE.item.objRef)){var e=document.getElementById("fontColor"),t=document.getElementById("fontSize"),o=document.getElementById("fontLineHeight"),i=document.getElementById("fontWeight");TRIANGLE.saveItem.createAnimation("color",TRIANGLE.item.fontColor,e.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.color=e.value,/\D/g.test(t.value)?(TRIANGLE.saveItem.createAnimation("font-size",TRIANGLE.item.fontSize,t.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.fontSize=t.value):(TRIANGLE.saveItem.createAnimation("font-size",TRIANGLE.item.fontSize,t.value+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.fontSize=t.value+"px"),TRIANGLE.item.objRef.style.lineHeight=o.value,TRIANGLE.item.objRef.style.fontWeight=i.value}}function saveUserID(){var e=document.getElementById("userID").value.replace(/ /g,"-");""!==e?(e=TRIANGLE.library.removeDuplicateUserIDs(e),TRIANGLE.item.objRef.setAttribute("user-id",e),setTimeout(TRIANGLE.selectionBorder.create,TRIANGLE.saveItem.animationTime)):TRIANGLE.item.objRef.removeAttribute("user-id")}function saveUserClass(){var e=document.getElementById("userClass").value.replace(/ /g,"-");if(""!==e&&document.getElementById("userClass")===document.activeElement){TRIANGLE.item.objRef.setAttribute("user-class",e),setTimeout(TRIANGLE.selectionBorder.create,TRIANGLE.saveItem.animationTime);var t=document.getElementById("template").querySelectorAll("[user-class="+e+"]");t.length>1?t[0]!=TRIANGLE.item.objRef?TRIANGLE.item.objRef.style.cssText=t[0].style.cssText:TRIANGLE.item.objRef.style.cssText=t[1].style.cssText:TRIANGLE.userClasses&&TRIANGLE.userClasses[e]&&(TRIANGLE.item.objRef.style.cssText=TRIANGLE.userClasses[e])}else""!==e&&document.getElementById("userClass")!=document.activeElement?TRIANGLE.saveItem.equalizeUserClasses(e):TRIANGLE.item.objRef.removeAttribute("user-class")}function saveHyperlink(){var e=document.getElementById("hrefHyperlink").value;""!==e&&(null!=TRIANGLE.text.importedHyperlink?TRIANGLE.text.importedHyperlink.setAttribute("href",e):TRIANGLE.isType.textBox(TRIANGLE.item.objRef)?TRIANGLE.item.objRef.children[0].setAttribute("href",e):TRIANGLE.item.objRef.setAttribute("link-to",e),setTimeout(TRIANGLE.selectionBorder.create,TRIANGLE.saveItem.animationTime))}function saveFormEmail(){if("form"===TRIANGLE.item.tag.toLowerCase()){var e=document.getElementById("formEmail");TRIANGLE.item.objRef.setAttribute("form-email",e.value),setTimeout(TRIANGLE.selectionBorder.create,TRIANGLE.saveItem.animationTime)}}TRIANGLE.selectionBorder.remove(),TRIANGLE.hoverBorder.hide(),"string"!=typeof specificFunc?(saveBgColor(),this&&"height"===this.id?TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)?saveImgHeight():saveHeight():this&&"width"===this.id?TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)?saveImgWidth():saveWidth():(TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)?saveImgHeight():saveHeight(),TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)?saveImgWidth():saveWidth()),saveDisplay(),savePadding(),saveMargin(),saveBorder(),saveBoxShadow(),saveFont(),saveUserID(),saveUserClass(),saveHyperlink(),saveFormEmail()):eval(specificFunc),TRIANGLE.selectItem(TRIANGLE.item.index),TRIANGLE.importItem.importColors(),TRIANGLE.updateTemplateItems()},applyAll:function(e,t){var o=document.getElementById(e[0]).value;for(i=1;i<e.length;i++)document.getElementById(e[i]).value=o;t||TRIANGLE.saveItem.applyChanges()},codeSnippet:function(e){TRIANGLE.item&&TRIANGLE.isType.snippetItem(TRIANGLE.item.objRef)&&TRIANGLE.developer.insertSnippet()},cssStyles:function(e){if(TRIANGLE.item){var t=e.value.match(/[^:]+:\s*[^;]+;\s*/g);if(null!=t){var o="";for(i=0;i<t.length;i++)o+=t[i];TRIANGLE.item.objRef.style.cssText=o}TRIANGLE.selectionBorder.update()}},hoverStyles:function(e){if(TRIANGLE.item){var t=e.value.match(/[^:]+:\s*[^;]+;\s*/g);if(console.log(t),null!=t){var o="";for(i=0;i<t.length;i++)o+=t[i];TRIANGLE.item.objRef.setAttribute("hover-style",o)}else TRIANGLE.item.objRef.removeAttribute("hover-style")}},equalizeUserClasses:function(e){var t=document.getElementById("template").querySelectorAll("[user-class="+e+"]");for(i=0;i<t.length;i++)TRIANGLE.importItem.currentUserClass&&t[i]!=TRIANGLE.importItem.currentUserClass&&(t[i].style.cssText=TRIANGLE.importItem.currentUserClass.style.cssText)},animationActive:!1,animationTime:320,createAnimation:function(e,t,o,i){if(TRIANGLE.enable.animations){var n="@keyframes updateAnimation {from{"+e+":"+t+"}to{"+e+":"+o+"}}#"+TRIANGLE.item.id+"{"+e+":"+o+";animation-name:updateAnimation;animation-duration:300ms}";t!==o&&(document.getElementById("updateAnimation").innerHTML=n,TRIANGLE.saveItem.animationActive=!0,setTimeout(function(){document.getElementById("updateAnimation").innerHTML="",TRIANGLE.saveItem.animationActive=!1,i&&"function"==typeof i&&i()},TRIANGLE.saveItem.animationTime))}else t!==o&&i&&"function"==typeof i&&i()},exportLibraryItemCode:function(){TRIANGLE.item&&alert(TRIANGLE.item.objRef.outerHTML)}},TRIANGLE.metaData={title:"",keywords:"",description:"",commaSplit:function(e){var t=e.value;" "===t.slice(-1)&&", "!=t.slice(-2)&&(t=t.slice(0,-1)+", ",e.value=t)},fixCommas:function(e){var t=e.value;" "===(t=(t=(t=(t=(t=t.replace(/(\w+)(,+|\s+)(\w+)/g,"$1, $3")).replace(/(\w+)(,+|\s+)(\w+)/g,"$1, $3")).replace(/\s+/g," ")).replace(/,+/g,",")).replace(/\s+,+/g,"")).slice(-1)&&(t=t.slice(0,-1)),","===t.slice(-1)&&(t=t.slice(0,-1)),e.value=t}},TRIANGLE.clearSelection=function(){var e,t;for(TRIANGLE.selectionBorder.remove(),i=0;i<TRIANGLE.templateItems.length;i++)e=document.getElementById("item"+i),TRIANGLE.isType.textBox(e)&&e.isContentEditable&&e!==document.activeElement&&(e.blur(),TRIANGLE.text.checkTextEditing());t=document.createElement("input"),document.getElementById("dummyDiv").appendChild(t),t.focus(),document.getElementById("dummyDiv").removeChild(t);var o=document.getElementById("menu"),n=o.querySelectorAll("input[type=text]");for(i=0;i<n.length;i++)"true"!=n[i].getAttribute("no-clear")&&(n[i].removeEventListener("keyup",TRIANGLE.saveItem.applyChanges),n[i].value="");var r=o.querySelectorAll("input[type=checkbox]");for(i=0;i<r.length;i++)"true"!=r[i].getAttribute("no-clear")&&(r[i].checked=!1);var l=o.getElementsByTagName("textarea");for(i=0;i<l.length;i++)"true"!=l[i].getAttribute("no-clear")&&(l[i].value="");var s=o.querySelectorAll("input[type=radio]");for(i=0;i<s.length;i++)s[i].checked=!1;var a=o.getElementsByClassName("hideOnClear");for(i=0;i<a.length;i++)a[i].style.display="none";function d(e,t){document.getElementById(t).removeAttribute(e)}document.getElementById("fontType").selectedIndex=0,TRIANGLE.colors.cancelCanvasMenu(),d("onClick","insert2columns"),d("onClick","insert3columns"),document.getElementById("opDuplicateElement").removeEventListener("click",TRIANGLE.options.duplicate),document.getElementById("opInsertNewChild").removeEventListener("click",TRIANGLE.insertNewChild),d("onClick","opDeleteElement"),d("onClick","opShiftUp"),d("onClick","opShiftDown"),d("onClick","opCopyStyles"),document.getElementById("insert2columns").style.display="none",document.getElementById("insert3columns").style.display="none",document.getElementById("opDuplicateElement").style.display="none",document.getElementById("opInsertNewChild").style.display="none",document.getElementById("opSelectParent").style.display="none",document.getElementById("opHyperlink").style.display="none",document.body.removeEventListener("keyup",TRIANGLE.keyEvents.whichKey.item),document.getElementById("updateAnimation").innerHTML="",document.getElementById("dimensionLabels").style.display="none",document.getElementById("hrefTarget").value=0,document.getElementById("hrefTarget").disabled=!0,TRIANGLE.text.importedHyperlink=null,TRIANGLE.updateTemplateItems(),TRIANGLE.item=!1},TRIANGLE.deleteItem=function(e){if(!TRIANGLE.isType.preventDelete(TRIANGLE.item.objRef))if(0===arguments.length||1===arguments.length&&isNaN(arguments[0]))TRIANGLE.item.objRef.removeEventListener("mousedown",TRIANGLE.importItem.single,!0),TRIANGLE.item.objRef.removeEventListener("mouseover",TRIANGLE.hoverBorder.show,!0),TRIANGLE.isType.textBox(TRIANGLE.sv_item.objRef)&&(TRIANGLE.sv_item.objRef.removeEventListener("dblclick",TRIANGLE.text.editText),TRIANGLE.sv_item.objRef.removeEventListener("paste",TRIANGLE.text.clearPastedStyles)),TRIANGLE.item.hoverVersion&&document.getElementById("hoverItems").removeChild(TRIANGLE.item.hoverObj),TRIANGLE.item.parent.removeChild(TRIANGLE.item.objRef),TRIANGLE.text.deleteUnusedFonts(),TRIANGLE.updateTemplateItems(),TRIANGLE.clearSelection();else{if(TRIANGLE.templateItems.length>0){var t=document.getElementById("item"+e),o=document.getElementById("item"+e+":hover");t.removeEventListener("mousedown",TRIANGLE.importItem.single,!0),t.removeEventListener("mouseover",TRIANGLE.hoverBorder.show,!0),TRIANGLE.isType.textBox(t)&&(t.removeEventListener("dblclick",TRIANGLE.text.editText),t.removeEventListener("paste",TRIANGLE.text.clearPastedStyles)),o&&document.getElementById("hoverItems").removeChild(o),t.remove()}TRIANGLE.text.deleteUnusedFonts(),TRIANGLE.updateTemplateItems(),TRIANGLE.clearSelection()}},TRIANGLE.keyEvents={shiftKey:!1,whichKey:{document:function(e){TRIANGLE.keyEvents.countActiveInputs()>0||(e.ctrlKey&&86===e.keyCode&&TRIANGLE.keyEvents.keyCtrlV(),e.ctrlKey&&83===e.keyCode&&TRIANGLE.keyEvents.keyCtrlS(),e.ctrlKey&&90===e.keyCode&&TRIANGLE.keyEvents.keyCtrlZ(),e.shiftKey&&84===e.keyCode&&TRIANGLE.keyEvents.keyShiftT(),e.shiftKey&&80===e.keyCode&&TRIANGLE.keyEvents.keyShiftP(),76===e.keyCode&&TRIANGLE.keyEvents.keyL(),77===e.keyCode&&TRIANGLE.keyEvents.keyM(),!e.ctrlKey||38!==e.keyCode&&38!==e.charCode&&37!==e.keyCode&&37!==e.charCode||TRIANGLE.template.decreaseOpacity(),!e.ctrlKey||40!==e.keyCode&&40!==e.charCode&&39!==e.keyCode&&39!==e.charCode||TRIANGLE.template.increaseOpacity())},item:function(e){27!==e.keyCode&&27!==e.charCode||TRIANGLE.keyEvents.keyEsc(),TRIANGLE.keyEvents.countActiveInputs()>0||(13===e.keyCode&&TRIANGLE.keyEvents.keyEnter(),46!==e.keyCode&&46!==e.charCode||TRIANGLE.keyEvents.keyDelete(),e.ctrlKey||38!==e.keyCode&&38!==e.charCode&&37!==e.keyCode&&37!==e.charCode||TRIANGLE.keyEvents.keyUpArrow(),e.ctrlKey||40!==e.keyCode&&40!==e.charCode&&39!==e.keyCode&&39!==e.charCode||TRIANGLE.keyEvents.keyDownArrow(),73!==e.keyCode&&73!==e.charCode||TRIANGLE.keyEvents.keyI(),e.ctrlKey&&67===e.keyCode&&TRIANGLE.keyEvents.keyCtrlC(),e.ctrlKey&&88===e.keyCode&&TRIANGLE.keyEvents.keyCtrlX(),68===e.keyCode&&TRIANGLE.keyEvents.keyD())}},paste:function(e){e.ctrlKey&&86===e.keyCode&&TRIANGLE.keyEvents.keyCtrlV()},keyDelete:function(e){TRIANGLE.item&&(TRIANGLE.deleteItem(TRIANGLE.item.index),document.body.removeAttribute("onKeyUp"))},keyUpArrow:function(e){TRIANGLE.options.shiftUp(TRIANGLE.item.index),TRIANGLE.updateTemplateItems()},keyDownArrow:function(e){TRIANGLE.options.shiftDown(TRIANGLE.item.index),TRIANGLE.updateTemplateItems()},keyEsc:function(e){TRIANGLE.item.objRef.isContentEditable&&(TRIANGLE.item.objRef.blur(),TRIANGLE.text.checkTextEditing()),document.getElementById("cropImgBorder")&&TRIANGLE.images.crop.cancel(),TRIANGLE.colors.colorDropIndex>-1&&TRIANGLE.colors.cancelColorDropper(),TRIANGLE.clearSelection(),/sideMenuOpen/g.test(document.getElementById("sideMenu").className)&&TRIANGLE.menu.closeSideMenu()},keyEnter:function(e){TRIANGLE.images.crop.active&&TRIANGLE.images.crop.applyCrop()},keyI:function(e){TRIANGLE.colors.colorDropper()},keyCtrlC:function(){TRIANGLE.item&&TRIANGLE.options.copyStyles(TRIANGLE.item.index)},keyCtrlV:function(){TRIANGLE.options.pasteStyles()},keyCtrlS:function(){"none"!=document.getElementById("saveCurrentTemplate").parentNode.style.display&&"default"!=TRIANGLE.currentTemplate?TRIANGLE.saveTemplate.saveCurrent():TRIANGLE.saveTemplate.getSaveName()},keyCtrlZ:function(){TRIANGLE.item&&TRIANGLE.item.objRef.isContentEditable||TRIANGLE.options.undo()},keyCtrlX:function(){TRIANGLE.item&&!TRIANGLE.isType.preventDelete(TRIANGLE.item.objRef)&&(TRIANGLE.options.copyStyles(TRIANGLE.item.index),TRIANGLE.item.remove(),TRIANGLE.updateTemplateItems())},keyShiftT:function(){TRIANGLE.text.insertTextBox()},keyShiftP:function(){TRIANGLE.exportCode.format("preview")},keyL:function(){TRIANGLE.library.load(),TRIANGLE.menu.openSideMenu("libraryMenu")},keyM:function(){TRIANGLE.images.load(),TRIANGLE.menu.openSideMenu("imageLibraryMenu")},keyD:function(){TRIANGLE.options.duplicate()},countActiveInputs:function(){var e=document.getElementsByTagName("input"),t=document.getElementsByTagName("textarea"),o=document.getElementsByClassName("textBox"),n=0;for(i=0;i<e.length;i++)e[i]===document.activeElement?n++:n+=0;for(i=0;i<t.length;i++)t[i]===document.activeElement?n++:n+=0;for(i=0;i<o.length;i++)o[i].isContentEditable?n++:n+=0;return n}},TRIANGLE.options={insertColumns:function(e){if(TRIANGLE.selectItem(TRIANGLE.item.index),!(TRIANGLE.item.objRef.children.length>0||TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef))){var t=TRIANGLE.item,o=Math.floor(100*parseFloat(t.width)/e)/100,n=1;for(i=0;i<e;i++){var r=document.createElement("div");if(r.style.backgroundColor=TRIANGLE.randomColor(),r.style.minHeight=t.minHeight,r.style.height="auto",r.style.width=o+TRIANGLE.getUnit(t.width),r.style.position="relative",r.setAttribute("item-align",t.align),"right"!==t.align){r.style.cssFloat="left";var l="Right",s="Left"}else{r.style.cssFloat="right";l="Left",s="Right"}r.style.paddingLeft=t.paddingLeft,r.style.paddingRight=t.paddingRight,r.style.paddingTop=t.paddingTop,r.style.paddingBottom=t.paddingBottom,1===n?(r.style["margin"+l]=t["margin"+l],r.style["border"+l+"Width"]=t["border"+l+"Width"],r.style["border"+l+"Style"]=t["border"+l+"Style"],r.style["border"+l+"Color"]=t["border"+l+"Color"]):n===e&&(r.style["margin"+s]=t["margin"+s],r.style["border"+s+"Width"]=t["border"+s+"Width"],r.style["border"+s+"Style"]=t["border"+s+"Style"],r.style["border"+s+"Color"]=t["border"+s+"Color"]),r.style.marginTop=t.marginTop,r.style.marginBottom=t.marginBottom,r.style.borderTopWidth=t.borderTopWidth,r.style.borderTopStyle=t.borderTopStyle,r.style.borderTopColor=t.borderTopColor,r.style.borderBottomWidth=t.borderBottomWidth,r.style.borderBottomStyle=t.borderBottomStyle,r.style.borderBottomColor=t.borderBottomColor,r.style.boxShadow=t.boxShadow,r.className=t.className,t.parent.insertBefore(r,TRIANGLE.templateItems[t.index]),n++}TRIANGLE.deleteItem(t.index),TRIANGLE.updateTemplateItems()}},shiftUp:function(e){if(!TRIANGLE.isType.preventDelete(TRIANGLE.item.objRef)){var t=TRIANGLE.item;if(TRIANGLE.resetClearFloat(),TRIANGLE.selectItem(e),t.isFirstChild)TRIANGLE.updateTemplateItems();else{t.objRef;var o=t.prevSibling(),i=o.getAttribute("index"),n=TRIANGLE.createAnother(t.objRef);t.parent.insertBefore(n,o),TRIANGLE.deleteItem(t.index),TRIANGLE.updateTemplateItems(),TRIANGLE.importItem.single(i),TRIANGLE.selectionBorder.update();var r=TRIANGLE.item.objRef.getBoundingClientRect(),l=window.innerHeight,s=document.getElementById("menu").getBoundingClientRect().bottom;r.top<s?(TRIANGLE.item.objRef.scrollIntoView(),window.scrollBy(0,-250)):r.bottom>l&&(TRIANGLE.item.objRef.scrollIntoView(),window.scrollBy(0,200))}}},shiftDown:function(e){if(!TRIANGLE.isType.preventDelete(TRIANGLE.item.objRef)){var t,o=TRIANGLE.item;if(TRIANGLE.resetClearFloat(),TRIANGLE.selectItem(e),o.nextSibling()&&(t=new TRIANGLE.TemplateItem(o.nextSibling().getAttribute("index"))),o.isLastChild)TRIANGLE.updateTemplateItems();else{o.objRef,o.nextSibling();var i=o.index,n=TRIANGLE.createAnother(o.objRef);t&&t.nextSibling()?o.parent.insertBefore(n,t.nextSibling()):o.parent.appendChild(n),TRIANGLE.deleteItem(o.index),TRIANGLE.updateTemplateItems(),TRIANGLE.selectItem(i),TRIANGLE.importItem.single(TRIANGLE.item.nextSibling().getAttribute("index")),TRIANGLE.selectionBorder.update();var r=TRIANGLE.item.objRef.getBoundingClientRect(),l=window.innerHeight,s=document.getElementById("menu").getBoundingClientRect().bottom;r.top<s?(TRIANGLE.item.objRef.scrollIntoView(),window.scrollBy(0,-250)):r.bottom>l&&(TRIANGLE.item.objRef.scrollIntoView(),window.scrollBy(0,200))}}},duplicate:function(){var e=TRIANGLE.item,t=e.parent,o="";for(i=0;i<t.childNodes.length;i++)t.childNodes[i]==e.objRef&&(o=i);var n=TRIANGLE.createAnother(e.objRef);n.removeAttribute("user-id"),n.innerHTML=n.innerHTML.replace(/user\-class="[^"]*"/g,""),1===t.childNodes.length?t.appendChild(n):t.insertBefore(n,t.childNodes[o+1]),TRIANGLE.updateTemplateItems(),TRIANGLE.clearSelection(),TRIANGLE.selectItem(t.childNodes[o+1].getAttribute("index")),"100%"!==e.width&&(e.align&&"center"!==e.align||e.cssFloat)?TRIANGLE.saveItem.createAnimation("width",0,TRIANGLE.item.width,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)}):TRIANGLE.saveItem.createAnimation("min-height",0,TRIANGLE.item.minHeight,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)})},clipboard:{},isClipboardFull:!1,itemStyles:null,copyStyles:function(e){TRIANGLE.isType.preventDelete(TRIANGLE.item.objRef)||(TRIANGLE.clearSelection(),TRIANGLE.selectItem(e),TRIANGLE.options.clipboard.tag=TRIANGLE.item.tag,TRIANGLE.options.clipboard.src=TRIANGLE.item.objRef.src,TRIANGLE.options.clipboard.itemStyles=TRIANGLE.getStyles(TRIANGLE.item.objRef),TRIANGLE.options.isClipboardFull=!0)},pasteStyles:function(e){var t=document.createElement(TRIANGLE.options.clipboard.tag);for(i=0;i<TRIANGLE.options.clipboard.itemStyles.length;i++)TRIANGLE.styleFunctions[i](t,TRIANGLE.options.clipboard.itemStyles[i]);TRIANGLE.options.clipboard.src&&(t.src=TRIANGLE.options.clipboard.src),t.removeAttribute("user-id"),t.innerHTML=t.innerHTML.replace(/user\-class="[^"]*"/g,""),TRIANGLE.item?(e||(e=TRIANGLE.item.index),TRIANGLE.checkPadding(TRIANGLE.item.objRef),TRIANGLE.item.append(t),TRIANGLE.importItem.single(e),setTimeout(TRIANGLE.selectionBorder.update,50),TRIANGLE.updateTemplateItems(!0)):(document.getElementById("template").appendChild(t),TRIANGLE.importItem.single(TRIANGLE.templateItems.length-1),setTimeout(TRIANGLE.selectionBorder.update,50),TRIANGLE.updateTemplateItems(!0))},undoList:[],undoIndex:!1,maxUndo:20,compareUndoList:function(){var e=document.getElementById("templateWrapper").innerHTML.trim();e=(e=(e=(e=(e=e.replace(/\r|\n/g,"")).replace(/&nbsp;/g," ")).replace(/(\s)+/g,"$1")).replace(/((<div[^>]+id="selectionBorder"[^>]*>)|(<div[^>]+id="noClickThru"[^>]*>[^<]*<\/div>)|(<div[^>]+class="resizeHandle"[^>]*>[^<]*<\/div>))(<\/div>)?/gi,"")).replace(/<div[^>]+id="showHoverBorder"[^>]*>[^<]*<\/div>?/gi,"");var t=TRIANGLE.options.undoList[TRIANGLE.options.undoList.length-1];0===TRIANGLE.options.undoList.length?TRIANGLE.options.undoList[0]=e:e!=t&&(TRIANGLE.options.undoList[TRIANGLE.options.undoList.length]=e,TRIANGLE.options.undoIndex=TRIANGLE.options.undoList.length-1)},undo:function(){0!==TRIANGLE.options.undoList.length&&(TRIANGLE.options.undoIndex>0&&TRIANGLE.options.undoIndex--,TRIANGLE.options.undoList.splice(TRIANGLE.options.undoIndex+1,TRIANGLE.options.undoList.length-TRIANGLE.options.undoIndex-1),document.getElementById("templateWrapper").innerHTML=TRIANGLE.options.undoList[TRIANGLE.options.undoIndex],TRIANGLE.colors.updateBodyBg(),TRIANGLE.updateTemplateItems(),TRIANGLE.resize.removeHandles())},redo:function(e){var t=[0,1,2,3,4,5,6,7,8,9];console.log(t),console.log("arr.length: "+t.length+"   index: "+e),console.log("removing "+(t.length-e-1)+" items"),t.splice(e+1,t.length-e-1)}},TRIANGLE.publish={prompt:function(){TRIANGLE.popUp.open("FTPprofileCell")},begin:function(){document.getElementById("FTPselect").selectedIndex>0&&(TRIANGLE.exportCode.format("publish"),TRIANGLE.publish.cancel())},cancel:function(){TRIANGLE.popUp.close()}},TRIANGLE.loading={start:function(e){TRIANGLE.popUp.open("loadingCell"),"function"==typeof e&&setTimeout(e,10)},stop:function(){TRIANGLE.popUp.close()}},TRIANGLE.maxAllowedItems=100,TRIANGLE.exportCode={format:function(e){if(TRIANGLE.unsavedPremade)TRIANGLE.saveTemplate.getSaveName();else switch(e){case"publish":TRIANGLE.exportCode.postZip(0);var t=document.getElementById("FTPselect"),o=t.options[t.selectedIndex];(i={}).instance=TRIANGLE.instance,i.ftpURL=o.innerHTML,i.ftpID=o.getAttribute("ftp"),TRIANGLE.exportCode.postTemplate("publish",i);break;case"zip":TRIANGLE.exportCode.postZip(1);break;case"raw":var i;TRIANGLE.saveTemplate.saveCurrent(),(i={}).instance=TRIANGLE.instance,TRIANGLE.exportCode.postTemplate("exportRaw",i);break;case"preview":TRIANGLE.exportCode.previewTemplate()}},callbackAfterSave:!1,postZip:function(e){TRIANGLE.saveTemplate.saveCurrent();var t=document.getElementById("exportCompress").checked?1:0,o="askZip="+e+"&instance="+TRIANGLE.instance+"&compress="+t;setTimeout(function(){AJAX.post("scripts/exportZip.php",o,function(t){console.log(t.responseText),e&&window.open(t.responseText)})},100)},postTemplate:function(e,t){var o=document.getElementById("exportRawPost");o.innerHTML="",o.setAttribute("action","scripts/"+e+".php");var i=document.getElementById("exportCompress").checked?1:0;for(var n in t.compress=i,t)if(t.hasOwnProperty(n)){var r=document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name",n),r.setAttribute("value",t[n]),o.appendChild(r)}document.body.appendChild(o),o.submit(),TRIANGLE.loading.stop()},postTemplateAJAX:function(e,t){var o=document.getElementById("exportCompress").checked?1:0;t.compress=o;var i="";for(var n in t)t.hasOwnProperty(n)&&(i+=n+"="+t[n]+"&");i=i.slice(0,-1),AJAX.post("scripts/"+e+".php",i,function(e){TRIANGLE.loading.stop()})},previewTemplate:function(){TRIANGLE.unsavedPremade?(TRIANGLE.exportCode.callbackAfterSave=function(){setTimeout(TRIANGLE.exportCode.previewTemplate,100),setTimeout(function(){TRIANGLE.popUp.close(),location.href="index.php?pagename="+TRIANGLE.currentPage+"&loadTemplate="+TRIANGLE.currentTemplate},500)},TRIANGLE.saveTemplate.getSaveName()):(TRIANGLE.exportCode.callbackAfterSave=function(){var e=document.getElementById("exportCompress").checked?1:0,t="askZip=0&instance="+TRIANGLE.instance+"&compress="+e;AJAX.post("scripts/exportZip.php",t,function(e){console.log(e.responseText),TRIANGLE.exportCode.postTemplate("previewTemplate",{instance:TRIANGLE.instance})})},TRIANGLE.saveTemplate.saveCurrent())},error:function(){alert("Your template contains too many items to export. Please remove "+(TRIANGLE.templateItems.length-TRIANGLE.maxAllowedItems)+" items to export it.")},exportZip:function(){TRIANGLE.exportCode.format("zip"),setTimeout(TRIANGLE.loading.stop,1e3)},clearZip:function(){AJAX.get("scripts/clearZip.php","",function(e){})}},TRIANGLE.styleFunctions=[function(e,t){e.style.backgroundColor=t},function(e,t){e.style.backgroundImage=t},function(e,t){e.style.backgroundSize=t},function(e,t){e.style.backgroundPosition=t},function(e,t){e.style.backgroundIRepeat=t},function(e,t){e.style.height=t},function(e,t){e.style.minHeight=t},function(e,t){e.style.width=t},function(e,t){e.style.maxWidth=t},function(e,t){e.style.display=t},function(e,t){e.style.position=t},function(e,t){e.style.cssFloat=t},function(e,t){e.style.overflow=t},function(e,t){e.style.paddingLeft=t},function(e,t){e.style.paddingRight=t},function(e,t){e.style.paddingTop=t},function(e,t){e.style.paddingBottom=t},function(e,t){e.style.marginLeft=t},function(e,t){e.style.marginRight=t},function(e,t){e.style.marginTop=t},function(e,t){e.style.marginBottom=t},function(e,t){e.style.borderLeftWidth=t},function(e,t){e.style.borderLeftStyle=t},function(e,t){e.style.borderLeftColor=t},function(e,t){e.style.borderRightWidth=t},function(e,t){e.style.borderRightStyle=t},function(e,t){e.style.borderRightColor=t},function(e,t){e.style.borderTopWidth=t},function(e,t){e.style.borderTopStyle=t},function(e,t){e.style.borderTopColor=t},function(e,t){e.style.borderBottomWidth=t},function(e,t){e.style.borderBottomStyle=t},function(e,t){e.style.borderBottomColor=t},function(e,t){e.style.boxShadow=t},function(e,t){e.style.color=t},function(e,t){e.style.fontSize=t},function(e,t){e.style.fontWeight=t},function(e,t){e.style.lineHeight=t},function(e,t){e.style.textAlign=t},function(e,t){e.style.fontFamily=t},function(e,t){e.style.textDecoration=t},function(e,t){e.style.textDecorationColor=t},function(e,t){e.style.flexFlow=t},function(e,t){e.style.alignItems=t},function(e,t){e.style.justifyContent=t},function(e,t){e.style.transition=t},function(e,t){e.style.animation=t},function(e,t){e.innerHTML=t},function(e,t){e.className=t},function(e,t){t&&e.setAttribute("item-align",t)},function(e,t){t&&e.setAttribute("user-id",t)},function(e,t){t&&e.setAttribute("hover-style",t)},function(e,t){t&&e.setAttribute("link-to",t)},function(e,t){t&&e.setAttribute("name",t)},function(e,t){t&&e.setAttribute("onClick",t)},function(e,t){t&&e.setAttribute("crop-map",t)},function(e,t){t&&e.setAttribute("crop-ratio",t)},function(e,t){t&&e.setAttribute("target",t)},function(e,t){t&&e.setAttribute("user-class",t)},function(e,t){t&&e.setAttribute("form-email",t)}],TRIANGLE.getStyles=function(e){return[e.style.backgroundColor,e.style.backgroundImage,e.style.backgroundSize,e.style.backgroundPosition,e.style.backgroundRepeat,e.style.height,e.style.minHeight,e.style.width,e.style.maxWidth,e.style.display,e.style.position,e.style.cssFloat,e.style.overflow,e.style.paddingLeft,e.style.paddingRight,e.style.paddingTop,e.style.paddingBottom,e.style.marginLeft,e.style.marginRight,e.style.marginTop,e.style.marginBottom,e.style.borderLeftWidth,e.style.borderLeftStyle,e.style.borderLeftColor,e.style.borderRightWidth,e.style.borderRightStyle,e.style.borderRightColor,e.style.borderTopWidth,e.style.borderTopStyle,e.style.borderTopColor,e.style.borderBottomWidth,e.style.borderBottomStyle,e.style.borderBottomColor,e.style.boxShadow,e.style.color,e.style.fontSize,e.style.fontWeight,e.style.lineHeight,e.style.textAlign,e.style.fontFamily,e.style.textDecoration,e.style.textDecorationColor,e.style.flexFlow,e.style.alignItems,e.style.justifyContent,e.style.transition,e.style.animation,e.innerHTML,e.className,e.getAttribute("item-align"),e.getAttribute("user-id"),e.getAttribute("hover-style"),e.getAttribute("link-to"),e.getAttribute("name"),e.getAttribute("onClick"),e.getAttribute("crop-map"),e.getAttribute("crop-ratio"),e.getAttribute("target"),e.getAttribute("user-class"),e.getAttribute("form-email")]},TRIANGLE.createAnother=function(e){var t=document.createElement(e.tagName),o=TRIANGLE.getStyles(e);for(x=0;x<o.length;x++)TRIANGLE.styleFunctions[x](t,o[x]);return TRIANGLE.isType.imageItem(e)&&(t.src=e.src),t},TRIANGLE.style={convertWidth:function(e){if("inline"==e.style.display||"inline-block"==e.style.display||"inline-table"==e.style.display){var t=e.getBoundingClientRect();"auto"==e.style.width&&(e.style.width=t.width+"px")}},itemAlignLeft:function(){TRIANGLE.item.objRef.style.cssFloat="left",TRIANGLE.item.objRef.setAttribute("item-align","left"),TRIANGLE.importItem.single(TRIANGLE.item.index),TRIANGLE.selectionBorder.update()},itemAlignCenter:function(){var e=TRIANGLE.item;e.cssFloat&&(e.objRef.style.cssFloat=""),"inline"!=e.display&&"inline-block"!=e.display&&"inline-table"!=e.display&&e.display||(TRIANGLE.style.convertWidth(e.objRef),e.objRef.style.display="block"),e.objRef.style.marginLeft="auto",e.objRef.style.marginRight="auto",e.objRef.setAttribute("item-align","center"),TRIANGLE.importItem.single(e.index),TRIANGLE.selectionBorder.update()},itemAlignRight:function(){TRIANGLE.item.objRef.style.cssFloat="right",TRIANGLE.item.objRef.setAttribute("item-align","right"),TRIANGLE.importItem.single(TRIANGLE.item.index),TRIANGLE.selectionBorder.update()},verticalMiddle:function(){var e=TRIANGLE.item;"template"!=e.parent.getAttribute("id")&&(TRIANGLE.selectionBorder.remove(),TRIANGLE.checkPadding(e.parent),e.parent.style.display="flex",e.parent.style.alignItems="center",e.parent.style.flexFlow="row wrap",TRIANGLE.updateTemplateItems(!0),TRIANGLE.clearSelection())},itemAlignDefault:function(){if(TRIANGLE.item.objRef.style.cssFloat="","auto"===TRIANGLE.item.marginLeft&&(TRIANGLE.item.objRef.style.marginLeft=""),"auto"===TRIANGLE.item.marginRight&&(TRIANGLE.item.objRef.style.marginRight=""),"table-cell"===TRIANGLE.item.parent.style.display){var e=TRIANGLE.item.parent.parentNode,t=TRIANGLE.item.parent,o=t.innerHTML;e.removeChild(t),e.innerHTML+=o,e.style.display="block"}else"flex"===TRIANGLE.item.parent.style.display&&(TRIANGLE.item.parent.style.alignItems="",TRIANGLE.item.parent.style.display="block");TRIANGLE.item.objRef.removeAttribute("item-align"),TRIANGLE.importItem.single(TRIANGLE.item.index),TRIANGLE.selectionBorder.update()}},TRIANGLE.getElementByUserId=function(e){for(i=0;i<TRIANGLE.templateItems.length;i++)if(TRIANGLE.templateItems[i].getAttribute("user-id")===e)return TRIANGLE.templateItems[i]},TRIANGLE.effects={enterStudio:function(){document.getElementById("effectStudioMenu").style.display="block"},exitStudio:function(){document.getElementById("effectStudioMenu").style.display="none"}},TRIANGLE.effects.hover={transferStyles:function(e){if(e.getAttribute("hover-style")){var t=new RegExp("#"+e.getAttribute("id")+"(:hover)*{[^}]}","g"),o=document.getElementById("hoverData");t.test(o.innerHTML)&&(o.innerHTML=o.innerHTML.replace(t,"")),o.innerHTML+="#"+e.getAttribute("id")+"{"+e.getAttribute("style")+"}#"+e.getAttribute("id")+":hover{"+e.getAttribute("hover-style")+"}"}},prepareStyles:function(){for(document.getElementById("hoverData").innerHTML="",i=0;i<TRIANGLE.templateItems.length;i++)TRIANGLE.effects.hover.transferStyles(TRIANGLE.templateItems[i])},createHoverVersion:function(e){var t=document.createElement(e.tagName);t.style.cssText=e.getAttribute("hover-style"),t.setAttribute("id",e.getAttribute("id")+":hover"),document.getElementById("hoverItems").appendChild(t)},addStyle:function(){TRIANGLE.item.hoverVersion||TRIANGLE.effects.hover.createHoverVersion(TRIANGLE.item.objRef),TRIANGLE.updateTemplateItems()}},TRIANGLE.forms={insertForm:function(){var e=TRIANGLE.item;if(!(e&&"FORM"===e.tag||e&&TRIANGLE.isType.bannedInsertion(e.objRef)||e&&e.objRef.children[0]&&"table-cell"===e.objRef.children[0].style.display)){var t=document.createElement("form");t.className="templateItem childItem",t.style.backgroundColor="inherit",t.style.minHeight="100px",t.style.height="auto",t.style.width="100%",t.style.position="relative",t.style.borderLeft="1px dashed gray",t.style.borderRight="1px dashed gray",t.style.borderTop="1px dashed gray",t.style.borderBottom="1px dashed gray",e?(TRIANGLE.checkPadding(e.objRef),e.append(t)):(TRIANGLE.appendRow(),TRIANGLE.updateTemplateItems(),TRIANGLE.selectItem(TRIANGLE.templateItems[TRIANGLE.templateItems.length-1].getAttribute("index")),e=TRIANGLE.item,TRIANGLE.checkPadding(e.objRef),e.append(t)),TRIANGLE.updateTemplateItems(),TRIANGLE.selectionBorder.remove();var o=e.objRef.children.length,i=e.objRef.children[o-1].getAttribute("index");TRIANGLE.selectItem(i),TRIANGLE.saveItem.createAnimation("min-height",0,"100px",function(){TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.updateTemplateItems()}},insertField:function(){for(i=0;i<TRIANGLE.templateItems.length;i++){if(0===i&&(TRIANGLE.sv_item=new TRIANGLE.TemplateItem(TRIANGLE.item.index)),"template"===TRIANGLE.sv_item.parent.getAttribute("id"))return;if("FORM"===TRIANGLE.sv_item.parent.tagName.toUpperCase()||"FORM"===TRIANGLE.item.tag.toUpperCase())break;TRIANGLE.sv_item=new TRIANGLE.TemplateItem(TRIANGLE.sv_item.parent.getAttribute("index"))}TRIANGLE.text.insertTextBox("Field Label");var e=document.createElement("div");e.className="templateItem childItem formField",e.style.backgroundColor="white",e.style.minHeight="24px",e.style.height="24px",e.style.width="100%",e.style.position="relative",e.style.paddingLeft="2px",e.style.paddingRight="2px",e.style.paddingTop="2px",e.style.paddingBottom="2px",e.style.borderLeft="1px solid gray",e.style.borderRight="1px solid gray",e.style.borderTop="1px solid gray",e.style.borderBottom="1px solid gray",e.style.marginTop="3px",e.style.marginBottom="8px",e.style.font="inherit",TRIANGLE.item.append(e),TRIANGLE.updateTemplateItems(),TRIANGLE.importItem.single(TRIANGLE.item.index)},insertButton:function(){if(!TRIANGLE.item||"FORM"===TRIANGLE.item.tag){for(i=0;i<TRIANGLE.item.objRef.children.length;i++)if("BUTTON"===TRIANGLE.item.objRef.children[i].tagName)return;var e=document.createElement("button");e.className="templateItem childItem",e.innerHTML="Submit",e.style.display="block",e.style.margin="0 auto",e.setAttribute("onClick","event.preventDefault();"),TRIANGLE.item.append(e),TRIANGLE.updateTemplateItems(!0),TRIANGLE.importItem.single(TRIANGLE.item.index)}}},TRIANGLE.columnMap={template:{left:null,right:null},left:[],right:[],leftRound:[],rightRound:[]},TRIANGLE.locateColumns=function(){var e=document.getElementById("template").getBoundingClientRect();for(TRIANGLE.columnMap.template.left=e.left,TRIANGLE.columnMap.template.right=e.right,x=0,y=0;x<TRIANGLE.templateItems.length;x++){var t=TRIANGLE.templateItems[x].getBoundingClientRect();TRIANGLE.columnMap.left[x]=t.left,TRIANGLE.columnMap.right[x]=t.right,TRIANGLE.columnMap.leftRound[x]=Math.round(t.left),TRIANGLE.columnMap.rightRound[x]=Math.round(t.right)}return TRIANGLE.columnMap},TRIANGLE.saveTemplate={getSaveName:function(){TRIANGLE.popUp.open("getSaveNameCell"),document.getElementById("saveTemplateName").focus(),TRIANGLE.menu.closeSideMenu()},getPageName:function(){TRIANGLE.popUp.open("getPageNameCell"),document.getElementById("savePageName").focus(),TRIANGLE.menu.closeSideMenu()},saveTemplate:function(e,t){TRIANGLE.popUp.close(),TRIANGLE.popUp.open("savingCell"),e=encodeURIComponent(e),t&&""!=t||(t=""),t=encodeURIComponent(t);var o=TRIANGLE.json.encode();o=TRIANGLE.json.compress(o),o=encodeURIComponent(o);var i=encodeURIComponent(TRIANGLE.developer.globalStyleTagContent),n=encodeURIComponent(TRIANGLE.developer.globalScriptTagContent),r="templateName="+e+"&pageName="+t+"&instance="+TRIANGLE.instance+"&content="+o+"&globalStyle="+i+"&globalScript="+n;AJAX.post("scripts/saveTemplate.php",r,function(o){TRIANGLE.saveTemplate.saveUserIDs(),TRIANGLE.saveTemplate.saveUserClasses(),TRIANGLE.popUp.close(),document.getElementById("saveTemplateName").value="",document.getElementById("savePageName").value="",TRIANGLE.updateTemplateItems(),TRIANGLE.clearSelection(),TRIANGLE.pages.loadPages(e,"menu"),document.getElementById("saveCurrentTemplate").parentNode.style.display="block",document.getElementById("saveNewPage").parentNode.style.display="block",e&&(TRIANGLE.currentTemplate=e),TRIANGLE.currentPage=t,TRIANGLE.unsaved=!1,TRIANGLE.unsavedPremade=!1,TRIANGLE.popUp.close(),TRIANGLE.popUp.open("savedCell"),TRIANGLE.exportCode.callbackAfterSave?(TRIANGLE.exportCode.callbackAfterSave(),TRIANGLE.exportCode.callbackAfterSave=!1):setTimeout(function(){TRIANGLE.popUp.close(),location.href="index.php?pagename="+TRIANGLE.currentPage+"&loadTemplate="+TRIANGLE.currentTemplate},1e3)})},cancelSave:function(){TRIANGLE.popUp.close(),document.getElementById("saveTemplateName").value=""},saveCurrent:function(e){TRIANGLE.popUp.close(),TRIANGLE.popUp.open("savingCell");var t=TRIANGLE.json.encode();t=TRIANGLE.json.compress(t),t=encodeURIComponent(t);var o=encodeURIComponent(TRIANGLE.developer.globalStyleTagContent),i=encodeURIComponent(TRIANGLE.developer.globalScriptTagContent),n="instance="+TRIANGLE.instance+"&content="+t+"&globalStyle="+o+"&globalScript="+i+"&changesMade="+TRIANGLE.changesMade;AJAX.post("scripts/saveCurrent.php",n,function(e){TRIANGLE.saveTemplate.saveUserIDs(),TRIANGLE.saveTemplate.saveUserClasses(),"none"!=document.getElementById("sideMenu").display&&TRIANGLE.menu.closeSideMenu(),TRIANGLE.updateTemplateItems(),TRIANGLE.clearSelection(),TRIANGLE.unsaved=!1,TRIANGLE.popUp.close(),TRIANGLE.popUp.open("savedCell"),setTimeout(TRIANGLE.popUp.close,1e3),TRIANGLE.exportCode.callbackAfterSave&&(TRIANGLE.exportCode.callbackAfterSave(),TRIANGLE.exportCode.callbackAfterSave=!1)})},saveUserIDs:function(){var e=document.getElementById("template").querySelectorAll("*[user-id]"),t={};for(i=0;i<e.length;i++){var o=e[i].getAttribute("user-id");if(o){var n=e[i].nextSibling,r=e[i].previousSibling;t[o]={};var l={};t[o]["user-class"]=e[i].getAttribute("user-class"),t[o].tagName=e[i].tagName,t[o].id=o,l[e[i].id]=o,t[o].className=e[i].className,t[o].name=e[i].getAttribute("name"),t[o].style=e[i].style.cssText,t[o].clearFloat=TRIANGLE.isType.clearFloat(r)?1:0,(TRIANGLE.isType.textBox(e[i])||TRIANGLE.isType.imageItem(e[i])||TRIANGLE.isType.formBtn(e[i])||TRIANGLE.isType.snippetItem(e[i]))&&(t[o].innerHTML=e[i].innerHTML.replace(/&nbsp;/g,encodeURIComponent("&nbsp;"))),t[o].src=e[i].src,t[o].childof=0,t[o].nextSib=n&&TRIANGLE.isType.templateItem(n)?n.id:0,t[o].prevSib=r&&TRIANGLE.isType.templateItem(r)?r.id:0,t[o].isLastChild=!n||n&&!TRIANGLE.isType.templateItem(n)?1:0,t[o]["item-align"]=e[i].getAttribute("item-align"),t[o]["hover-style"]=e[i].getAttribute("hover-style"),t[o]["link-to"]=e[i].getAttribute("link-to"),t[o].onClick=e[i].getAttribute("onclick"),t[o]["crop-map"]=e[i].getAttribute("crop-map"),t[o]["crop-ratio"]=e[i].getAttribute("crop-ratio"),t[o].target=e[i].getAttribute("target"),t[o]["form-email"]=e[i].getAttribute("form-email"),t[o].responsive=[e[i].style.width,e[i].getBoundingClientRect().width,e[i].getBoundingClientRect().top],t[o].children={};e[i].querySelector("*[user-id]");var s=e[i].querySelectorAll(".templateItem");for(x=0;x<s.length;x++){n=s[x].nextSibling,r=s[x].previousSibling;var a=o+x;l[s[x].id]=a,t[o].children[a]={},t[o].children[a]["user-id"]=s[x].getAttribute("user-id"),t[o].children[a]["user-class"]=s[x].getAttribute("user-class"),t[o].children[a].tagName=s[x].tagName,t[o].children[a].className=s[x].className,t[o].children[a].name=s[x].getAttribute("name"),t[o].children[a].style=s[x].style.cssText,t[o].children[a].clearFloat=TRIANGLE.isType.clearFloat(n)?1:0,(TRIANGLE.isType.textBox(s[x])||TRIANGLE.isType.imageItem(s[x])||TRIANGLE.isType.formBtn(s[x])||TRIANGLE.isType.snippetItem(s[x]))&&(t[o].children[a].innerHTML=s[x].innerHTML.replace(/&nbsp;/g,encodeURIComponent("&nbsp;"))),t[o].children[a].src=s[x].src,t[o].children[a].children=s[x].querySelector(".templateItem")?1:0,t[o].children[a].childof=l[s[x].getAttribute("childof")],t[o].children[a].nextSib=n&&TRIANGLE.isType.templateItem(n)?o+(x+1):0,t[o].children[a].prevSib=r&&TRIANGLE.isType.templateItem(r)?l[r.id]:0,t[o].children[a].isLastChild=!n||n&&!TRIANGLE.isType.templateItem(n)?1:0,t[o].children[a]["item-align"]=s[x].getAttribute("item-align"),t[o].children[a]["hover-style"]=s[x].getAttribute("hover-style"),t[o].children[a]["link-to"]=s[x].getAttribute("link-to"),t[o].children[a].onClick=s[x].getAttribute("onclick"),t[o].children[a]["crop-map"]=s[x].getAttribute("crop-map"),t[o].children[a]["crop-ratio"]=s[x].getAttribute("crop-ratio"),t[o].children[a].target=s[x].getAttribute("target"),t[o].children[a]["form-email"]=s[x].getAttribute("form-email"),t[o].children[a].responsive=[s[x].style.width,s[x].getBoundingClientRect().width,s[x].getBoundingClientRect().top]}}}var d=JSON.stringify(t),m="instance="+TRIANGLE.instance+"&content="+d;AJAX.post("scripts/saveUserIDs.php",m,function(e){})},saveUserClasses:function(){var e=document.getElementById("template").querySelectorAll("[user-class]");if(e){var t=[];for(i=0,k=0;i<e.length;i++){var o=e[i].getAttribute("user-class");o&&-1===t.indexOf(o)&&(t[k]=o,k++)}var n={};for(i=0;i<t.length;i++){var r=document.getElementById("template").querySelector("[user-class="+t[i]+"]").style.cssText;n[t[i]]=r}var l=JSON.stringify(n),s="instance="+TRIANGLE.instance+"&content="+l;AJAX.post("scripts/saveUserClasses.php",s,function(e){})}},saveAll:function(){console.log("saving all...");var e=document.getElementById("echoPageList").querySelectorAll(".pageThumbnail");for(i=0;i<e.length;i++){var t=e[i].innerHTML;setTimeout(function(e){TRIANGLE.loadTemplate.loadTemplate(TRIANGLE.currentTemplate,e),console.log(e),setTimeout(TRIANGLE.saveTemplate.saveCurrent,1e3)},3e3*i,t)}},newPage:null,createNewPage:function(e){var t=document.getElementById("newPageNameInput");if(""===t.value)return TRIANGLE.error("Please enter a page name"),void t.focus();e=t.value,TRIANGLE.saveTemplate.saveCurrent(),AJAX.get("scripts/createPage.php","instance="+TRIANGLE.instance+"&pageName="+e,function(e){console.log(e.responseText)}),document.getElementById("createNewPage").style.display="none",t.value="",TRIANGLE.menu.closeSideMenu(),TRIANGLE.saveTemplate.newPage=e,setTimeout(function(){TRIANGLE.loadTemplate.loadTemplate(TRIANGLE.currentTemplate,TRIANGLE.saveTemplate.newPage)},500)}},TRIANGLE.loadTemplate={hide:function(){var e=document.getElementById("template");e.style.opacity=0,e.style.visibility="hidden"},show:function(){var e=document.getElementById("template");e.style.visibility="visible",e.style.opacity=1},getLoadList:function(){AJAX.get("scripts/loadList.php","",function(e){document.getElementById("echoLoadList").innerHTML=e.responseText;var t=document.getElementById("echoLoadList").querySelectorAll(".loadListItem");for(i=0;i<t.length;i++)""!==TRIANGLE.currentTemplate&&t[i].innerHTML==TRIANGLE.currentTemplate?t[i].style.backgroundColor="#ccdef6":t[i].style.backgroundColor=""})},loadTemplate:function(e,t){var o="";if(t&&"string"==typeof t)o="&pageName="+t;else if("object"==typeof t);else t="";var i="templateName="+e+o+"&instance="+TRIANGLE.instance;AJAX.post("scripts/loadTemplate.php",i,function(o){"none"===document.getElementById("loadingCell").style.display&&TRIANGLE.popUp.close(),document.getElementById("loadTemplatesCell").style.display="none",TRIANGLE.template.blank();var i=TRIANGLE.json.decompress(o.responseText.replace(/http:\/\/trianglecms\.com/g,"https://trianglecms.com"));TRIANGLE.json.decode(i),TRIANGLE.library.loadUserIDs(),TRIANGLE.updateTemplateItems(),TRIANGLE.loadTemplate.updateUserIDs(),TRIANGLE.updateTemplateItems(),TRIANGLE.loadTemplate.updateUserClasses(),TRIANGLE.updateTemplateItems(),TRIANGLE.clearSelection(),TRIANGLE.colors.updateBodyBg(),TRIANGLE.pages.loadPages(e),TRIANGLE.dragDrop.updateItemMap(),document.getElementById("saveCurrentTemplate").parentNode.style.display="",document.getElementById("saveNewPage").parentNode.style.display="",TRIANGLE.currentTemplate=e,TRIANGLE.currentPage=t,setTimeout(TRIANGLE.updateTemplateItems,100),document.getElementById("FTPselect").selectedIndex=0,TRIANGLE.options.compareUndoList()})},cancelLoad:function(){TRIANGLE.popUp.close()},updateUserIDs:function(){var e="instance="+TRIANGLE.instance;AJAX.post("scripts/readUserIDs.php",e,function(e){if(e.responseText){var t=JSON.parse(e.responseText),o=document.getElementById("template").querySelectorAll("[update-user-id]"),n={};for(i=0;i<o.length;i++)n[o[i].getAttribute("update-user-id")]=i;for(var r in t){var l=!1;if(isNaN(n[r])){if(!TRIANGLE.getElementByUserId(r))continue;l=TRIANGLE.getElementByUserId(r)}else l=o[parseInt(n[r])];var s=document.createElement(t[r].tagName);s.id=t[r].id,s.setAttribute("user-id",r),s=TRIANGLE.json.convertItem(t[r],s),l.parentNode.insertBefore(s,l),l.parentNode.removeChild(l);var a=t[r].children;for(var d in a){var m=document.createElement(a[d].tagName);m.id=d,a[d]["user-id"]&&m.setAttribute("user-id",a[d]["user-id"]),m=TRIANGLE.json.convertItem(a[d],m);var c=a[d].childof;c?document.getElementById(c).appendChild(m):m=null}TRIANGLE.updateTemplateItems()}TRIANGLE.updateTemplateItems(),TRIANGLE.loadTemplate.show()}else TRIANGLE.loadTemplate.show()})},updateUserClasses:function(){var e="instance="+TRIANGLE.instance;AJAX.post("scripts/readUserClasses.php",e,function(e){if(e.responseText){var t=JSON.parse(e.responseText);for(var o in TRIANGLE.userClasses=t,t){var n=document.getElementById("template").querySelectorAll("[user-class="+o+"]");for(i=0;i<n.length;i++)n[i].style.cssText=t[o]}}})},importWebsite:function(e){TRIANGLE.popUp.close(),(!e||e&&"string"!=typeof e)&&(e=document.getElementById("importWebsiteURL").value),TRIANGLE.importWebsiteURL=e,AJAX.get("scripts/importWebsite.php","url="+encodeURIComponent(e),function(t){if(t.responseText){var o=t.responseText,n=document.getElementById("importWebsite");n.innerHTML=o;var r=n.querySelector("title");document.getElementById("metaTitle").value=TRIANGLE.metaData.title=r.innerHTML;var l=n.querySelectorAll("link");for(i=0;i<l.length;i++)l[i].getAttribute("defer")&&(l[i].setAttribute("href",l[i].getAttribute("defer")),l[i].removeAttribute("defer"));var s=n.querySelectorAll("img");for(i=0;i<s.length;i++){s[i].getAttribute("lazyload")&&(s[i].src=s[i].getAttribute("lazyload"),s[i].removeAttribute("lazyload"));var a="/"===s[i].getAttribute("src")[0]?"":"/";s[i].src=e+a+s[i].getAttribute("src")}}})}},TRIANGLE.json={encode:function(){var e={};e.hoverData=document.getElementById("hoverData").innerHTML,e.hoverItems=document.getElementById("hoverItems").innerHTML,e.animationData=document.getElementById("animationData").innerHTML,e.bodyBgData=document.getElementById("bodyBgData").style.cssText,e.fontData=document.getElementById("fontData").innerHTML,e.metaTitle=TRIANGLE.metaData.title,e.metaKeywords=TRIANGLE.metaData.keywords,e.metaDescription=TRIANGLE.metaData.description,e.fixedWidth=document.getElementById("template").style.width,e.exportCompress=document.getElementById("exportCompress").checked,e.importWebsiteURL=TRIANGLE.importWebsiteURL,e.styleTag=TRIANGLE.developer.styleTagContent,e.scriptTag=TRIANGLE.developer.scriptTagContent,e.imageList={itemNums:[],paths:[],dimensions:[]};var t=document.getElementById("template").querySelectorAll(".imageItem[crop-map]"),o=t.length;for(i=0;i<o;i++){TRIANGLE.sv_item=new TRIANGLE.TemplateItem(t[i].getAttribute("index")),e.imageList.itemNums[i]=TRIANGLE.sv_item.index,e.imageList.paths[i]=TRIANGLE.sv_item.image.src;var n=TRIANGLE.sv_item.objRef.getBoundingClientRect(),r=TRIANGLE.sv_item.image.getBoundingClientRect(),l=n.width/r.width,s=n.height/r.height,a=(n.left-r.left)/r.width,d=(n.top-r.top)/r.height;e.imageList.dimensions[i]=[l,s,a,d]}e.items={};var m=[];for(i=0;i<TRIANGLE.templateItems.length;i++)if(TRIANGLE.sv_item=new TRIANGLE.TemplateItem(i),!(m.indexOf(TRIANGLE.sv_item.id)>-1)){var c="item"+i;if(TRIANGLE.sv_item.userID){e.items[c]=TRIANGLE.sv_item.userID,"template"!==TRIANGLE.sv_item.parent.id&&(e.items[c]+=" "+TRIANGLE.sv_item.parent.id);var I=TRIANGLE.sv_item.objRef.querySelectorAll("*");for(x=0;x<I.length;x++)m.push(I[x].getAttribute("id"))}else e.items[c]={},e.items[c]["user-class"]=TRIANGLE.sv_item.userClass,e.items[c].tagName=TRIANGLE.sv_item.tag,e.items[c].className=TRIANGLE.sv_item.className,e.items[c].name=TRIANGLE.sv_item.objRef.getAttribute("name"),e.items[c].style=TRIANGLE.sv_item.objRef.style.cssText,e.items[c].clearFloat=TRIANGLE.isType.clearFloat(TRIANGLE.sv_item.objRef.nextSibling)?1:0,(TRIANGLE.isType.textBox(TRIANGLE.sv_item.objRef)||TRIANGLE.isType.imageItem(TRIANGLE.sv_item.objRef)||TRIANGLE.isType.formBtn(TRIANGLE.sv_item.objRef)||TRIANGLE.isType.snippetItem(TRIANGLE.sv_item.objRef))&&(e.items[c].innerHTML=TRIANGLE.sv_item.objRef.innerHTML.replace(/&nbsp;/g," ")),e.items[c].src=TRIANGLE.sv_item.objRef.src,e.items[c].children=TRIANGLE.sv_item.objRef.querySelector(".templateItem")?1:0,e.items[c].childof=TRIANGLE.sv_item.childOf,e.items[c].nextSib=TRIANGLE.sv_item.nextSibling()?TRIANGLE.sv_item.nextSibling().id:0,e.items[c].prevSib=TRIANGLE.sv_item.prevSibling()?TRIANGLE.sv_item.prevSibling().id:0,e.items[c].isLastChild=TRIANGLE.sv_item.isLastChild,e.items[c]["item-align"]=TRIANGLE.sv_item.align,e.items[c]["hover-style"]=TRIANGLE.sv_item.hover.cssText,e.items[c]["link-to"]=TRIANGLE.sv_item.linkTo,e.items[c].onClick=TRIANGLE.sv_item.objRef.getAttribute("onclick"),e.items[c]["crop-map"]=TRIANGLE.sv_item.cropMap,e.items[c]["crop-ratio"]=TRIANGLE.sv_item.cropRatio,e.items[c].target=TRIANGLE.sv_item.objRef.getAttribute("target"),e.items[c]["form-email"]=TRIANGLE.sv_item.objRef.getAttribute("form-email")}return e.responsiveItems=TRIANGLE.responsive.prepare(),JSON.stringify(e)},decode:function(e){var t=JSON.parse(e);TRIANGLE.json.convertTemplateData(t);var o=t.items;for(var i in o)if("string"!=typeof o[i]){(r=document.createElement(o[i].tagName)).id=i,o[i]["user-id"]&&r.setAttribute("user-id",o[i]["user-id"]),r=TRIANGLE.json.convertItem(o[i],r);var n=o[i].childof;if(n&&document.getElementById(n))document.getElementById(n).appendChild(r);else{if(n&&!document.getElementById(n))continue;document.getElementById("template").appendChild(r)}}else{var r,l=o[i].split(" ");(r=document.createElement("div")).setAttribute("update-user-id",l[0]),l[1]?document.getElementById(l[1]).appendChild(r):document.getElementById("template").appendChild(r)}},toHTML:function(e){document.getElementById("JSONtoHTML").innerHTML="";var t=JSON.parse(e);for(var o in t){var i=document.createElement(t[o].tagName);i.id=t[o].id,i.setAttribute("user-id",o),i=TRIANGLE.json.convertItem(t[o],i),document.getElementById("JSONtoHTML").appendChild(i);var n=t[o].children;for(var r in n){var l=document.createElement(n[r].tagName);l.id=r,n[r]["user-id"]&&l.setAttribute("user-id",n[r]["user-id"]),l=TRIANGLE.json.convertItem(n[r],l);var s=n[r].childof;s?document.getElementById("JSONtoHTML").querySelector("#"+s).appendChild(l):l=null}}return document.getElementById("JSONtoHTML").innerHTML},convertTemplateData:function(e){document.getElementById("hoverData").innerHTML=e.hoverData,document.getElementById("hoverItems").innerHTML=e.hoverItems,document.getElementById("animationData").innerHTML=e.hoverItems,document.getElementById("bodyBgData").style.cssText=e.bodyBgData,document.getElementById("fontData").innerHTML=e.fontData,document.getElementById("template").style.width=e.fixedWidth,"px"===TRIANGLE.getUnit(e.fixedWidth)&&(document.getElementById("template").style.margin="0 auto"),document.getElementById("metaTitle").value=e.metaTitle?e.metaTitle:"",TRIANGLE.metaData.title=document.getElementById("metaTitle").value,document.getElementById("metaKeywords").value=e.metaKeywords?e.metaKeywords:"",TRIANGLE.metaData.keywords=document.getElementById("metaKeywords").value,document.getElementById("metaDescription").value=e.metaDescription?e.metaDescription:"",TRIANGLE.metaData.description=document.getElementById("metaDescription").value,document.getElementById("exportCompress").checked=e.exportCompress,e.importWebsiteURL&&TRIANGLE.loadTemplate.importWebsite(e.importWebsiteURL),TRIANGLE.developer.styleTagContent=document.getElementById("styleTag").value=e.styleTag?e.styleTag:"",TRIANGLE.developer.globalStyleTagContent=document.getElementById("globalStyleTag").value=e.globalStyleTag?e.globalStyleTag:"",TRIANGLE.developer.scriptTagContent=document.getElementById("scriptTag").value=e.scriptTag?e.scriptTag:"",TRIANGLE.developer.globalScriptTagContent=document.getElementById("globalScriptTag").value=e.globalScriptTag?e.globalScriptTag:""},convertItem:function(e,t){return t.className=e.className,e["user-class"]&&t.setAttribute("user-class",e["user-class"]),e.name&&t.setAttribute("name",e.name),t.style.cssText=e.style,t.innerHTML=e.innerHTML?e.innerHTML:"",t.src=e.src?e.src:"",e["item-align"]&&t.setAttribute("item-align",e["item-align"]),e["hover-style"]&&t.setAttribute("hover-style",e["hover-style"]),e["link-to"]&&t.setAttribute("link-to",e["link-to"]),e.onClick&&t.setAttribute("onClick",e.onClick),e["crop-map"]&&t.setAttribute("crop-map",e["crop-map"]),e["crop-ratio"]&&t.setAttribute("crop-ratio",e["crop-ratio"]),e.target&&t.setAttribute("target",e.target),e["form-email"]&&t.setAttribute("form-email",e["form-email"]),t},toNVP:function(e){var t=JSON.parse(e),o="";for(var i in t)o+=i+":"+t[i]+";";return o},readNVP:function(e){var t=e.split(";"),o={};for(i=0;i<t.length;i++){var n=t[i].split(":");o[n[0]]=n[1]}return JSON.stringify(o)},compress:function(e){for(var t in(e=JSON.parse(e)).items)if("string"!=typeof e.items[t]){for(var o in TRIANGLE.json.compressionMap)e.items[t].style=e.items[t].style.replace(o+":","%"+TRIANGLE.json.compressionMap[o]);var n=e.items[t].style,r=n.split(";");for(i=0;i<r.length;i++)r[i]=r[i].trim();for(var l in e.items){if(e.items[t]===e.items[l])break;var s=e.items[l].style;if(s){var a=s.split(";");for(i=0;i<a.length;i++)a[i]=a[i].trim();if(r.sort().toString()===a.sort().toString()){n=l;break}}}e.items[t].style=n}for(var t in e.responsiveItems){var d=e.responsiveItems[t];for(var l in e.responsiveItems){if(e.responsiveItems[t]===e.responsiveItems[l])break;var m=e.responsiveItems[l];if(JSON.stringify(d)===JSON.stringify(m)){d=l;break}}e.responsiveItems[t]=d}return JSON.stringify(e)},decompress:function(e){for(var t in(e=JSON.parse(e)).items)if("string"!=typeof e.items[t]){var o=e.items[t].style;for(var i in e.items[o]&&(e.items[t].style=e.items[o].style),TRIANGLE.json.compressionMap)e.items[t].style=e.items[t].style.replace("%"+TRIANGLE.json.compressionMap[i],i+":")}return JSON.stringify(e)},compressionMap:{"background-color":"bC","background-image":"bI","background-size":"bSz",background:"bg","min-height":"mH",height:"h","max-width":"mW",width:"w",display:"d",position:"po",float:"cF",overflow:"o","vertical-align":"vA",padding:"p",margin:"m","box-shadow":"bS","border-radius":"bR","border-width":"bW",border:"b",left:"L",right:"R",top:"T",bottom:"B",color:"c","font-size":"fS","line-height":"lH","text-align":"tA","font-family":"fF","font-weight":"fW","text-decoration":"tD","text-decoration-color":"tDc"}},TRIANGLE.pages={loadPages:function(e,t){e||(e="");var o="templateName="+encodeURIComponent(e)+"&listType="+t+"&instance="+TRIANGLE.instance;AJAX.get("scripts/pageList.php",o,function(e){if("menu"==t){document.getElementById("echoPageList").innerHTML=e.responseText;var o=document.getElementById("echoPageList").querySelectorAll(".pageThumbnail");for(i=0;i<o.length;i++)""!==TRIANGLE.currentPage&&o[i].innerHTML==TRIANGLE.currentPage?o[i].style.backgroundColor="#ccdef6":o[i].style.backgroundColor=""}else document.getElementById("hyperlinkPage").innerHTML='<option value="default" selected="selected">- Select a page -</option>'+e.responseText})},confirmDeletePage:function(e){document.getElementById("confirmDeletePage").innerHTML=e,document.getElementById("confirmDeletePageBtn").setAttribute("onClick","TRIANGLE.pages.deletePage('"+e+"');"),TRIANGLE.popUp.open("deletePageCell")},deletePage:function(e){AJAX.get("scripts/deletePage.php","instance="+TRIANGLE.instance+"&page="+e,function(t){if(parseInt(t.responseText)){var o=document.getElementsByClassName("pageThumbnail");for(i=0;i<o.length;i++)if(o[i].innerHTML===e){o[i].className+=" fadeOut",o[i].nextSibling.className+=" fadeOut";var n=o[i];setTimeout(function(){n.parentNode.removeChild(n.nextSibling),n.parentNode.removeChild(n)},200);break}(TRIANGLE.currentPage=e)&&TRIANGLE.loadTemplate.loadTemplate(TRIANGLE.currentTemplate,"index"),TRIANGLE.popUp.close()}else TRIANGLE.error("Error deleting page")})}},TRIANGLE.responsive={prepare:function(){var e={};for(i=0;i<TRIANGLE.templateItems.length;i++){var t=TRIANGLE.templateItems[i],o=t.getBoundingClientRect(),n=[t.style.width,Math.round(1e4*o.width)/1e4,o.top];e[t.id]=n}return e}},TRIANGLE.defaultSettings=function(){TRIANGLE.colors.updateBodyBg(),TRIANGLE.menu.displaySubMenu("displayGeneralOptions"),TRIANGLE.menu.addMenuBtnEvent(),TRIANGLE.menu.menuBtnActive(document.getElementById("opGeneralOptions")),TRIANGLE.menu.addOptionLabelEvents(),document.getElementById("colorMainBg").style.backgroundColor=document.body.style.backgroundColor,document.getElementById("templateWrapper").addEventListener("mousedown",TRIANGLE.clearSelection,!0),document.getElementById("bottomMarker").addEventListener("mousedown",TRIANGLE.clearSelection,!0),document.getElementById("templateWrapper").addEventListener("mouseup",TRIANGLE.text.checkTextEditing,!0),document.getElementById("bottomMarker").addEventListener("mouseup",TRIANGLE.text.checkTextEditing,!0),document.body.addEventListener("mouseover",TRIANGLE.hoverBorder.hide,!0),document.addEventListener("scroll",function(){TRIANGLE.hoverBorder.hide(),TRIANGLE.selectionBorder.update(),TRIANGLE.dragDrop.updateItemMap()}),document.addEventListener("keyup",function(e){TRIANGLE.keyEvents.whichKey.document(e),setTimeout(TRIANGLE.options.compareUndoList,330)}),document.addEventListener("mouseup",function(){TRIANGLE.dragDrop.stop(),setTimeout(TRIANGLE.options.compareUndoList,330)}),document.addEventListener("mousedown",function(){TRIANGLE.item&&TRIANGLE.item.objRef.isContentEditable&&(TRIANGLE.text.originalTextPosition=TRIANGLE.text.getSelectionCoords().r)}),document.addEventListener("keydown",function(e){document.getElementById("updateAnimation").innerHTML="",e.ctrlKey&&83===e.keyCode&&e.preventDefault(),TRIANGLE.item&&TRIANGLE.item.objRef.isContentEditable||!e.ctrlKey||90!==e.keyCode||e.preventDefault(),e.ctrlKey&&86==e.keyCode&&TRIANGLE.item&&TRIANGLE.item.objRef.isContentEditable&&(TRIANGLE.text.originalTextPosition=TRIANGLE.text.getSelectionCoords().r)}),window.addEventListener("resize",TRIANGLE.selectionBorder.update),TRIANGLE.images.load(),TRIANGLE.library.load(),TRIANGLE.colors.fillCanvas("red"),TRIANGLE.colors.setColorBoxEvents(),document.getElementById("colorPaletteBar").addEventListener("mousedown",TRIANGLE.colors.dragPalette.initiate,!0),TRIANGLE.images.crop.addHandleEventListeners();var e=document.createElement("div");e.className="scrollbar-measure",document.body.appendChild(e),TRIANGLE.scrollbarWidth=e.offsetWidth-e.clientWidth,document.body.removeChild(e),document.body.addEventListener("mousedown",function(e){"img"===e.target.tagName.toLowerCase()&&e.preventDefault()});var t=function(e){for(var t=(e=e||window.event).target||e.srcElement;t.tagName&&"a"!=t.tagName.toLowerCase()&&!TRIANGLE.isType.textBox(t);)t=t.parentNode;if(t.tagName&&"a"===t.tagName.toLowerCase()&&(e.preventDefault||(e.returnValue=!1,e.cancelBubble=!0),e.preventDefault(),e.stopPropagation(),TRIANGLE.text.importedHyperlink=t,TRIANGLE.item)){document.getElementById("hrefHyperlink").disabled=!1,document.getElementById("hrefHyperlink").value=TRIANGLE.text.importedHyperlink.getAttribute("href");var o=document.getElementById("hrefTarget");o.disabled=!1;var n=TRIANGLE.text.importedHyperlink.getAttribute("target"),r=0;for(i=0;i<o.length;i++)n===o.options[i].text&&(r=i);o.selectedIndex=r}};window.addEventListener?document.getElementById("template").addEventListener("click",t,!1):document.getElementById("template").attachEvent("onclick",t),window.onbeforeunload=function(){if(TRIANGLE.unsaved)return"Changes you made may not be saved"}},TRIANGLE.defaultSettings(),TRIANGLE.popUp={open:function(e){var t=document.getElementsByClassName("popUp");for(i=0;i<t.length;i++)t[i].style.display="none";document.getElementById("darkWrapper").style.display="table",document.getElementById(e).style.display="table-cell",document.getElementById("darkWrapper").className="fadeIn"},close:function(){document.getElementById("darkWrapper").style.display="none";var e=document.getElementsByClassName("popUp");for(i=0;i<e.length;i++)e[i].style.display="none"}},TRIANGLE.error=function(e,t){document.getElementById("errorMsg").innerHTML="",e&&t&&"string"==typeof e&&"string"==typeof t?(document.getElementById("errorTitle").innerHTML=e,document.getElementById("errorMsg").innerHTML=t):e&&(t=e,e="Error",document.getElementById("errorTitle").innerHTML=e,document.getElementById("errorMsg").innerHTML=t),TRIANGLE.popUp.open("errorCell")};
