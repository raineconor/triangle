var TRIANGLE=TRIANGLE||{},i=0,j=0,k=0,x=0,y=0,z=0;TRIANGLE.version="1.01.39";
TRIANGLE.images={load:function(){AJAX.get("scripts/imageList.php","",function(a){document.getElementById("echoImageList").innerHTML=a.responseText})},insert:function(a){if(TRIANGLE.item){if(TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)){TRIANGLE.item.image.src=a;TRIANGLE.item.image.style.width="100%";TRIANGLE.item.image.style.height="auto";TRIANGLE.item.image.style.margin="";TRIANGLE.item.objRef.style.overflow="";TRIANGLE.item.objRef.style.height="auto";TRIANGLE.item.objRef.style.minHeight="auto";
TRIANGLE.item.objRef.removeAttribute("crop-map");TRIANGLE.item.objRef.removeAttribute("crop-ratio");TRIANGLE.selectionBorder.update();TRIANGLE.importItem.single(TRIANGLE.item.index);TRIANGLE.menu.closeSideMenu();return}if(!TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef))if(TRIANGLE.images.setBackground)TRIANGLE.item.objRef.style.backgroundImage="url('"+a+"')",TRIANGLE.item.objRef.style.backgroundSize="cover",TRIANGLE.item.objRef.style.backgroundRepeat="no-repeat",TRIANGLE.item.objRef.style.backgroundPosition=
"center top",TRIANGLE.images.setBackground=!1;else{TRIANGLE.isType.containsNbsp(TRIANGLE.item.objRef)&&TRIANGLE.stripNbsp(TRIANGLE.item.objRef);var b=document.createElement("div");b.className="templateItem childItem imageItem";b.style.display="inline-block";b.style.height="auto";b.style.minHeight="auto";b.style.width="auto";b.style.maxWidth="100%";var c=document.createElement("img");c.src=a;c.style.width="100%";c.style.height="auto";TRIANGLE.checkPadding(TRIANGLE.item.objRef);b.appendChild(c);TRIANGLE.item.append(b);
TRIANGLE.selectionBorder.update();TRIANGLE.updateTemplateItems();a=TRIANGLE.item.objRef.children[TRIANGLE.item.objRef.children.length-1].getAttribute("index");TRIANGLE.importItem.single(a)}}else TRIANGLE.images.setBackground?(document.getElementById("bodyBgData").style.backgroundImage=document.body.style.backgroundImage="url('"+a+"')",document.getElementById("bodyBgData").style.backgroundRepeat=document.body.style.backgroundRepeat="repeat"):(b=document.createElement("div"),b.className="templateItem childItem imageItem",
b.style.display="inline-block",b.style.height="auto",b.style.minHeight="auto",b.style.width="auto",b.style.maxWidth="100%",c=document.createElement("img"),c.src=a,c.style.width="100%",c.style.height="100%",b.appendChild(c),document.getElementById("template").appendChild(b),TRIANGLE.updateTemplateItems(),TRIANGLE.importItem.single(TRIANGLE.templateItems.length-1));TRIANGLE.menu.closeSideMenu()},setBackground:!1,removeBackground:function(){TRIANGLE.item?(TRIANGLE.item.objRef.style.backgroundImage="",
TRIANGLE.item.objRef.style.backgroundSize=""):document.getElementById("bodyBgData").style.backgroundImage=document.body.style.backgroundImage=document.getElementById("bodyBgData").style.backgroundRepeat=document.body.style.backgroundRepeat=""},crop:{toggleMenu:function(){var a=document.getElementById("cropImageMenu");a.style.display="none"===a.style.display?"block":"none"},active:!1,transferImage:function(){var a=TRIANGLE.item.objRef.getBoundingClientRect(),b=TRIANGLE.item.image,c=b.cloneNode(),d=
TRIANGLE.item.image.getBoundingClientRect(),e=document.getElementById("cropImageContainer"),g=document.getElementById("cropImageHandles"),f=window.innerWidth-TRIANGLE.scrollbarWidth,m=window.innerHeight;if(TRIANGLE.item.cropMap)var l=TRIANGLE.item.cropMap.split(",")[0],h=TRIANGLE.item.cropMap.split(",")[1],n=TRIANGLE.item.cropMap.split(",")[2],p=TRIANGLE.item.cropMap.split(",")[3];e.style.marginTop=(m-504)/2+"px";document.getElementById("cropImageBg").style.backgroundImage="url('"+b.src+"')";g.innerHTML=
"";g.appendChild(c);c=g.children[0];e=b=500;var q=a.width/d.width;a=a.height/d.height;d.width>d.height?(e*=d.height/d.width,c.style.marginLeft=n?n:"",c.style.marginTop=p?p:"",c.style.width=b+"px",c.style.height=e+"px",g.style.width=q*b+2+"px",g.style.maxWidth=b+2+"px",g.style.height=a*e+2+"px",g.style.maxHeight=e+2+"px",g.style.left=l?l:"",g.style.top=h?h:m/2-e/2-1+"px"):d.width<d.height?(b*=d.width/d.height,c.style.marginLeft=n?n:"",c.style.marginTop=p?p:"",c.style.width=b+"px",c.style.height=e+
"px",g.style.width=q*b+2+"px",g.style.maxWidth=b+2+"px",g.style.height=a*e+2+"px",g.style.maxHeight=e+2+"px",g.style.top=h?h:"",g.style.left=l?l:f/2-b/2-1+"px"):(c.style.marginLeft=n?n:"",c.style.marginTop=p?p:"",c.style.width=b+"px",c.style.height=e+"px",g.style.width=q*b+2+"px",g.style.maxWidth=b+2+"px",g.style.height=a*e+2+"px",g.style.maxHeight=e+2+"px",g.style.top=h?h:"",g.style.left=l?l:"")},showHandles:function(){document.getElementById("cropImageContainer");var a=document.getElementById("cropImageHandles").getBoundingClientRect(),
b=document.getElementsByClassName("cropHandle");for(i=0;i<b.length;i++)b[i].style.display="block";document.getElementById("cropTopLeft").style.left=a.left-4-1+"px";document.getElementById("cropTopLeft").style.top=a.top-4-2+"px";document.getElementById("cropTopMid").style.left=a.left+a.width/2-4+"px";document.getElementById("cropTopMid").style.top=document.getElementById("cropTopLeft").style.top;document.getElementById("cropTopRight").style.left=a.right-4+1+"px";document.getElementById("cropTopRight").style.top=
document.getElementById("cropTopMid").style.top;b=document.getElementById("cropTopLeft").style.left;var c=document.getElementById("cropTopMid").style.left,d=document.getElementById("cropTopRight").style.left;document.getElementById("cropLeftMid").style.left=b;document.getElementById("cropLeftMid").style.top=a.top+a.height/2-4+1+"px";document.getElementById("cropRightMid").style.left=d;document.getElementById("cropRightMid").style.top=document.getElementById("cropLeftMid").style.top;document.getElementById("cropBotLeft").style.left=
b;document.getElementById("cropBotLeft").style.top=a.top+a.height-4+"px";document.getElementById("cropBotMid").style.left=c;document.getElementById("cropBotMid").style.top=document.getElementById("cropBotLeft").style.top;document.getElementById("cropBotRight").style.left=d;document.getElementById("cropBotRight").style.top=document.getElementById("cropBotLeft").style.top},addHandleEventListeners:function(){document.getElementById("cropTopLeft").addEventListener("mouseover",TRIANGLE.images.crop.XY);
document.getElementById("cropTopLeft").addEventListener("mousedown",TRIANGLE.images.crop.initiate);document.getElementById("cropTopMid").addEventListener("mouseover",TRIANGLE.images.crop.Y);document.getElementById("cropTopMid").addEventListener("mousedown",TRIANGLE.images.crop.initiate);document.getElementById("cropTopRight").addEventListener("mouseover",TRIANGLE.images.crop.XY);document.getElementById("cropTopRight").addEventListener("mousedown",TRIANGLE.images.crop.initiate);document.getElementById("cropLeftMid").addEventListener("mouseover",
TRIANGLE.images.crop.X);document.getElementById("cropLeftMid").addEventListener("mousedown",TRIANGLE.images.crop.initiate);document.getElementById("cropRightMid").addEventListener("mouseover",TRIANGLE.images.crop.X);document.getElementById("cropRightMid").addEventListener("mousedown",TRIANGLE.images.crop.initiate);document.getElementById("cropBotLeft").addEventListener("mouseover",TRIANGLE.images.crop.XY);document.getElementById("cropBotLeft").addEventListener("mousedown",TRIANGLE.images.crop.initiate);
document.getElementById("cropBotMid").addEventListener("mouseover",TRIANGLE.images.crop.Y);document.getElementById("cropBotMid").addEventListener("mousedown",TRIANGLE.images.crop.initiate);document.getElementById("cropBotRight").addEventListener("mouseover",TRIANGLE.images.crop.XY);document.getElementById("cropBotRight").addEventListener("mousedown",TRIANGLE.images.crop.initiate)},itemIndex:-1,direction:null,X:function(){TRIANGLE.images.crop.direction="X"},Y:function(){TRIANGLE.images.crop.direction=
"Y"},XY:function(){TRIANGLE.images.crop.direction="XY"},handleID:null,createBorder:function(){TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)&&(TRIANGLE.images.crop.active=!0,TRIANGLE.images.crop.itemIndex=TRIANGLE.item.index,TRIANGLE.images.crop.transferImage(),TRIANGLE.images.crop.toggleMenu(),TRIANGLE.images.crop.showHandles())},initiate:function(){document.body.addEventListener("mousemove",TRIANGLE.images.crop.start);document.body.addEventListener("mouseup",TRIANGLE.images.crop.stop);TRIANGLE.images.crop.handleID=
this.id},start:function(a){if(TRIANGLE.images.crop.active){TRIANGLE.images.crop.removeHandles();var b=a.clientX;a=a.clientY;var c=document.getElementById("cropImageContainer").getBoundingClientRect(),d=document.getElementById("cropImageHandles"),e=d.getBoundingClientRect(),g=d.children[0],f=g.getBoundingClientRect(),m=c.right-(504-f.width)/2+2,l=c.left+(504-f.width)/2-1,h=c.top+(504-f.height)/2-1;c=c.bottom-(504-f.height)/2+2;if("X"===TRIANGLE.images.crop.direction||"XY"===TRIANGLE.images.crop.direction)/Left/g.test(TRIANGLE.images.crop.handleID)?
b>l&&b<m-2?(d.style.width=e.right-b+"px",d.style.left=b+"px",g.style.marginLeft=l-b+"px"):b<l&&(d.style.width=e.right-l+"px",d.style.left=l+"px",g.style.marginLeft=""):b>l+2&&b<m?d.style.width=b-e.left+"px":b>m&&(d.style.width=m-e.left-1+"px");if("Y"===TRIANGLE.images.crop.direction||"XY"===TRIANGLE.images.crop.direction)/Top/g.test(TRIANGLE.images.crop.handleID)?a>h&&a<c-2?(d.style.height=e.bottom-a+"px",d.style.top=a+"px",g.style.marginTop=h-a+"px"):a<h&&(d.style.height=e.bottom-h+"px",d.style.top=
h+"px",g.style.marginTop=""):a>h+2&&a<c?d.style.height=a-e.top+"px":a>c&&(d.style.height=c-e.top-1+"px")}},stop:function(){document.body.removeEventListener("mousemove",TRIANGLE.images.crop.start);document.body.removeEventListener("mouseup",TRIANGLE.images.crop.stop);TRIANGLE.images.crop.showHandles()},cancel:function(){TRIANGLE.images.crop.active=!1;TRIANGLE.importItem.single(TRIANGLE.images.crop.itemIndex);TRIANGLE.images.crop.itemIndex=-1;TRIANGLE.images.crop.toggleMenu()},applyCrop:function(){document.getElementById("cropImageContainer").getBoundingClientRect();
var a=document.getElementById("cropImageHandles"),b=a.getBoundingClientRect(),c=a.children[0],d=c.getBoundingClientRect();a.getBoundingClientRect();TRIANGLE.selectItem(TRIANGLE.images.crop.itemIndex);var e=TRIANGLE.item.objRef.getBoundingClientRect();TRIANGLE.item.objRef.style.overflow="hidden";var g=d.width/(b.width-2)*100,f=(b.left+1-d.left)/(b.width-2)*100;.5>f&&(f=0);d=(b.top+1-d.top)/(b.width-2)*100;.5>d&&(d=0);TRIANGLE.item.objRef.setAttribute("crop-map",a.style.left+","+a.style.top+","+c.style.marginLeft+
","+c.style.marginTop);a=(b.width-2)/(b.height-2);TRIANGLE.item.objRef.setAttribute("crop-ratio",a);TRIANGLE.item.objRef.style.height=TRIANGLE.item.objRef.style.minHeight=Math.round(e.width/a)+"px";TRIANGLE.item.image.style.width=g+"%";TRIANGLE.item.image.style.height="auto";TRIANGLE.item.image.style.marginLeft=0<f?-1*f+"%":"";TRIANGLE.item.image.style.marginTop=0<d?-1*d+"%":"";TRIANGLE.images.crop.cancel();TRIANGLE.selectItem(TRIANGLE.item.index)},removeHandles:function(){var a=document.getElementsByClassName("cropHandle");
for(i=0;i<a.length;i++)a[i].style.display="none"}},autoSize:function(){if(TRIANGLE.item&&TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)){TRIANGLE.item.objRef.style.width="100%";if(TRIANGLE.item.cropRatio){var a=TRIANGLE.item.cropRatio,b=TRIANGLE.item.objRef.getBoundingClientRect().width;TRIANGLE.item.objRef.getBoundingClientRect();TRIANGLE.item.objRef.style.height=TRIANGLE.item.objRef.style.minHeight=Math.round(b/a)+"px"}else TRIANGLE.item.objRef.style.height="auto",TRIANGLE.item.objRef.style.minHeight=
"auto";TRIANGLE.item.image.width="100%";TRIANGLE.item.image.height="auto";TRIANGLE.selectionBorder.update();TRIANGLE.updateTemplateItems();TRIANGLE.importItem.single(TRIANGLE.item.index)}}};
TRIANGLE.library={load:function(){AJAX.get("scripts/libraryList.php","",function(a){document.getElementById("echoLibrary").innerHTML=a.responseText})},loadUserIDs:function(){AJAX.get("scripts/userIDlist.php","instance="+TRIANGLE.instance,function(a){document.getElementById("echoUserIDs").innerHTML=a.responseText})},loadUserClasses:function(){AJAX.get("scripts/userClassList.php","instance="+TRIANGLE.instance,function(a){document.getElementById("echoUserClasses").innerHTML=a.responseText})},insertTemplate:function(a){AJAX.get("scripts/insertPremadeTemplate.php",
"instance="+TRIANGLE.instance+"&templateName="+a,function(a){TRIANGLE.template.blank();a=TRIANGLE.json.decompress(a.responseText);TRIANGLE.json.decode(a);TRIANGLE.library.loadUserIDs();TRIANGLE.updateTemplateItems();TRIANGLE.loadTemplate.updateUserIDs();TRIANGLE.colors.updateBodyBg();TRIANGLE.dragDrop.updateItemMap();TRIANGLE.currentTemplate=TRIANGLE.currentPage=!1;setTimeout(TRIANGLE.updateTemplateItems,100)});TRIANGLE.updateTemplateItems()},insert:function(a,b){if(!TRIANGLE.item||!TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef)||
TRIANGLE.item.ecomParent){var c=!1;/ecommerce/i.test(a)&&(c=!0);var d="category="+encodeURIComponent(a)+"&name="+encodeURIComponent(b);AJAX.get("scripts/insertLibraryItem.php",d,function(a){a=a.responseText;c&&(TRIANGLE.item&&!TRIANGLE.item.searchParentTree("catalog")?a=TRIANGLE.ecommerce.catalogTag+a+"</div>":TRIANGLE.item||(a=TRIANGLE.ecommerce.catalogTag+a+"</div>"));TRIANGLE.item?TRIANGLE.item.ecomParent?TRIANGLE.item.ecomParent.parentNode.innerHTML=a+TRIANGLE.item.ecomParent.parentNode.innerHTML:
(TRIANGLE.checkPadding(TRIANGLE.item.objRef),TRIANGLE.item.objRef.innerHTML=a+TRIANGLE.item.objRef.innerHTML):(document.getElementById("template").innerHTML+=a,window.scrollTo(0,document.body.scrollHeight));TRIANGLE.library.convertStandbyItems();TRIANGLE.ecommerce.detectMyCart();setTimeout(function(){TRIANGLE.item&&TRIANGLE.importItem.single(TRIANGLE.item.index)},50);TRIANGLE.updateTemplateItems(!0)})}},convertStandbyItems:function(){var a=document.getElementById("template").getElementsByClassName("standby");
for(i=0;i<a.length;i++){var b=a[i].className.replace("standby","templateItem");a[i].className=b}},insertUserID:function(a){TRIANGLE.item&&TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef)||AJAX.get("scripts/insertUserID.php","instance="+TRIANGLE.instance+"&name="+a,function(b){b=TRIANGLE.json.toHTML(b.responseText);var c=TRIANGLE.getElementByUserId(a);TRIANGLE.item?(TRIANGLE.checkPadding(TRIANGLE.item.objRef),TRIANGLE.item.objRef.innerHTML+=b,c&&TRIANGLE.item.objRef.lastChild.removeAttribute("user-id")):
(document.getElementById("template").innerHTML+=b,c&&document.getElementById("template").lastChild.removeAttribute("user-id"),window.scrollTo(0,document.body.scrollHeight));setTimeout(TRIANGLE.selectionBorder.update,50);TRIANGLE.updateTemplateItems(!0)})},insertUserClass:function(a){TRIANGLE.item&&TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef)||AJAX.get("scripts/insertUserClass.php","instance="+TRIANGLE.instance+"&name="+a,function(b){console.log(b.responseText);b=JSON.parse(b.responseText);
var c=document.createElement("div");c.setAttribute("user-class",a);c.style.cssText=b[a];c.className="templateItem";TRIANGLE.item?(TRIANGLE.item.append(c),setTimeout(TRIANGLE.selectionBorder.update,50)):(document.getElementById("template").appendChild(c),window.scrollTo(0,document.body.scrollHeight));TRIANGLE.updateTemplateItems(!0)})},removeDuplicateUserIDs:function removeDuplicate(a){if(!/\w+/g.test(a))return a;var c=TRIANGLE.getElementByUserId(a);if(!c){var d=document.getElementById("echoUserIDs");
for(i=0;i<d.children.length&&(c=d.children[i].innerHTML,a!==c);i++)c=!1}c&&c!=TRIANGLE.item.objRef&&(c="1",""!==a.replace(/\D+/g,"")&&/\d+/g.test(a.replace(/\D+/g,""))&&(c=parseInt(a.replace(/\D+/g,"")),c++),a=a.replace(/\d+/g,"")+c.toString(),TRIANGLE.getElementByUserId(a)?removeDuplicate(a):document.getElementById("userID").value=a);return a},previewItem:function(a){TRIANGLE.updateTemplateItems();a=document.getElementById("library"+a);TRIANGLE.effects.hover.transferStyles(a.children[0]);var b=window.open();
b.document.write('<title>Preview Library Item</title><link rel="stylesheet" href="index-style.css" type="text/css" media="screen"><style>*{cursor:auto}.templateItem{cursor:auto}.textBox a{pointer-events:auto}'+document.getElementById("hoverData").innerHTML+"</style>"+a.innerHTML);b.document.body.style.backgroundColor=document.body.style.backgroundColor;a=b.document.getElementsByClassName("templateItem");for(i=0;i<a.length;i++)a[i].getAttribute("hover-style")&&a[i].removeAttribute("style")}};
TRIANGLE.ecommerce={setDescription:function(){TRIANGLE.item&&TRIANGLE.saveItem.applyChanges()},catalogTag:'<div class="templateItem catalog" style="height:auto;min-height:100px;width:100%;background-color:inherit;border:1px solid #333;padding:10px;">',createMyCartBtn:function(){var a=document.createElement("div");a.className="templateItem childItem textBox myCartBtn";a.innerHTML='<a href="cart.php">My Cart</a>';a.style.width="150px";a.style.height="auto";a.style.minHeight="auto";a.style.display="block";
a.style.padding="8px";a.style.backgroundColor="black";a.style.marginBottom="10px";a.style.marginLeft="auto";a.style.color="white";a.style.boxShadow="0px 1px 2px gray";a.style.fontSize="14px";a.style.fontFamily="Arial";a.style.textAlign="center";a.setAttribute("hover-style","background-color:#333333;");return a},detectMyCart:function(){var a=document.getElementById("template").getElementsByClassName("catalog");if(a[0]&&a[0].children[0]&&!TRIANGLE.isType.myCartBtn(a[0].children[0])){for(var b=document.getElementById("template").getElementsByClassName("myCartBtn");0<
b.length;){for(i=0;i<b.length;i++)b[i].remove();b=document.getElementById("template").getElementsByClassName("myCartBtn")}b=TRIANGLE.ecommerce.createMyCartBtn();a[0].insertBefore(b,a[0].children[0])}},updateItemIDs:function(){var a=document.getElementById("template").querySelectorAll(".ecommerceItem[replace-ecom-id]");a[0]&&(TRIANGLE.ecommerce.setItemID(a[0],TRIANGLE.ecommerce.assignItemID()),a[0].removeAttribute("replace-ecom-id"))},setItemID:function(a,b){if(a&&a.getAttribute("ecommerce")){var c=
a.getAttribute("ecommerce");c=JSON.parse(c);c.itemID=b;c=JSON.stringify(c);a.setAttribute("ecommerce",c)}},assignItemID:function(){for(var a=document.getElementById("template").getElementsByClassName("ecommerceItem").length;-1<TRIANGLE.ecomItems.indexOf(a);)a++;TRIANGLE.ecomItems.push(a);for(a=a.toString();6>a.length;)a="0"+a;return a},formatItemID:function(a){if(a&&!isNaN(a)&&-1===TRIANGLE.ecomItems.indexOf(parseInt(a))){a=parseInt(a);for(a=a.toString();6>a.length;)a="0"+a;return a}parseInt(a)!==
parseInt(TRIANGLE.item.ecom.itemID)&&(a=TRIANGLE.ecommerce.assignItemID(),document.getElementById("ecomItemID").value=a);return a},formatPercent:function(a){return a&&!isNaN(a)?parseFloat(a)/100:""},formatCurrency:function(a){return a&&!isNaN(a)?parseFloat(a).toFixed(2):""},generateCartPage:function(){var a=!0;if(0<document.getElementById("template").querySelectorAll(".catalog").length){TRIANGLE.pages.loadPages();var b=document.getElementById("echoPageList").getElementsByClassName("pageThumbnail");
for(i=0;i<b.length;i++)"cart"==b[i].innerHTML&&(a=!1)}if(a)if(b=document.getElementById("templateWrapper").innerHTML,a=document.getElementById("template").querySelector(".catalog")){a.innerHTML="%CART%";for(a.className=a.className.replace(/catalog/g,"cart snippetItem");"template"!=a.id;)a.removeAttribute("user-id"),a=a.parentNode;for(a=document.getElementById("template").querySelectorAll(".catalog");0<a.length;)a[0].remove(),a=document.getElementById("template").querySelectorAll(".catalog");a=TRIANGLE.json.encode();
a=encodeURIComponent(a);document.getElementById("templateWrapper").innerHTML=b}else a="";else a="";return a},logEcomItems:function(){var a={},b=document.getElementById("template").getElementsByClassName("ecommerceItem");for(i=0;i<b.length;i++){var c=b[i].getAttribute("index");TRIANGLE.sv_item=new TRIANGLE.TemplateItem(c);a[TRIANGLE.sv_item.ecom.itemID]=TRIANGLE.sv_item.ecom}return JSON.stringify(a)},shipping:{settings:{type:null,handling:null,per:null,fee:null},loadSetup:function(a){var b=document.getElementsByName("shippingTypeRadio"),
c=document.getElementById("USPSdropdowns"),d=document.getElementById("askHandling"),e=document.getElementsByName("askHandlingRadio"),g=document.getElementById("askPerOrder"),f=document.getElementsByName("askPerOrderRadio"),m=document.getElementById("getPerOrderFee"),l=document.getElementById("handlingFee"),h=document.getElementById("getCustomFee"),n=document.getElementById("customFee"),p=document.getElementById("shippingFeeLabel"),q=document.getElementById("ecomShipping");b[0].checked=!1;b[1].checked=
!1;e[0].checked=!1;e[1].checked=!1;f[0].checked=!1;f[1].checked=!1;l.value="";n.value="";c.style.display="none";d.style.display="none";g.style.display="none";m.style.display="none";h.style.display="none";p.innerHTML="";q.style.display="none";"auto"===a.type?(b[0].checked=!0,c.style.display="block",d.style.display="block","yes"===a.handling?(e[0].checked=!0,g.style.display="block","order"===a.per?(f[0].checked=!0,m.style.display="block",isNaN(a.fee)||(l.value=a.fee)):"item"===a.per&&(f[1].checked=
!0,p.innerHTML="Handling: ",q.style.display="")):"no"===a.handling&&(e[1].checked=!0)):"custom"===a.type&&(b[1].checked=!0,h.style.display="",isNaN(a.fee)||(n.value=a.fee))},setup:function(){TRIANGLE.ecommerce.shipping.loadSetup(TRIANGLE.ecommerce.shipping.settings);TRIANGLE.popUp.open("shippingCell")},type:function(a){"auto"===a.value?(document.getElementById("USPSdropdowns").style.display="block",document.getElementById("askHandling").style.display="block",TRIANGLE.ecommerce.shipping.settings.type=
"auto",document.getElementById("shippingFeeLabel").innerHTML="",document.getElementById("ecomShipping").style.display="none",document.getElementById("getCustomFee").style.display="none"):(document.getElementById("USPSdropdowns").style.display="none",document.getElementById("askHandling").style.display="none",TRIANGLE.ecommerce.shipping.settings.type="custom",document.getElementById("shippingFeeLabel").innerHTML="",document.getElementById("ecomShipping").style.display="none",document.getElementById("getCustomFee").style.display=
"")},handling:function(a){"yes"===a.value?(document.getElementById("askPerOrder").style.display="block",TRIANGLE.ecommerce.shipping.settings.handling="yes"):(document.getElementById("askPerOrder").style.display="none",TRIANGLE.ecommerce.shipping.settings.handling="no")},perOrderItem:function(a){"order"===a.value?(document.getElementById("getPerOrderFee").style.display="block",TRIANGLE.ecommerce.shipping.settings.per="order",document.getElementById("shippingFeeLabel").innerHTML="",document.getElementById("ecomShipping").style.display=
"none"):(document.getElementById("getPerOrderFee").style.display="none",TRIANGLE.ecommerce.shipping.settings.per="item",document.getElementById("shippingFeeLabel").innerHTML="Handling: ",document.getElementById("ecomShipping").style.display="")},cancelSetup:function(){TRIANGLE.ecommerce.shipping.settings=TRIANGLE.savedShippingSetup;TRIANGLE.popUp.close()},applySetup:function(){"auto"===TRIANGLE.ecommerce.shipping.settings.type?TRIANGLE.ecommerce.shipping.settings.fee=parseFloat(document.getElementById("handlingFee").value):
"custom"===TRIANGLE.ecommerce.shipping.settings.type&&(TRIANGLE.ecommerce.shipping.settings.fee=parseFloat(document.getElementById("customFee").value));TRIANGLE.popUp.close()},USPSflatRate:function(){TRIANGLE.item&&TRIANGLE.item.ecomParent?TRIANGLE.popUp.open("USPSflatRateCell"):TRIANGLE.error("Please select an ecommerce item to apply this feature")},flatRateSelect:function(){0<document.getElementById("USPSflatRateSelect").selectedIndex&&(document.getElementById("USPSshapeSelect").selectedIndex=0)},
USPSother:function(){TRIANGLE.item&&TRIANGLE.item.ecomParent?TRIANGLE.popUp.open("USPSotherOptionsCell"):TRIANGLE.error("Please select an ecommerce item to apply this feature")},askWeight:function(){var a=document.getElementById("USPSshapeSelect");0<a.selectedIndex&&(document.getElementById("USPSflatRateSelect").selectedIndex=0);0<a.selectedIndex?(document.getElementById("USPSweight").style.display="block",5===a.selectedIndex?document.getElementById("USPSdimensions").style.display="block":document.getElementById("USPSdimensions").style.display=
"none"):(document.getElementById("USPSweight").style.display="none",document.getElementById("USPSdimensions").style.display="none")},applyUSPS:function(){TRIANGLE.item&&TRIANGLE.item.ecomParent?(TRIANGLE.saveItem.saveEcomData(),TRIANGLE.popUp.close()):TRIANGLE.error("Please select an ecommerce item to apply this feature.")}}};
TRIANGLE.developer={insertSnippet:function(){var a=document.getElementById("snippetInsertion").value;if(a&&/[^\s]+/g.test(a))if(TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef))TRIANGLE.item.objRef.innerHTML=a;else{var b=document.createElement("div");b.className="templateItem childItem snippetItem";b.style.backgroundColor="inherit";b.style.minHeight="1px";b.style.height="auto";b.innerHTML=a;TRIANGLE.item?TRIANGLE.item.append(b):document.getElementById("template").appendChild(b);TRIANGLE.selectionBorder.update();
TRIANGLE.updateTemplateItems(!0)}},handleTabs:function(a,b){if(9===b.keyCode){var c=a.selectionStart,d=a.selectionEnd,e=a.value;a.value=e.substring(0,c)+"    "+e.substring(d);a.selectionStart=a.selectionEnd=c+4;b.preventDefault()}},saveEdits:null,currentCode:null,editCode:function(a,b){TRIANGLE.developer.currentCode=a;var c=document.getElementById(a),d=document.getElementById("codeEditor");document.getElementById("currentCode").innerHTML="Currently Editing: "+b;d.value=c.value;document.getElementById("codeEditorWrapper").style.display=
"block";TRIANGLE.developer.saveEdits=function(){document.getElementById(a).value=d.value;document.getElementById(a).onchange()};document.getElementById("marginFix").style.height=d.parentElement.getBoundingClientRect().height+170+"px";TRIANGLE.selectionBorder.update()},exitCodeEditor:function(){var a=document.getElementById(TRIANGLE.developer.currentCode),b=document.getElementById("codeEditor");document.getElementById("codeEditorWrapper").style.display="none";a.value=b.value;b.value="";TRIANGLE.developer.saveEdits=
null;TRIANGLE.developer.currentCode=null;document.getElementById("marginFix").style.height="170px";TRIANGLE.selectionBorder.update()},styleTagContent:"",globalStyleTagContent:"",scriptTagContent:"",globalScriptTagContent:"",saveStyleTag:function(a){TRIANGLE.developer.styleTagContent=a},saveGlobalStyleTag:function(a){TRIANGLE.developer.globalStyleTagContent=a},saveScriptTag:function(a){TRIANGLE.developer.scriptTagContent=a},saveGlobalScriptTag:function(a){TRIANGLE.developer.globalScriptTagContent=
a}};
TRIANGLE.colors={setColorBoxEvents:function(){document.getElementById("colorMainBg").addEventListener("click",function(){TRIANGLE.colors.fillCanvas(this.style.backgroundColor);TRIANGLE.colors.showCanvasMenu(this,function(){document.body.style.backgroundColor=TRIANGLE.colors.canvasColorChoice;document.getElementById("bodyBgData").style.backgroundColor=TRIANGLE.colors.canvasColorChoice});TRIANGLE.colors.canvasPaletteTarget="bodyBg"});document.getElementById("colorElementBg").addEventListener("click",function(){TRIANGLE.colors.fillCanvas(this.style.backgroundColor);
TRIANGLE.colors.showCanvasMenu(this,function(){TRIANGLE.saveItem.createAnimation("background-color",TRIANGLE.item.bgColor,TRIANGLE.colors.canvasColorChoice,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)});TRIANGLE.item.objRef.style.backgroundColor=TRIANGLE.colors.canvasColorChoice});TRIANGLE.colors.canvasPaletteTarget="backgroundColor"});document.getElementById("colorListBorderL").addEventListener("click",function(){TRIANGLE.colors.fillCanvas(this.style.backgroundColor);TRIANGLE.colors.showCanvasMenu(this,
function(){TRIANGLE.saveItem.createAnimation("border-left-color",TRIANGLE.item.borderLeftColor,TRIANGLE.colors.canvasColorChoice,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)});TRIANGLE.item.objRef.style.borderLeftColor=TRIANGLE.colors.canvasColorChoice;TRIANGLE.importItem.single(TRIANGLE.item.index)});TRIANGLE.colors.canvasPaletteTarget="borderLeftColor"});document.getElementById("colorListBorderR").addEventListener("click",function(){TRIANGLE.colors.fillCanvas(this.style.backgroundColor);
TRIANGLE.colors.showCanvasMenu(this,function(){TRIANGLE.saveItem.createAnimation("border-right-color",TRIANGLE.item.borderRightColor,TRIANGLE.colors.canvasColorChoice,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)});TRIANGLE.item.objRef.style.borderRightColor=TRIANGLE.colors.canvasColorChoice;TRIANGLE.importItem.single(TRIANGLE.item.index)});TRIANGLE.colors.canvasPaletteTarget="borderRightColor"});document.getElementById("colorListBorderT").addEventListener("click",function(){TRIANGLE.colors.fillCanvas(this.style.backgroundColor);
TRIANGLE.colors.showCanvasMenu(this,function(){TRIANGLE.saveItem.createAnimation("border-top-color",TRIANGLE.item.borderTopColor,TRIANGLE.colors.canvasColorChoice,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)});TRIANGLE.item.objRef.style.borderTopColor=TRIANGLE.colors.canvasColorChoice;TRIANGLE.importItem.single(TRIANGLE.item.index)});TRIANGLE.colors.canvasPaletteTarget="borderTopColor"});document.getElementById("colorListBorderB").addEventListener("click",function(){TRIANGLE.colors.fillCanvas(this.style.backgroundColor);
TRIANGLE.colors.showCanvasMenu(this,function(){TRIANGLE.saveItem.createAnimation("border-bottom-color",TRIANGLE.item.borderBottomColor,TRIANGLE.colors.canvasColorChoice,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)});TRIANGLE.item.objRef.style.borderBottomColor=TRIANGLE.colors.canvasColorChoice;TRIANGLE.importItem.single(TRIANGLE.item.index)});TRIANGLE.colors.canvasPaletteTarget="borderBottomColor"});document.getElementById("colorBoxShadow").addEventListener("click",function(){TRIANGLE.colors.fillCanvas(TRIANGLE.colors.getBoxShadowColor(TRIANGLE.item.objRef));
TRIANGLE.colors.showCanvasMenu(this,function(){var a=document.getElementById("boxShadowH"),b=document.getElementById("boxShadowV"),c=document.getElementById("boxShadowBlur");document.getElementById("boxShadowColor");0==parseInt(a.value)&&0==parseInt(b.value)&&0==parseInt(c.value)||""==a.value&&""==b.value&&""==c.value?(TRIANGLE.saveItem.createAnimation("box-shadow",TRIANGLE.item.boxShadow,"",function(){TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.item.objRef.style.boxShadow=""):(a=parseInt(a.value)+
"px "+parseInt(b.value)+"px "+parseInt(c.value)+"px "+TRIANGLE.colors.canvasColorChoice,TRIANGLE.saveItem.createAnimation("box-shadow",TRIANGLE.item.boxShadow,a,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)}),TRIANGLE.item.objRef.style.boxShadow=a)});TRIANGLE.colors.canvasPaletteTarget="boxShadow"});document.getElementById("colorFont").addEventListener("click",function(){TRIANGLE.colors.showCanvasMenu(this,function(){TRIANGLE.saveItem.createAnimation("color",TRIANGLE.item.fontColor,TRIANGLE.colors.canvasColorChoice,
function(){TRIANGLE.importItem.single(TRIANGLE.item.index)});TRIANGLE.item.objRef.style.color=TRIANGLE.colors.canvasColorChoice});TRIANGLE.colors.canvasPaletteTarget="color"});document.getElementById("canvasBlack").addEventListener("mouseover",function(){document.getElementById("canvasPreviewColor").style.backgroundColor="black"});document.getElementById("canvasWhite").addEventListener("mouseover",function(){document.getElementById("canvasPreviewColor").style.backgroundColor="white"})},objectReference:"",
styleCallback:null,canvasColorChoice:document.getElementById("canvasColorChoice").style.backgroundColor,showCanvasMenu:function(a,b){TRIANGLE.colors.objectReference=a;var c=document.getElementById("canvasWrapper"),d=a.getBoundingClientRect();TRIANGLE.colors.styleCallback=b;c.style.top=d.bottom+"px";c.style.left=d.left+"px";c.style.display="inline-block"},applyCanvasColor:function(){TRIANGLE.colors.objectReference.style.backgroundColor=TRIANGLE.colors.canvasColorChoice;TRIANGLE.colors.styleCallback&&
"function"==typeof TRIANGLE.colors.styleCallback&&TRIANGLE.colors.styleCallback();TRIANGLE.colors.cancelCanvasMenu();TRIANGLE.saveItem.equalizeUserClasses(TRIANGLE.item.userClass)},cancelCanvasMenu:function(){document.getElementById("canvasPalette").style.display="none";document.getElementById("canvasWrapper").style.display="none"},fillCanvas:function(a){"inherit"!==a&&a||(a="white");document.getElementById("canvasCrosshair").style.top="8px";document.getElementById("canvasCrosshair").style.left="202px";
document.getElementById("saturationMarker").style.top="207px";TRIANGLE.colors.canvasColorChoice=a;document.getElementById("canvasPreviewColor").style.backgroundColor=a;document.getElementById("canvasColorChoice").style.backgroundColor=a;var b=document.getElementById("canvasHueBar"),c=document.getElementById("canvasSaturationBar"),d=document.getElementById("canvasColorMenu");if(b.getContext){b.addEventListener("mousemove",TRIANGLE.colors.canvasPreviewColor);b.addEventListener("click",TRIANGLE.colors.canvasChooseColor);
c.addEventListener("mousemove",TRIANGLE.colors.canvasPreviewColor);c.addEventListener("click",TRIANGLE.colors.canvasChooseColor);d.addEventListener("mousemove",TRIANGLE.colors.canvasPreviewColor);d.addEventListener("click",TRIANGLE.colors.canvasChooseColor);b=b.getContext("2d");var e=b.createLinearGradient(0,0,20,200);e.addColorStop(0,"red");e.addColorStop(.2,"orange");e.addColorStop(.4,"yellow");e.addColorStop(.6,"green");e.addColorStop(.8,"blue");e.addColorStop(1,"purple");b.fillStyle=e;b.fillRect(0,
0,20,200);c=c.getContext("2d");b=c.createLinearGradient(0,0,20,200);b.addColorStop(0,"#ffffff");b.addColorStop(1,a);c.fillStyle=b;c.fillRect(0,0,20,200);d=d.getContext("2d");c=d.createLinearGradient(0,200,200,0);c.addColorStop(0,"#000000");c.addColorStop(1,a);d.fillStyle=c;d.fillRect(0,0,200,200)}},canvasPreviewColor:function(a){var b=this.getBoundingClientRect(),c=a.clientX-b.left;a=a.clientY-b.top;c=this.getContext("2d").getImageData(c,a,1,1).data;c="#"+("000000"+TRIANGLE.colors.convertCanvasData(c)).slice(-6);
document.getElementById("canvasPreviewColor").style.backgroundColor=c},canvasChooseColor:function(a){var b=this.getBoundingClientRect(),c=a.clientX-b.left,d=a.clientY-b.top;a=this.getContext("2d");b=a.getImageData(c,d,1,1).data;b="#"+("000000"+TRIANGLE.colors.convertCanvasData(b)).slice(-6);TRIANGLE.colors.canvasColorChoice=b;document.getElementById("canvasColorChoice").style.backgroundColor=b;"canvasColorMenu"==this.getAttribute("id")?(document.getElementById("canvasCrosshair").style.left=c+5+"px",
document.getElementById("canvasCrosshair").style.top=d+5+"px",a=document.getElementById("canvasSaturationBar").getContext("2d"),c=a.createLinearGradient(0,0,20,200),c.addColorStop(0,"#ffffff"),c.addColorStop(1,b),a.fillStyle=c,a.fillRect(0,0,20,200),document.getElementById("saturationMarker").style.top="207px"):"canvasSaturationBar"==this.getAttribute("id")?document.getElementById("saturationMarker").style.top=d+8+"px":"canvasHueBar"==this.getAttribute("id")&&TRIANGLE.colors.fillCanvas(b)},canvasPaletteTarget:null,
toggleCanvasPalette:function(){var a=document.getElementById("canvasPalette");if("none"===a.style.display){a.innerHTML="";TRIANGLE.colors.createPalette(!0,!0);var b=document.getElementById("colorPalette").getElementsByClassName("colorPaletteItem");for(i=0;i<b.length;i++){var c=b[i].cloneNode(!0);c.setAttribute("onClick","TRIANGLE.colors.fillCanvas(this.style.backgroundColor)");a.appendChild(c);0===(i+1)%10&&(a.innerHTML+="<br>")}a.style.display="block"}else a.style.display="none"},applyCanvasPaletteColor:function(a){var b=
TRIANGLE.colors.canvasPaletteTarget;a=a.style.backgroundColor;"bodyBg"===b?(document.body.style.backgroundColor=a,document.getElementById("bodyBgData").style.backgroundColor=a):"boxShadow"===b?(b=TRIANGLE.item.boxShadow.split(" "),isNaN(parseFloat(b[0]))?(b[0]=a,TRIANGLE.item.objRef.style.boxShadow=b.join(" ")):isNaN(parseFloat(b[1]))?(b[1]=a,TRIANGLE.item.objRef.style.boxShadow=b.join(" ")):isNaN(parseFloat(b[2]))?(b[2]=a,TRIANGLE.item.objRef.style.boxShadow=b.join(" ")):isNaN(parseFloat(b[3]))&&
(b[3]=a,TRIANGLE.item.objRef.style.boxShadow=b.join(" "))):TRIANGLE.item.objRef.style[b]=a;TRIANGLE.saveItem.equalizeUserClasses(TRIANGLE.item.userClass)},convertCanvasData:function(a){return(a[0]<<16|a[1]<<8|a[2]).toString(16)},colorDropIndex:-1,colorDropper:function(){if(TRIANGLE.item){TRIANGLE.colors.colorDropIndex=TRIANGLE.item.index;for(i=0;i<TRIANGLE.templateItems.length;i++)TRIANGLE.isType.imageItem(TRIANGLE.templateItems[i])||TRIANGLE.templateItems[i].addEventListener("mousedown",TRIANGLE.colors.colorDropChoose),
TRIANGLE.templateItems[i].style.cursor="crosshair";var a=document.getElementsByClassName("colorPaletteItem");for(i=0;i<a.length;i++)a[i].addEventListener("mousedown",TRIANGLE.colors.colorDropChoose),a[i].style.cursor="crosshair";document.getElementById("colorDropper").style.cursor="crosshair"}},colorDropChoose:function(){"inherit"===this.style.backgroundColor?document.getElementById("item"+TRIANGLE.colors.colorDropIndex).style.backgroundColor=this.parentNode.style.backgroundColor:document.getElementById("item"+
TRIANGLE.colors.colorDropIndex).style.backgroundColor=this.style.backgroundColor;for(i=0;i<TRIANGLE.templateItems.length;i++)TRIANGLE.templateItems[i].removeEventListener("mousedown",TRIANGLE.colors.colorDropChoose),TRIANGLE.templateItems[i].style.cursor="";var a=document.getElementsByClassName("colorPaletteItem");for(i=0;i<a.length;i++)a[i].removeEventListener("mousedown",TRIANGLE.colors.colorDropChoose),a[i].style.cursor="";document.getElementById("colorDropper").style.cursor="";TRIANGLE.importItem.single(TRIANGLE.colors.colorDropIndex);
TRIANGLE.colors.colorDropIndex=-1;TRIANGLE.selectionBorder.update()},cancelColorDropper:function(){for(i=0;i<TRIANGLE.templateItems.length;i++)TRIANGLE.templateItems[i].removeEventListener("mousedown",TRIANGLE.colors.colorDropChoose),TRIANGLE.templateItems[i].style.cursor="";document.getElementById("colorDropper").style.cursor="";TRIANGLE.colors.colorDropIndex=-1},createPalette:function(a,b){function c(a,b){if(a&&"inherit"!=a&&-1===e[b].indexOf(a)){e[b][j]=a;var c=e[b][j],d=document.createElement("div");
d.className="colorPaletteItem";d.style.backgroundColor=c;document.getElementById(b).appendChild(d,document.getElementById("paletteFloat"));j++}}document.getElementById("paletteItemsBg").innerHTML="";document.getElementById("paletteItemsFont").innerHTML="";document.getElementById("paletteItemsBorder").innerHTML="";document.getElementById("paletteItemsShadow").innerHTML="";var d=document.getElementById("colorPalette"),e={paletteItemsBg:[],paletteItemsFont:[],paletteItemsBorder:[],paletteItemsShadow:[]};
for(i=0;i<TRIANGLE.templateItems.length;i++){c(document.body.style.backgroundColor,"paletteItemsBg");c(TRIANGLE.templateItems[i].style.backgroundColor,"paletteItemsBg");c(TRIANGLE.templateItems[i].style.color,"paletteItemsFont");c(TRIANGLE.templateItems[i].style.borderLeftColor,"paletteItemsBorder");c(TRIANGLE.templateItems[i].style.borderRightColor,"paletteItemsBorder");c(TRIANGLE.templateItems[i].style.borderTopColor,"paletteItemsBorder");c(TRIANGLE.templateItems[i].style.borderBottomColor,"paletteItemsBorder");
var g=TRIANGLE.templateItems[i].style.boxShadow;g=g.replace(/rgb\((\d+), (\d+), (\d+)\)/g,"rgb($1,$2,$3)");g=g.split(" ");isNaN(parseFloat(g[0]))?c(g[0],"paletteItemsShadow"):isNaN(parseFloat(g[1]))?c(g[1],"paletteItemsShadow"):isNaN(parseFloat(g[2]))?c(g[2],"paletteItemsShadow"):isNaN(parseFloat(g[3]))&&c(g[3],"paletteItemsShadow")}(function(){var a=document.getElementById("paletteItemsBg").getElementsByClassName("colorPaletteItem");for(i=0;i<a.length;i++)a[i].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'backgroundColor')");
a=document.getElementById("paletteItemsFont").getElementsByClassName("colorPaletteItem");for(i=0;i<a.length;i++)a[i].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'color')");a=document.getElementById("paletteItemsBorder").getElementsByClassName("colorPaletteItem");for(i=0;i<a.length;i++)a[i].setAttribute("onMouseOver","TRIANGLE.colors.askBorderSide(this);"),a[i].setAttribute("onMouseOut","document.getElementById('askBorderSide').style.display = 'none';");a=document.getElementById("paletteItemsShadow").getElementsByClassName("colorPaletteItem");
for(i=0;i<a.length;i++)a[i].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'shadow')")})();""!==document.getElementById("paletteItemsBg").innerHTML&&(document.getElementById("paletteItemsBg").innerHTML="Background<br><hr>"+document.getElementById("paletteItemsBg").innerHTML+"<div class='clear'></div><hr>");""!==document.getElementById("paletteItemsFont").innerHTML&&(document.getElementById("paletteItemsFont").innerHTML="Font<br><hr>"+document.getElementById("paletteItemsFont").innerHTML+
"<div class='clear'></div><hr>");""!==document.getElementById("paletteItemsBorder").innerHTML&&(document.getElementById("paletteItemsBorder").innerHTML="Border<br><hr>"+document.getElementById("paletteItemsBorder").innerHTML+"<div class='clear'></div><hr>");""!==document.getElementById("paletteItemsShadow").innerHTML&&(document.getElementById("paletteItemsShadow").innerHTML="Box Shadow<br><hr>"+document.getElementById("paletteItemsShadow").innerHTML+"<div class='clear'></div><hr>");a||(d.style.display=
"block");b||(d.style.left=document.getElementById("createPalette").getBoundingClientRect().left+"px",d.style.top=document.getElementById("createPalette").getBoundingClientRect().bottom+12+"px");0===TRIANGLE.templateItems.length&&(document.getElementById("paletteItemsBg").innerHTML="No colors to display")},closePalette:function(){document.getElementById("colorPalette").style.display="none"},askBorderColorChoice:null,askBorderSide:function(a){var b=document.getElementById("askBorderSide");TRIANGLE.colors.askBorderColorChoice=
a.style.backgroundColor;b.style.left=a.getBoundingClientRect().left+"px";b.style.top=a.getBoundingClientRect().bottom+"px";b.children[0].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'border', 'left');");b.children[1].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'border', 'right');");b.children[2].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'border', 'top');");b.children[3].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'border', 'bottom');");
b.children[4].setAttribute("onClick","TRIANGLE.colors.applyPaletteColor(this, 'border', 'all');");b.style.display="block"},applyPaletteColor:function(a,b,c){if(TRIANGLE.item){a=a.style.backgroundColor;if("border"==b&&c){if("left"==c||"all"==c)TRIANGLE.item.borderLeft?TRIANGLE.item.objRef.style.borderLeftColor=TRIANGLE.colors.askBorderColorChoice:TRIANGLE.item.objRef.style.borderLeft="2px solid "+TRIANGLE.colors.askBorderColorChoice;if("right"==c||"all"==c)TRIANGLE.item.borderRight?TRIANGLE.item.objRef.style.borderRightColor=
TRIANGLE.colors.askBorderColorChoice:TRIANGLE.item.objRef.style.borderRight="2px solid "+TRIANGLE.colors.askBorderColorChoice;if("top"==c||"all"==c)TRIANGLE.item.borderTop?TRIANGLE.item.objRef.style.borderTopColor=TRIANGLE.colors.askBorderColorChoice:TRIANGLE.item.objRef.style.borderTop="2px solid "+TRIANGLE.colors.askBorderColorChoice;if("bottom"==c||"all"==c)TRIANGLE.item.borderBottom?TRIANGLE.item.objRef.style.borderBottomColor=TRIANGLE.colors.askBorderColorChoice:TRIANGLE.item.objRef.style.borderBottom=
"2px solid "+TRIANGLE.colors.askBorderColorChoice}else"shadow"==b?TRIANGLE.colors.setBoxShadowColor(TRIANGLE.item.objRef,a):TRIANGLE.item.objRef.style[b]=a;TRIANGLE.importItem.single(TRIANGLE.item.index);TRIANGLE.saveItem.equalizeUserClasses(TRIANGLE.item.userClass)}},dragPalette:{xInitial:null,yInitial:null,active:!1,initiate:function(a){var b=document.getElementById("colorPalette");TRIANGLE.colors.dragPalette.active=!0;document.addEventListener("mousemove",TRIANGLE.colors.dragPalette.start);document.addEventListener("mouseup",
TRIANGLE.colors.dragPalette.stop);TRIANGLE.colors.dragPalette.xInitial=a.clientX-b.getBoundingClientRect().left;TRIANGLE.colors.dragPalette.yInitial=a.clientY-b.getBoundingClientRect().top},start:function(a){if(TRIANGLE.colors.dragPalette.active){var b=document.getElementById("colorPalette");b.getBoundingClientRect();b.style.left=a.clientX-TRIANGLE.colors.dragPalette.xInitial+"px";b.style.top=a.clientY-TRIANGLE.colors.dragPalette.yInitial+"px"}},stop:function(){TRIANGLE.colors.dragPalette.active=
!1;document.removeEventListener("mousemove",TRIANGLE.colors.dragPalette.start);document.removeEventListener("mouseup",TRIANGLE.colors.dragPalette.stop)}},getBoxShadowColor:function(a){a=a.style.boxShadow;a=a.replace(/rgb\((\d+), (\d+), (\d+)\)/g,"rgb($1,$2,$3)");a=a.split(" ");if(isNaN(parseFloat(a[0])))return a[0];if(isNaN(parseFloat(a[1])))return a[1];if(isNaN(parseFloat(a[2])))return a[2];if(isNaN(parseFloat(a[3])))return a[3]},setBoxShadowColor:function(a,b){var c=a.style.boxShadow;""===c?a.style.boxShadow=
"5px 5px 5px "+b:(c=c.replace(/rgb\((\d+), (\d+), (\d+)\)/g,"rgb($1,$2,$3)"),c=c.split(" "),isNaN(parseFloat(c[0]))?(c[0]=b,a.style.boxShadow=c.join(" ")):isNaN(parseFloat(c[1]))?(c[1]=b,a.style.boxShadow=c.join(" ")):isNaN(parseFloat(c[2]))?(c[2]=b,a.style.boxShadow=c.join(" ")):isNaN(parseFloat(c[3]))&&(c[3]=b,a.style.boxShadow=c.join(" ")))},rgbToHex:function(a){if(/rgb/.test(a)){var b=a.replace(/[^\d,]/g,"").split(",");a=parseInt(b[0]);var c=parseInt(b[1]);b=parseInt(b[2]);return"#"+(16777216+
(a<<16)+(c<<8)+b).toString(16).slice(1)}return a},hexToRgb:function(a){return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},updateBodyBg:function(){document.body.style.backgroundColor=document.getElementById("bodyBgData").style.backgroundColor;document.body.style.backgroundImage=document.getElementById("bodyBgData").style.backgroundImage;document.getElementById("colorMainBg").style.backgroundColor=document.getElementById("bodyBgData").style.backgroundColor},
oppositeColor:function(a){a=a.replace(/#/g,"");return"#"+("000000"+(16777215^"0x"+a).toString(16)).slice(-6)}};
TRIANGLE.text={insertTextBox:function(a){var b=document.createElement("div");b.style.backgroundColor="inherit";b.style.height="auto";b.style.width="100%";b.style.fontSize="14px";b.style.lineHeight=1;b.style.fontFamily="Arial";b.className="templateItem textBox";b.innerHTML=a?a:"New text box";TRIANGLE.item&&!TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef)?(b.style.color="black"===TRIANGLE.item.objRef.style.backgroundColor||"#000000"===TRIANGLE.item.objRef.style.backgroundColor||"rgb(0, 0, 0)"===
TRIANGLE.item.objRef.style.backgroundColor?"white":"black",TRIANGLE.isType.containsNbsp(TRIANGLE.item.objRef)&&TRIANGLE.stripNbsp(TRIANGLE.item.objRef),TRIANGLE.checkPadding(TRIANGLE.item.objRef),TRIANGLE.item.objRef.appendChild(b),TRIANGLE.selectionBorder.update(),TRIANGLE.updateTemplateItems(!0)):TRIANGLE.item||(b.style.color="black"===document.body.style.backgroundColor||"#000000"===document.body.style.backgroundColor||"rgb(0, 0, 0)"===document.body.style.backgroundColor?"white":"black",document.getElementById("template").appendChild(b),
TRIANGLE.selectionBorder.update(),TRIANGLE.updateTemplateItems(!0))},originalTextPosition:null,clearPastedStyles:function(a){TRIANGLE.item&&TRIANGLE.item.objRef.isContentEditable&&setTimeout(function(){var a=TRIANGLE.text.getSelectionCoords().r,c=document.createRange();c.setStart(TRIANGLE.text.originalTextPosition.startContainer,TRIANGLE.text.originalTextPosition.startOffset);c.setEnd(a.endContainer,a.endOffset);var d=window.getSelection();d.removeAllRanges();d.addRange(c);document.execCommand("removeFormat");
c.setStart(a.startContainer,a.startOffset);c.setEnd(a.endContainer,a.endOffset);d.removeAllRanges();d.addRange(c);TRIANGLE.selectionBorder.update()},20)},editText:function(){var a=TRIANGLE.item;a.objRef.removeEventListener("dblclick",TRIANGLE.text.editText);a.objRef.addEventListener("keyup",TRIANGLE.selectionBorder.update);a.objRef.addEventListener("paste",TRIANGLE.text.clearPastedStyles);a.objRef.contentEditable="true";a.objRef.focus();a.objRef.style.cursor="text";if("New text box"==a.objRef.innerHTML||
"Field Label"==a.objRef.innerHTML)a.objRef.innerHTML="";document.getElementById("selectionBorder").style.border="1px dashed black";TRIANGLE.resize.removeHandles()},checkTextEditing:function(a){function b(a){var c=0;3==a.nodeType&&(c=1);for(var e=0;e<a.childNodes.length;++e)c+=b(a.childNodes[e]);return c}a=document.getElementsByClassName("textBox");for(x=0;x<a.length;x++)a[x].isContentEditable&&a[x]!==document.activeElement&&(TRIANGLE.text.clearTextSelection(),a[x].contentEditable="false",a[x].style.cursor=
"",a[x].removeEventListener("keyup",TRIANGLE.selectionBorder.update),a[x].removeEventListener("paste",TRIANGLE.text.clearPastedStyles),0===a[x].innerHTML.length||"<br>"==a[x].innerHTML||"&nbsp;"==a[x].innerHTML||0===b(a[x]))&&(a[x].innerHTML="New text box")},preventTextSelect:function(){for(i=0;i<TRIANGLE.templateItems.length;i++)TRIANGLE.templateItems[i].style.cssText+="-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;"},
allowTextSelect:function(){for(i=0;i<TRIANGLE.templateItems.length;i++)TRIANGLE.templateItems[i].style.cssText=TRIANGLE.templateItems[i].style.cssText.replace(/-webkit-touch-callout: none;|-webkit-user-select: none;|-khtml-user-select: none;|-moz-user-select: none;|-ms-user-select: none;|user-select: none;/g,"")},clearTextSelection:function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():
document.selection&&document.selection.empty()},bold:function(){var a=TRIANGLE.item;a&&TRIANGLE.isType.textBox(a.objRef)&&(a.objRef.isContentEditable?document.execCommand("bold"):/<\/*(b|strong)>/g.test(a.objRef.innerHTML)?a.objRef.innerHTML=a.objRef.innerHTML.replace(/<\/*(b|strong)>/g,""):a.objRef.innerHTML="<b>"+a.objRef.innerHTML+"</b>")},italic:function(){var a=TRIANGLE.item;a&&TRIANGLE.isType.textBox(a.objRef)&&(a.objRef.isContentEditable?document.execCommand("italic"):/<\/*(i|em)>/g.test(a.objRef.innerHTML)?
a.objRef.innerHTML=a.objRef.innerHTML.replace(/<\/*(i|em)>/g,""):a.objRef.innerHTML="<i>"+a.objRef.innerHTML+"</i>")},underline:function(){TRIANGLE.item&&TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&(TRIANGLE.item.objRef.isContentEditable?document.execCommand("underline"):/<\/*u>/g.test(TRIANGLE.item.objRef.innerHTML)?TRIANGLE.item.objRef.innerHTML=TRIANGLE.item.objRef.innerHTML.replace(/<\/*u>/g,""):TRIANGLE.item.objRef.innerHTML="<u>"+TRIANGLE.item.objRef.innerHTML+"</u>")},align:function(a){if(TRIANGLE.item)if(TRIANGLE.item.objRef.isContentEditable)switch(a){case "left":document.execCommand("justifyLeft");
break;case "center":document.execCommand("justifyCenter");break;case "right":document.execCommand("justifyRight")}else TRIANGLE.item.objRef.style.textAlign=a},importedHyperlink:null,savedTextRange:null,hyperlinkTextRange:null,createHyperlink:function(){if(TRIANGLE.item){if(TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&TRIANGLE.item.objRef.isContentEditable){var a=TRIANGLE.text.hyperlinkTextRange=TRIANGLE.text.getSelectionCoords(),b=document.getElementById("hyperlinkMenu");b.style.display="inline-block";
b.style.left=a.x+"px";b.getBoundingClientRect().right>window.innerWidth?(b.style.left="auto",b.style.right=0):b.style.right="auto";b.style.top=a.y+parseInt(TRIANGLE.item.objRef.style.fontSize)+"px";b.getBoundingClientRect().bottom>window.innerHeight?(b.style.bottom=0,b.style.top="auto"):b.style.bottom="auto";TRIANGLE.text.hyperlinkTextRange=a.r}else TRIANGLE.pages.loadPages("","select"),a=TRIANGLE.item.objRef.getBoundingClientRect(),b=document.getElementById("hyperlinkMenu"),b.style.display="inline-block",
b.style.left=a.left+"px",b.getBoundingClientRect().right>window.innerWidth?(b.style.left="auto",b.style.right=0):b.style.right="auto",b.style.top=a.bottom+"px",b.getBoundingClientRect().bottom>window.innerHeight?(b.style.top="auto",b.style.bottom=0):b.style.bottom="auto";document.getElementById("hyperlinkURL").focus()}},applyHyperlink:function(){if(TRIANGLE.item&&TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&TRIANGLE.item.objRef.isContentEditable){var a=window.getSelection();a.removeAllRanges();
a.addRange(TRIANGLE.text.hyperlinkTextRange);a=document.getElementById("hyperlinkPage");0!==a.selectedIndex?(a=a.options[a.selectedIndex].value+".php",TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&TRIANGLE.item.objRef.isContentEditable?document.execCommand("createLink",null,a):TRIANGLE.item.objRef.setAttribute("link-to",a)):""!==document.getElementById("hyperlinkURL").value&&(a=document.getElementById("hyperlinkURL").value,TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&TRIANGLE.item.objRef.isContentEditable?
document.execCommand("createLink",null,a):TRIANGLE.item.objRef.setAttribute("link-to",a));TRIANGLE.text.underline()}else TRIANGLE.item&&(a=document.getElementById("hyperlinkPage"),0!==a.selectedIndex?(a=a.options[a.selectedIndex].value+".php",TRIANGLE.item.objRef.setAttribute("link-to",a)):""!==document.getElementById("hyperlinkURL").value&&(a=document.getElementById("hyperlinkURL").value,TRIANGLE.item.objRef.setAttribute("link-to",a)));TRIANGLE.text.cancelHyperlink();TRIANGLE.importItem.single(TRIANGLE.item.index)},
cancelHyperlink:function(){document.getElementById("hyperlinkURL").value="";document.getElementById("hyperlinkPage").selectedIndex=0;document.getElementById("hyperlinkMenu").style.display="none"},deleteHyperlink:function(){if(TRIANGLE.item){if(TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&TRIANGLE.item.objRef.isContentEditable)document.execCommand("unlink");else{var a=TRIANGLE.item.objRef.firstChild,b=a.tagName;TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&1===TRIANGLE.item.objRef.children.length&&
"A"===b?TRIANGLE.item.objRef.innerHTML=a.innerHTML:TRIANGLE.item.objRef.getAttribute("link-to")&&(TRIANGLE.item.objRef.removeAttribute("link-to"),TRIANGLE.item.objRef.removeAttribute("target"))}/<u>/.test(TRIANGLE.item.objRef.innerHTML)&&TRIANGLE.text.underline();document.getElementById("hrefHyperlink").value="";document.getElementById("hrefTarget").value=0}},changeLinkTarget:function(a){0===a.selectedIndex?null!=TRIANGLE.text.importedHyperlink?TRIANGLE.text.importedHyperlink.removeAttribute("target"):
TRIANGLE.isType.textBox(TRIANGLE.item.objRef)?TRIANGLE.item.objRef.firstChild.removeAttribute("target"):TRIANGLE.item.objRef.removeAttribute("target"):(a=a.options[a.selectedIndex].text,TRIANGLE.text.importedHyperlink?TRIANGLE.text.importedHyperlink.setAttribute("target",a):TRIANGLE.isType.textBox(TRIANGLE.item.objRef)?TRIANGLE.item.objRef.firstChild.setAttribute("target",a):TRIANGLE.item.objRef.setAttribute("target",a))},insertUnorderedList:function(){TRIANGLE.item&&TRIANGLE.item.objRef.isContentEditable&&
(document.execCommand("insertUnorderedList"),TRIANGLE.selectionBorder.update())},insertOrderedList:function(){TRIANGLE.item&&TRIANGLE.item.objRef.isContentEditable&&(document.execCommand("insertOrderedList"),TRIANGLE.selectionBorder.update())},insertHorizontalRule:function(){TRIANGLE.item&&TRIANGLE.isType.textBox(TRIANGLE.item.objRef)&&(TRIANGLE.item.objRef.isContentEditable?document.execCommand("insertHorizontalRule"):TRIANGLE.item.objRef.innerHTML+="<hr>",TRIANGLE.selectionBorder.update())},changeFont:function(a){if(TRIANGLE.isType.textBox(TRIANGLE.item.objRef)){var b=
a.options[a.selectedIndex];a=b.text;var c=document.getElementById("fontData");if(b.getAttribute("font-url")){b=b.getAttribute("font-url");var d=b.replace(/'/g,'"');d=encodeURIComponent(d);d=d.replace(/\./g,"\\.");d=d.replace(/%0A/g,"");d=new RegExp(d);var e=c.innerHTML;e=e.replace(/'/g,'"');e=encodeURIComponent(e);d.test(e)||(c.innerHTML+=b)}TRIANGLE.item.objRef.isContentEditable?(document.execCommand("styleWithCSS",null,!0),document.execCommand("fontName",null,a),document.execCommand("styleWithCSS",
null,!1)):TRIANGLE.item.objRef.style.fontFamily=a;TRIANGLE.selectionBorder.update()}},deleteUnusedFonts:function(){var a=document.getElementById("fontType");for(i=0;i<a.options.length;i++)if("Arial"!==a.options[i].innerHTML){var b=0;for(x=0;x<TRIANGLE.templateItems.length;x++)if(TRIANGLE.isType.textBox(TRIANGLE.templateItems[x])){var c=TRIANGLE.templateItems[x].style.fontFamily;c=c.replace(/'/g,"");c=c.replace(/"/g,"");c===a.options[i].text&&b++}if(0===b&&a.options[i].getAttribute("font-url")){b=
a.options[i].getAttribute("font-url");b=b.replace(/'/g,'"');b=encodeURIComponent(b);b=b.replace(/\./g,"\\.");b=b.replace(/%0A/g,"");b=new RegExp(b);c=document.getElementById("fontData");var d=c.innerHTML;d=d.replace(/'/g,'"');d=encodeURIComponent(d);b.test(d)&&(d=d.replace(b,""),c.innerHTML=decodeURIComponent(d))}}},changeFontColor:function(a){TRIANGLE.isType.textBox(TRIANGLE.item)&&(TRIANGLE.text.replaceTextSelection(),TRIANGLE.item.objRef.isContentEditable?(document.execCommand("styleWithCSS",null,
!0),document.execCommand("foreColor",null,a),document.execCommand("styleWithCSS",null,!1)):TRIANGLE.item.objRef.style.color=a)},increaseFontSize:function(){if(TRIANGLE.item&&TRIANGLE.isType.textBox(TRIANGLE.item.objRef)){var a=document.getElementById("fontSize").value,b=TRIANGLE.getUnit(a);a=parseFloat(a)+1;TRIANGLE.item.objRef.style.fontSize=a+b;document.getElementById("fontSize").value=a;TRIANGLE.selectionBorder.update()}},decreaseFontSize:function(){if(TRIANGLE.item&&TRIANGLE.isType.textBox(TRIANGLE.item.objRef)){var a=
document.getElementById("fontSize").value,b=TRIANGLE.getUnit(TRIANGLE.item.fontSize),c=parseFloat(a)-1;c=0<c?c:a;TRIANGLE.item.objRef.style.fontSize=c+b;document.getElementById("fontSize").value=c;TRIANGLE.selectionBorder.update()}},changeFontSize:function(){if(TRIANGLE.item&&TRIANGLE.isType.textBox(TRIANGLE.item.objRef)){var a=document.getElementById("fontSize").value,b=TRIANGLE.getUnit(TRIANGLE.item.fontSize);a=parseFloat(a)+b;TRIANGLE.item.objRef.style.fontSize=a;TRIANGLE.selectionBorder.update()}},
getSelectionCoords:function(a){a=a||window;var b=a.document,c=b.selection,d=0;var e=0;c?"Control"!=c.type&&(a=c.createRange(),a.collapse(!0),d=a.boundingRight,e=a.boundingTop):a.getSelection&&(c=a.getSelection(),c.rangeCount&&(a=c.getRangeAt(0).cloneRange(),a.getClientRects&&(a.collapse(!1),c=a.getClientRects(),0<c.length&&(e=c[0],d=e.right,e=e.top)),0==d&&0==e&&(c=b.createElement("span"),c.getClientRects&&(c.appendChild(b.createTextNode("\u200b")),a.insertNode(c),e=c.getClientRects()[0],d=e.right,
e=e.top,b=c.parentNode,b.removeChild(c),b.normalize()))));return{x:d,y:e,r:TRIANGLE.text.saveTextSelection()}},saveTextSelection:function(){if(window.getSelection&&document.createRange){var a=window.getSelection().getRangeAt(0).cloneRange();return TRIANGLE.text.savedTextRange=a}},replaceTextSelection:function(){var a=window.getSelection();a.removeAllRanges();a.addRange(TRIANGLE.text.savedTextRange)},getPasteContents:function(a){var b=document.createElement("div");b.innerHTML=a;return b.textContent||
b.innerText||""}};TRIANGLE.templateItems=document.getElementsByClassName("templateItem");TRIANGLE.refreshTemplateItems=function(){var a=document.getElementById("template").getElementsByClassName("templateItem");return TRIANGLE.templateItems=a};TRIANGLE.item;TRIANGLE.sv_item;TRIANGLE.scrollbarWidth;
TRIANGLE.template={getFixedWidth:function(){TRIANGLE.popUp.open("getFixedWidthCell");document.getElementById("customFixedWidth").value=document.getElementById("template").style.width},type:null,fixedWidth:function(){if(1===arguments.length)document.getElementById("template").style.width=arguments[0];else if(0===arguments.length){var a=document.getElementById("customFixedWidth").value;/\D/g.test(a)?document.getElementById("template").style.width=a:document.getElementById("template").style.width=a+
"px"}document.getElementById("template").style.margin="0 auto";TRIANGLE.template.type="fixed";TRIANGLE.popUp.close();TRIANGLE.selectionBorder.update()},cancelFixedWidth:function(){TRIANGLE.popUp.close()},fluidWidth:function(){document.getElementById("template").style.width="100%";document.getElementById("template").style.margin="";TRIANGLE.template.type="fluid";TRIANGLE.selectionBorder.update()},blank:function(){for(i=0;i<TRIANGLE.templateItems.length;i++)TRIANGLE.templateItems[i].removeEventListener("mousedown",
TRIANGLE.importItem.single,!0),TRIANGLE.templateItems[i].removeEventListener("mouseover",TRIANGLE.hoverBorder.show,!0),TRIANGLE.templateItems[i].removeEventListener("dblclick",TRIANGLE.text.editText);document.getElementById("template").innerHTML="";document.getElementById("bodyBgData").style.backgroundColor="#FFFFFF";document.getElementById("hoverData").style.backgroundColor="#FFFFFF";document.getElementById("hoverItems").style.backgroundColor="#FFFFFF";document.getElementById("animationData").style.backgroundColor=
"#FFFFFF";document.getElementById("fontData").style.backgroundColor="#FFFFFF";TRIANGLE.colors.updateBodyBg()},increaseOpacity:function(){var a=document.getElementById("template");a.style.opacity&&(a.style.opacity=parseFloat(a.style.opacity)+parseFloat(a.style.opacity)/10,.9<parseFloat(a.style.opacity)&&(a.style.opacity=""))},decreaseOpacity:function(){var a=document.getElementById("template");a.style.opacity?(a.style.opacity=parseFloat(a.style.opacity)-parseFloat(a.style.opacity)/10,.1>parseFloat(a.style.opacity)&&
(a.style.opacity=.1)):a.style.opacity=.9}};
TRIANGLE.TemplateItem=function(a){this.index=parseInt(a);this.objRef=document.getElementById("item"+this.index)?document.getElementById("item"+this.index):TRIANGLE.templateItems[this.index];this.prevItem=document.getElementById("item"+(a-1))||TRIANGLE.templateItems[a-1];this.nextItem=document.getElementById("item"+(a+1))||TRIANGLE.templateItems[a+1];this.parent=this.objRef.parentNode;this.childOf=this.objRef.getAttribute("childof")?this.objRef.getAttribute("childof"):null;this.id=this.objRef.id;this.parentId=
this.objRef.parentNode.id;this.className=this.objRef.className;this.textNodes=this.objRef.getElementsByClassName("textBox").length;this.tag=this.objRef.tagName;this.resizing=!1;this.align=this.objRef.getAttribute("item-align");this.isFirstChild=this.prevSibling()?!1:!0;this.isLastChild=this.nextSibling()?!1:!0;this.image=TRIANGLE.isType.imageItem(this.objRef)?this.objRef.children[0]:void 0;this.cropMap=this.objRef.getAttribute("crop-map")?this.objRef.getAttribute("crop-map"):!1;this.cropRatio=this.objRef.getAttribute("crop-ratio")?
parseFloat(this.objRef.getAttribute("crop-ratio")):!1;this.linkTo=this.objRef.getAttribute("link-to")?this.objRef.getAttribute("link-to"):!1;this.userID=this.objRef.getAttribute("user-id")?this.objRef.getAttribute("user-id"):!1;this.userClass=this.objRef.getAttribute("user-class")?this.objRef.getAttribute("user-class"):!1;this.bgColor=this.objRef.style.backgroundColor;this.height=this.objRef.style.height;this.minHeight=this.objRef.style.minHeight;this.width=this.objRef.style.width;this.display=this.objRef.style.display;
this.position=this.objRef.style.position;this.cssFloat=this.objRef.style.cssFloat;this.transform=this.detectTransform();this.padding=this.objRef.style.padding;this.paddingLeft=this.objRef.style.paddingLeft;this.paddingRight=this.objRef.style.paddingRight;this.paddingTop=this.objRef.style.paddingTop;this.paddingBottom=this.objRef.style.paddingBottom;this.margin=this.objRef.style.margin;this.marginLeft=this.objRef.style.marginLeft;this.marginRight=this.objRef.style.marginRight;this.marginTop=this.objRef.style.marginTop;
this.marginBottom=this.objRef.style.marginBottom;this.border=this.objRef.style.border;this.borderLeft=this.objRef.style.borderLeft;this.borderLeftWidth=this.objRef.style.borderLeftWidth;this.borderLeftStyle=this.objRef.style.borderLeftStyle;this.borderLeftColor=this.objRef.style.borderLeftColor;this.borderRight=this.objRef.style.borderRight;this.borderRightWidth=this.objRef.style.borderRightWidth;this.borderRightStyle=this.objRef.style.borderRightStyle;this.borderRightColor=this.objRef.style.borderRightColor;
this.borderTop=this.objRef.style.borderTop;this.borderTopWidth=this.objRef.style.borderTopWidth;this.borderTopStyle=this.objRef.style.borderTopStyle;this.borderTopColor=this.objRef.style.borderTopColor;this.borderBottom=this.objRef.style.borderBottom;this.borderBottomWidth=this.objRef.style.borderBottomWidth;this.borderBottomStyle=this.objRef.style.borderBottomStyle;this.borderBottomColor=this.objRef.style.borderBottomColor;this.boxShadow=this.objRef.style.boxShadow;this.fontFamily=this.objRef.style.fontFamily;
this.fontColor=this.objRef.style.color;this.fontSize=this.objRef.style.fontSize;this.lineHeight=this.objRef.style.lineHeight;this.hover={};this.hover.cssText=this.objRef.getAttribute("hover-style");this.hoverVersion=(this.hoverObj=document.getElementById(this.id+"hover"))?!0:!1;this.readEcomData=(this.ecomParent=this.getEcomParent())?this.readEcomData():!1;this.ecom={};this.ecom.itemName=this.readEcomData?this.readEcomData.name:null;this.ecom.itemID=this.readEcomData?this.readEcomData.itemID:null;
this.ecom.price=this.readEcomData?this.readEcomData.price:null;this.ecom.quantity=this.readEcomData?this.readEcomData.quantity:null;this.ecom.description=this.readEcomData?this.readEcomData.description:null;this.ecom.tax=this.readEcomData?this.readEcomData.tax:null;this.ecom.shipping=this.readEcomData?this.readEcomData.shipping:null;this.ecom.usps=this.readEcomData?this.readEcomData.usps:null};TRIANGLE.TemplateItem.prototype.append=function(a){this.objRef.appendChild(a)};
TRIANGLE.TemplateItem.prototype.remove=function(){this.parent.removeChild(this.objRef)};TRIANGLE.TemplateItem.prototype.countTextNodes=function(){var a=this.objRef.getElementsByClassName("textBox"),b=a.length;for(z=0;z<a.length;z++)b+=a[z].children.length;return b};TRIANGLE.TemplateItem.prototype.addClass=function(a){this.objRef.className=this.className+" "+a};
TRIANGLE.TemplateItem.prototype.removeClass=function(a){this.objRef.className=this.objRef.className.replace(a,"");this.objRef.className=this.objRef.className.replace("s+"," ")};TRIANGLE.TemplateItem.prototype.siblings=function(){var a=this.parent.children,b=[];for(k=j=0;k<a.length;k++)a[k].parentNode===this.parent&&a[k]!==this.objRef&&/templateItem/g.test(a[k].className)&&(b[j]=a[k],j++);return b};
TRIANGLE.TemplateItem.prototype.prevSibling=function(){var a=this.parent.children;for(k=a.length-1;0<=k;k--){if(a[k]===this.objRef)var b=this.index;if(parseInt(a[k].getAttribute("index"))<b&&a[k].parentNode===this.parent)return a[k]}};TRIANGLE.TemplateItem.prototype.nextSibling=function(){var a=this.parent.children;for(k=0;k<a.length;k++){if(a[k]===this.objRef)var b=this.index;if(parseInt(a[k].getAttribute("index"))>b&&a[k].parentNode===this.parent)return a[k]}};
TRIANGLE.TemplateItem.prototype.detectTransform=function(){if(this.objRef.style.transform)return this.objRef.style.transform;if(this.objRef.style.WebkitTransform)return this.objRef.style.WebkitTransform;if(this.objRef.style.msTransform)return this.objRef.style.msTransform};
TRIANGLE.TemplateItem.prototype.isAbove=function(a){var b=this.siblings();for(k=0;k<b.length;k++)if(b[k]===document.getElementById("item"+a))return a=this.objRef.getBoundingClientRect(),b=b[k].getBoundingClientRect(),b.bottom<=a.top&&200>=a.top-b.bottom?!0:!1};
TRIANGLE.TemplateItem.prototype.isBelow=function(a){var b=this.siblings();for(k=0;k<b.length;k++)if(b[k]===document.getElementById("item"+a))return a=this.objRef.getBoundingClientRect(),b=b[k].getBoundingClientRect(),b.top>=a.bottom&&200>=b.bottom-a.bottom?!0:!1};TRIANGLE.TemplateItem.prototype.searchParentTree=function(a){var b=this.objRef;for(a=new RegExp(a);"template"!=b.id&&!a.test(b.className);)b=b.parentNode;return"template"!=b.id?!0:!1};
TRIANGLE.TemplateItem.prototype.getEcomParent=function(){for(var a=this.objRef;"template"!=a.id&&!TRIANGLE.isType.ecommerceItem(a);)a=a.parentNode;return"template"!=a.id?a:!1};TRIANGLE.TemplateItem.prototype.readEcomData=function(){if(this.ecomParent&&this.ecomParent.getAttribute("ecommerce")){var a=this.ecomParent.getAttribute("ecommerce");return JSON.parse(a)}return!1};Element.prototype.remove=function(){this.parentElement.removeChild(this)};
NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var a=0,b=this.length;a<b;a++)this[a]&&this[a].parentElement&&this[a].parentElement.removeChild(this[a])};
TRIANGLE.dragDrop={eatClick:null,draggingElem:null,draggingCopy:null,active:!1,applyDrag:function(a){TRIANGLE.dragDrop.eatClick=setTimeout(TRIANGLE.dragDrop.start,200)},start:function(a){TRIANGLE.item.objRef.isContentEditable||"BUTTON"===TRIANGLE.item.tag||TRIANGLE.isType.formField(TRIANGLE.item.objRef)||(TRIANGLE.dragDrop.active=!0,TRIANGLE.dragDrop.draggingElem=TRIANGLE.item.objRef,TRIANGLE.dragDrop.draggingElem.style.opacity="0.5",TRIANGLE.dragDrop.draggingCopy=TRIANGLE.createAnother(TRIANGLE.dragDrop.draggingElem),
a=TRIANGLE.dragDrop.draggingElem.getBoundingClientRect(),TRIANGLE.dragDrop.draggingCopy.style.width=a.width+"px",TRIANGLE.dragDrop.draggingCopy.style.height=TRIANGLE.dragDrop.draggingCopy.style.minHeight=a.height+"px",TRIANGLE.dragDrop.draggingCopy.style.position="fixed",TRIANGLE.dragDrop.draggingCopy.style.opacity="0.7",TRIANGLE.dragDrop.draggingCopy.style.zIndex="2",TRIANGLE.dragDrop.draggingCopy.style.visibility="hidden",TRIANGLE.dragDrop.draggingCopy.style.pointerEvents="none",TRIANGLE.dragDrop.draggingCopy.style.transform=
"scale(0.5,0.5)",TRIANGLE.dragDrop.draggingCopy.id="draggingCopy",TRIANGLE.dragDrop.draggingCopy.className="draggingCopy",document.body.appendChild(TRIANGLE.dragDrop.draggingCopy),document.addEventListener("mousemove",TRIANGLE.dragDrop.updatePosition),document.addEventListener("mousemove",TRIANGLE.dragDrop.dragVis),TRIANGLE.text.preventTextSelect())},updatePosition:function(a){"hidden"==TRIANGLE.dragDrop.draggingCopy.style.visibility&&(TRIANGLE.dragDrop.draggingCopy.style.visibility="visible");TRIANGLE.dragDrop.draggingCopy.style.top=
a.clientY-TRIANGLE.dragDrop.draggingCopy.getBoundingClientRect().height+"px";TRIANGLE.dragDrop.draggingCopy.style.left=a.clientX-TRIANGLE.dragDrop.draggingCopy.getBoundingClientRect().width+"px"},stop:function(a){a=TRIANGLE.item;clearTimeout(TRIANGLE.dragDrop.eatClick);if(TRIANGLE.dragDrop.active)if(TRIANGLE.dragDrop.draggingElem.style.opacity="",TRIANGLE.dragDrop.draggingCopy&&document.body.removeChild(TRIANGLE.dragDrop.draggingCopy),document.getElementById("draggingCopy")&&document.body.removeChild("draggingCopy"),
TRIANGLE.hoveredElem!==TRIANGLE.dragDrop.draggingElem&&TRIANGLE.hoveredElem!==TRIANGLE.dragDrop.draggingElem.parentNode){a=TRIANGLE.createAnother(TRIANGLE.item.objRef);if(document.getElementById("visBox")){TRIANGLE.dragDrop.draggingElem.remove();document.getElementById("visBox").style.cssFloat&&(a.style.cssFloat=document.getElementById("visBox").style.cssFloat,a.setAttribute("item-align",a.style.cssFloat));var b=document.getElementById("visBox").parentNode;"template"!==b.getAttribute("id")&&TRIANGLE.checkPadding(b);
b.insertBefore(a,document.getElementById("visBox"));TRIANGLE.dragDrop.removeVisBox()}else TRIANGLE.hoveredElem&&!TRIANGLE.isType.bannedInsertion(TRIANGLE.hoveredElem)&&(TRIANGLE.checkPadding(TRIANGLE.hoveredElem),TRIANGLE.hoveredElem.appendChild(a),TRIANGLE.dragDrop.draggingElem.remove());TRIANGLE.clearSelection();TRIANGLE.updateTemplateItems();TRIANGLE.text.clearTextSelection()}else TRIANGLE.hoveredElem==TRIANGLE.dragDrop.draggingElem.parentNode&&document.getElementById("visBox")&&(a=TRIANGLE.createAnother(a.objRef),
TRIANGLE.dragDrop.draggingElem.remove(),document.getElementById("visBox").style.cssFloat&&(a.style.cssFloat=document.getElementById("visBox").style.cssFloat,a.setAttribute("item-align",a.style.cssFloat)),document.getElementById("visBox").parentNode.insertBefore(a,document.getElementById("visBox")),TRIANGLE.dragDrop.removeVisBox());TRIANGLE.dragDrop.active=!1;TRIANGLE.dragDrop.draggingElem=!1;TRIANGLE.updateTemplateItems(!0);document.removeEventListener("mousemove",TRIANGLE.dragDrop.updatePosition);
document.removeEventListener("mousemove",TRIANGLE.dragDrop.dragVis);TRIANGLE.text.allowTextSelect();TRIANGLE.updateTemplateItems()},itemMap:{left:[],right:[],top:[],bottom:[],height:[],width:[],minY:[],maxY:[],minX:[],maxX:[]},updateItemMap:function(){for(i=0;i<TRIANGLE.templateItems.length;i++){var a=TRIANGLE.templateItems[i].getBoundingClientRect();TRIANGLE.dragDrop.itemMap.left[i]=a.left;TRIANGLE.dragDrop.itemMap.right[i]=a.right;TRIANGLE.dragDrop.itemMap.top[i]=a.top;TRIANGLE.dragDrop.itemMap.bottom[i]=
a.bottom;TRIANGLE.dragDrop.itemMap.height[i]=a.height;TRIANGLE.dragDrop.itemMap.width[i]=a.width;TRIANGLE.dragDrop.itemMap.minY[i]=a.top+10;TRIANGLE.dragDrop.itemMap.maxY[i]=a.bottom-10;TRIANGLE.dragDrop.itemMap.minX[i]=a.left+10;TRIANGLE.dragDrop.itemMap.maxX[i]=a.right-10}},prevHoverElem:null,dragVis:function(a){if(TRIANGLE.hoveredElem){var b=parseInt(TRIANGLE.hoveredElem.getAttribute("index"));if("template"!=TRIANGLE.hoveredElem.parentNode.id)var c=parseInt(TRIANGLE.hoveredElem.parentNode.getAttribute("index"));
TRIANGLE.hoveredElem.nextSibling&&TRIANGLE.isType.templateItem(TRIANGLE.hoveredElem.nextSibling)&&parseInt(TRIANGLE.hoveredElem.nextSibling.getAttribute("index"));var d=void 0;TRIANGLE.hoveredElem.previousSibling&&TRIANGLE.isType.templateItem(TRIANGLE.hoveredElem.previousSibling)&&(d=parseInt(TRIANGLE.hoveredElem.previousSibling.getAttribute("index")));var e=void 0;TRIANGLE.hoveredElem.children[0]&&TRIANGLE.hoveredElem.children[0].getAttribute("index")&&(e=parseInt(TRIANGLE.hoveredElem.children[0].getAttribute("index")));
var g=void 0;TRIANGLE.hoveredElem.children[0]&&TRIANGLE.isType.templateItem(TRIANGLE.hoveredElem.lastChild)&&(g=parseInt(TRIANGLE.hoveredElem.lastChild.getAttribute("index")))}if(TRIANGLE.dragDrop.draggingElem)var f=parseInt(TRIANGLE.dragDrop.draggingElem.getAttribute("index"));if(TRIANGLE.hoveredElem!==TRIANGLE.dragDrop.draggingElem){var m=document.getElementById("template"),l=TRIANGLE.templateItems.length-1,h=[],n=document.getElementById("item"+f).querySelectorAll(".templateItem");for(i=0;i<n.length;i++)h[i]=
parseInt(n[i].getAttribute("index"));-1<h.indexOf(parseInt(b))||(a.clientY<TRIANGLE.dragDrop.itemMap.top[0]&&0!=f?(TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.templateItems[0]),console.log("before all")):a.clientY>TRIANGLE.dragDrop.itemMap.bottom[l]&&f!=l?(TRIANGLE.dragDrop.createVisBox("inside",m),console.log("after all")):e&&a.clientY>=TRIANGLE.dragDrop.itemMap.top[b]&&a.clientY<=TRIANGLE.dragDrop.itemMap.minY[e]&&f!=e?(TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.hoveredElem.children[0]),
console.log("first child")):a.clientY<=TRIANGLE.dragDrop.itemMap.minY[b]&&a.clientY>=TRIANGLE.dragDrop.itemMap.maxY[d]&&f!=b?(TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.hoveredElem),console.log("before hovered, after previous row")):a.clientY>=TRIANGLE.dragDrop.itemMap.maxY[b]&&a.clientY<=TRIANGLE.dragDrop.itemMap.bottom[c]&&f!=g?(TRIANGLE.dragDrop.createVisBox("after",TRIANGLE.hoveredElem),console.log("last child")):a.clientY<TRIANGLE.dragDrop.itemMap.maxY[b]&&a.clientY>TRIANGLE.dragDrop.itemMap.minY[b]&&
(f===b?TRIANGLE.dragDrop.removeVisBox():1===TRIANGLE.hoveredElem.children.length&&TRIANGLE.hoveredElem.children[0].getAttribute("index")==f?TRIANGLE.dragDrop.removeVisBox():a.clientX<TRIANGLE.dragDrop.itemMap.maxX[b]&&a.clientX>TRIANGLE.dragDrop.itemMap.minX[b]?(console.log("inside"),TRIANGLE.dragDrop.createVisBox("inside",TRIANGLE.hoveredElem)):0>b-1&&a.clientX<TRIANGLE.dragDrop.itemMap.minX[b]+5?TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.hoveredElem):a.clientX>TRIANGLE.dragDrop.itemMap.right[b-
1]&&a.clientX<=TRIANGLE.dragDrop.itemMap.minX[b]&&"right"!=TRIANGLE.hoveredElem.style.cssFloat?TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.hoveredElem):a.clientX<=TRIANGLE.dragDrop.itemMap.minX[b]&&"right"!=TRIANGLE.hoveredElem.style.cssFloat?TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.hoveredElem):a.clientX<TRIANGLE.dragDrop.itemMap.left[b-1]&&a.clientX>=TRIANGLE.dragDrop.itemMap.maxX[b]&&"right"===TRIANGLE.hoveredElem.style.cssFloat?TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.hoveredElem):
a.clientX>=TRIANGLE.dragDrop.itemMap.maxX[b]&&"right"===TRIANGLE.hoveredElem.style.cssFloat?TRIANGLE.dragDrop.createVisBox("before",TRIANGLE.hoveredElem):TRIANGLE.dragDrop.createVisBox("inside",TRIANGLE.hoveredElem)))}},createVisBox:function(a,b,c){TRIANGLE.dragDrop.removeVisBox();if(!document.getElementById("visBox")&&b&&b.parentNode){c=document.createElement("div");var d=TRIANGLE.dragDrop.draggingElem.getBoundingClientRect();c.style.height=d.height+"px";c.style.width=TRIANGLE.dragDrop.draggingElem.style.width;
"auto"===TRIANGLE.dragDrop.draggingElem.style.marginLeft&&(c.style.marginLeft="auto");"auto"===TRIANGLE.dragDrop.draggingElem.style.marginRight&&(c.style.marginRight="auto");var e=!1;d=document.createElement("div");d.setAttribute("id","clearVisFloatBefore");var g=document.createElement("div");g.setAttribute("id","clearVisFloatAfter");"left"===TRIANGLE.dragDrop.draggingElem.style.cssFloat?(c.style.cssFloat="left",e=!0):"right"===TRIANGLE.dragDrop.draggingElem.style.cssFloat&&(c.style.cssFloat="right",
e=!0);c.setAttribute("id","visBox");c.addEventListener("mouseover",TRIANGLE.dragDrop.maintainVisBox);c.addEventListener("mouseout",TRIANGLE.dragDrop.removeVisBox);var f=document.createElement("div");f.setAttribute("id","visBoxInner");c.appendChild(f);document.createElement("div");"before"!==a&&a?"after"===a?b.nextSibling?(b.parentNode.insertBefore(c,b.nextSibling),e&&!c.nextSibling.style.cssFloat&&b.parentNode.insertBefore(d,b.nextSibling.nextSibling)):(b.parentNode.appendChild(c),e&&c.parentNode.appendChild(g)):
"inside"!==a||TRIANGLE.isType.bannedInsertion(b)||(b.appendChild(c),e&&c.parentNode.appendChild(g)):(b.parentNode.insertBefore(c,b),e&&!b.style.cssFloat&&b.parentNode.insertBefore(d,b));e||(a=c.nextSibling,b=c.previousSibling,a?c.parentNode.insertBefore(g,a):c.parentNode.appendChild(g),b&&c.parentNode.insertBefore(d,c))}TRIANGLE.dragDrop.updateItemMap();TRIANGLE.selectionBorder.remove();TRIANGLE.hoverBorder.hide();TRIANGLE.dragDrop.prevHoverElem=TRIANGLE.hoveredElem},removeVisBox:function(){document.getElementById("visBox")&&
(document.getElementById("visBox").removeEventListener("mouseover",TRIANGLE.dragDrop.maintainVisBox),document.getElementById("visBox").removeEventListener("mouseout",TRIANGLE.dragDrop.removeVisBox),document.getElementById("clearVisFloat")&&document.getElementById("clearVisFloat").remove(),document.getElementById("clearVisFloatBefore")&&document.getElementById("clearVisFloatBefore").remove(),document.getElementById("clearVisFloatAfter")&&document.getElementById("clearVisFloatAfter").remove(),document.getElementById("visBox").remove(),
TRIANGLE.dragDrop.updateItemMap(),TRIANGLE.selectionBorder.remove())},maintainVisBox:function(a){TRIANGLE.hoveredElem=TRIANGLE.dragDrop.prevHoverElem}};TRIANGLE.resetClearFloat=function(){for(;0<document.getElementsByClassName("clearFloat").length;)document.getElementsByClassName("clearFloat")[0].remove()};
TRIANGLE.insertClearFloats=function(){if(TRIANGLE.sv_item.cssFloat){var a=document.createElement("div");a.className="clearFloat";a.style.clear="both";if(!TRIANGLE.sv_item.nextSibling()||!TRIANGLE.sv_item.nextSibling().style.cssFloat)for(TRIANGLE.sv_item.nextSibling()&&!TRIANGLE.sv_item.nextSibling().style.cssFloat?TRIANGLE.sv_item.parent.insertBefore(a,TRIANGLE.sv_item.nextSibling()):TRIANGLE.sv_item.nextSibling()||TRIANGLE.sv_item.parent.appendChild(a),document.getElementById("visBox")&&!document.getElementById("visBox").style.cssFloat&&
document.getElementById("visBox").parentNode.insertBefore(a,document.getElementById("visBox")),x=0;x<TRIANGLE.sv_item.parent.children.length;x++){a=TRIANGLE.sv_item.parent.children[x];var b=a.nextSibling;TRIANGLE.isType.clearFloat(a)&&b&&TRIANGLE.isType.clearFloat(b)&&a.parentNode.removeChild(b)}}};
TRIANGLE.updateTemplateItems=function(a){TRIANGLE.templateItems=TRIANGLE.refreshTemplateItems();TRIANGLE.dragDrop.removeVisBox();TRIANGLE.resetClearFloat();for(i=0;i<TRIANGLE.templateItems.length;i++){TRIANGLE.sv_item=new TRIANGLE.TemplateItem(i);TRIANGLE.sv_item.objRef.removeEventListener("mousedown",TRIANGLE.importItem.single,!0);TRIANGLE.sv_item.objRef.addEventListener("mousedown",TRIANGLE.importItem.single,!0);/templateItem/g.test(TRIANGLE.sv_item.parent.className)?/childItem/g.test(TRIANGLE.sv_item.className)||
(TRIANGLE.sv_item.objRef.className+=" childItem"):TRIANGLE.sv_item.objRef.addEventListener("mousedown",TRIANGLE.dragDrop.applyDrag,!0);TRIANGLE.sv_item.objRef.removeEventListener("mouseover",TRIANGLE.hoverBorder.show,!0);TRIANGLE.sv_item.objRef.addEventListener("mouseover",TRIANGLE.hoverBorder.show,!0);TRIANGLE.isType.textBox(TRIANGLE.sv_item.objRef)?(TRIANGLE.sv_item.objRef.removeEventListener("dblclick",TRIANGLE.text.editText),TRIANGLE.sv_item.objRef.addEventListener("dblclick",TRIANGLE.text.editText)):
TRIANGLE.sv_item.objRef.removeEventListener("dblclick",TRIANGLE.text.editText);TRIANGLE.templateItems[i].setAttribute("id","item"+i);TRIANGLE.templateItems[i].setAttribute("index",i);if(TRIANGLE.isType.childItem(TRIANGLE.sv_item.objRef)){var b=TRIANGLE.sv_item.parent.getAttribute("id");TRIANGLE.sv_item.objRef.setAttribute("childof",b);"template"===b&&TRIANGLE.sv_item.removeClass("childItem")}"table"!==TRIANGLE.sv_item.display||TRIANGLE.sv_item.objRef.innerHTML||(TRIANGLE.sv_item.objRef.style.display=
"",TRIANGLE.sv_item.objRef.style.height="auto");TRIANGLE.isType.formField(TRIANGLE.sv_item.objRef)?TRIANGLE.sv_item.objRef.setAttribute("name","item"+i):TRIANGLE.sv_item.objRef.removeAttribute("name");TRIANGLE.isType.catalog(TRIANGLE.sv_item.objRef)&&0===TRIANGLE.sv_item.objRef.querySelectorAll(".ecommerceItem").length&&TRIANGLE.sv_item.removeClass("catalog");TRIANGLE.insertClearFloats()}TRIANGLE.ecommerce.updateItemIDs();TRIANGLE.dragDrop.updateItemMap();a&&TRIANGLE.updateTemplateItems()};TRIANGLE.updateTemplateItems();
TRIANGLE.selectItem=function(a){TRIANGLE.item=new TRIANGLE.TemplateItem(a)};TRIANGLE.getOriginalIndex=function(a){var b=!1;a&&!isNaN(a)&&isFinite(a)&&(b=parseInt(a));return b};
TRIANGLE.isType={templateItem:function(a){if(a)return/templateItem/g.test(a.className)?!0:!1},childItem:function(a){if(a)return/childItem/g.test(a.className)?!0:!1},textBox:function(a){if(a)return/textBox/g.test(a.className)?!0:!1},imageItem:function(a){if(a){var b=a.className;return/img/ig.test(a.tagName)||/imageItem/g.test(b)?!0:!1}},snippetItem:function(a){if(a)return/snippetItem/g.test(a.className)?!0:!1},verticalAlign:function(a){if(a)return"table"===a.style.display&&/style="[^"]*vertical-align:\s*middle;[^"]*"/.test(a.innerHTML)?
!0:!1},ecommerceItem:function(a){if(a)return/ecommerceItem/g.test(a.className)?!0:!1},ecommerceComponent:function(a){if(a){var b=a.className;return/ecomName/g.test(b)||/ecomPrice/g.test(b)||/addToCartBtn/g.test(b)?!0:!TRIANGLE.isType.ecommerceItem(a)&&!a.querySelectorAll(".ecommerceItem").length&&0<a.querySelectorAll(".addToCartBtn").length?!0:!1}},catalog:function(a){if(a)return/catalog/g.test(a.className)?!0:!1},cart:function(a){if(a)return/cart/g.test(a.className)||0<a.querySelectorAll(".cart").length?
!0:!1},myCartBtn:function(a){if(a)return/myCartBtn/g.test(a.className)?!0:!1},addToCartBtn:function(a){if(a)return/addToCartBtn/g.test(a.className)?!0:!1},bannedInsertion:function(a){return TRIANGLE.isType.textBox(a)||TRIANGLE.isType.imageItem(a)||TRIANGLE.isType.formField(a)||TRIANGLE.isType.formBtn(a)||TRIANGLE.isType.snippetItem(a)||TRIANGLE.isType.verticalAlign(a)||"table"===a.style.display?!0:!1},preventDelete:function(a){return TRIANGLE.isType.ecommerceComponent(a)||TRIANGLE.isType.myCartBtn(a)||
TRIANGLE.isType.cart(a)?!0:!1},preventDrag:function(a){return TRIANGLE.isType.textBox(a)||TRIANGLE.isType.formField(a)||TRIANGLE.isType.imageItem(a)||TRIANGLE.isType.ecommerceItem(a)||TRIANGLE.isType.ecommerceComponent(a)?!0:!1},itemLabel:function(a){return a?"form"===a.tagName.toLowerCase()?"Form":TRIANGLE.isType.ecommerceItem(a)?"Ecommerce":TRIANGLE.isType.snippetItem(a)?"Code Snippet":!1:!1},clearFloat:function(a){if(a)return/clearFloat/g.test(a.className)?!0:!1},formField:function(a){if(a)return/formField/g.test(a.className)?
!0:!1},formBtn:function(a){if(a)return"BUTTON"===a.tagName.toUpperCase()?!0:!1},containsNbsp:function(a){return!a||"&nbsp;"!=a.innerHTML&&"&nbsp;"!=a.childNodes[0]?!1:!0}};TRIANGLE.stripNbsp=function(a){"&nbsp;"==a.childNodes[0]?a.removeChild(a.childNodes[0]):"&nbsp;"==a.innerHTML&&(a.innerHTML="")};
TRIANGLE.contentWidth=function(a){var b=document.createElement("div");b.id="measureContentWidth";a.appendChild(b);b=document.getElementById("measureContentWidth").getBoundingClientRect().width;a.removeChild(document.getElementById("measureContentWidth"));return b};TRIANGLE.randomColor=function(){return"rgb("+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+")"};TRIANGLE.getUnit=function(a){return a?(a=a.match(/\D+/g))?a[a.length-1]:!1:!1};
TRIANGLE.menu={displaySubMenu:function(a){var b=document.getElementsByClassName("subMenu");for(i=0;i<b.length;i++)b[i].style.display="none";document.getElementById(a).style.display="block"},addMenuBtnEvent:function(){var a=document.getElementsByClassName("mainOption");for(i=0;i<a.length;i++){var b=a[i].getAttribute("onClick");b+="TRIANGLE.menu.menuBtnActive(this);";a[i].setAttribute("onClick",b)}},menuBtnActive:function(a){var b=document.getElementsByClassName("mainOption");for(i=0;i<b.length;i++)b[i].style.backgroundColor=
"",b[i].style.color="";a.style.backgroundColor="#E6E6E6";a.style.color="#000000"},addOptionLabelEvents:function(){var a=document.getElementsByClassName("optionLabel");for(i=0;i<a.length;i++){var b=a[i].getAttribute("id");a[i].parentElement.setAttribute("onMouseOver","TRIANGLE.menu.optionLabel('"+b+"');");a[i].parentElement.setAttribute("onMouseOut","TRIANGLE.menu.optionLabel('"+b+"');")}},optionLabel:function(a){"block"!==document.getElementById(a).style.display?document.getElementById(a).style.display=
"block":document.getElementById(a).style.display="none"},toggleMenuDisplay:function(a,b){var c=document.getElementById("menu").querySelectorAll(".hidden");if("none"==document.getElementById(a).style.display){for(i=0;i<c.length;i++)c[i].style.display="none";document.getElementById(a).style.display=b}else document.getElementById(a).style.display="none"},sideMenuId:null,openSideMenu:function(a){TRIANGLE.menu.sideMenuId=a;document.getElementById(a).style.display="block";document.getElementById("sideMenu").className=
"sideMenuOpen"},closeSideMenu:function(){TRIANGLE.menu.sideMenuId&&(document.getElementById("sideMenu").className="sideMenuClose",document.getElementById(TRIANGLE.menu.sideMenuId).style.display="none",TRIANGLE.menu.sideMenuId=null)},displayLibraryCategory:function(a){a=document.getElementById(a);if("none"!==a.style.display)a.style.display="none";else{var b=document.getElementsByClassName("libraryCategory");for(i=0;i<b.length;i++)b[i].style.display="none";a.style.display="block"}}};
TRIANGLE.appendRow=function(){TRIANGLE.selectionBorder.remove();var a=document.createElement("div");a.className="templateItem";a.style.backgroundColor=TRIANGLE.randomColor();a.style.minHeight="100px";a.style.height="auto";a.style.width="100%";a.style.position="relative";document.getElementById("template").appendChild(a);window.scrollTo(0,document.body.scrollHeight);TRIANGLE.updateTemplateItems();TRIANGLE.clearSelection();TRIANGLE.selectItem(TRIANGLE.templateItems.length-1);TRIANGLE.saveItem.createAnimation("min-height",
0,"100px",function(){TRIANGLE.importItem.single(TRIANGLE.item.index)})};
TRIANGLE.insertNewChild=function(){if(!TRIANGLE.item||!TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef))if(!TRIANGLE.item.objRef.children[0]||"table-cell"!=TRIANGLE.item.objRef.children[0].style.display){TRIANGLE.isType.containsNbsp(TRIANGLE.item.objRef)&&TRIANGLE.stripNbsp(TRIANGLE.item.objRef);TRIANGLE.checkPadding(TRIANGLE.item.objRef);var a=document.createElement("div");a.className="templateItem childItem";a.style.backgroundColor=TRIANGLE.randomColor();a.style.minHeight="100px";a.style.height=
"auto";a.style.width="100%";a.style.position="relative";TRIANGLE.item.append(a);TRIANGLE.updateTemplateItems(!0);TRIANGLE.selectionBorder.remove();a=TRIANGLE.item.objRef.children[TRIANGLE.item.objRef.children.length-1].getAttribute("index");TRIANGLE.selectItem(a);TRIANGLE.saveItem.createAnimation("min-height",0,"100px",function(){TRIANGLE.importItem.single(TRIANGLE.item.index)});TRIANGLE.updateTemplateItems()}};
TRIANGLE.checkPadding=function(a){0!==parseInt(a.style.paddingLeft)&&a.style.paddingLeft||0!==parseInt(a.style.paddingRight)&&a.style.paddingRight||0!==parseInt(a.style.paddingTop)&&a.style.paddingTop||0!==parseInt(a.style.paddingBottom)&&a.style.paddingBottom||(a.style.paddingTop="10px",a.style.paddingRight="10px",a.style.paddingBottom="10px",a.style.paddingLeft="10px")};
TRIANGLE.generateBorder=function(a){var b=document.createElement("div");b.style.border="1px solid orange";b.setAttribute("id","showHoverBorder");b.style.position="fixed";b.style.height=a.height+6+"px";b.style.width=a.width+6+"px";b.style.top=a.top-3+"px";b.style.left=a.left-3+"px";b.style.zIndex=1;a=document.createElement("div");a.style.height="100%";a.style.width="100%";a.style.border="1px solid blue";a.style.padding="1px";a.setAttribute("id","noClickThru");b.appendChild(a);return b};
TRIANGLE.hoveredElem=!1;
TRIANGLE.hoverBorder={show:function(a){if(!(TRIANGLE.resize.active||TRIANGLE.saveItem.animationActive||TRIANGLE.images.crop.active)){TRIANGLE.hoverBorder.hide();a=this.getBoundingClientRect();document.getElementById("template").appendChild(TRIANGLE.generateBorder(a));TRIANGLE.hoveredElem=this;a=TRIANGLE.isType.itemLabel(this);var b=this.getAttribute("user-id"),c=this.getAttribute("user-class"),d=this.getAttribute("href")||this.getAttribute("link-to");if(a){document.addEventListener("mousemove",TRIANGLE.hoverBorder.updateItemLabel);
var e=a;a="block"}else b?(document.addEventListener("mousemove",TRIANGLE.hoverBorder.updateItemLabel),e=b,a="block"):c?(document.addEventListener("mousemove",TRIANGLE.hoverBorder.updateItemLabel),e=c,a="block"):d?(document.addEventListener("mousemove",TRIANGLE.hoverBorder.updateItemLabel),30<d.length&&(d=d.slice(0,30)+"..."),e=d,a="block"):(document.removeEventListener("mousemove",TRIANGLE.hoverBorder.updateItemLabel),a="none");document.getElementById("itemTypeLabel").innerHTML=e;document.getElementById("itemTypeLabel").style.display=
a}},updateItemLabel:function(a){document.getElementById("itemTypeLabel").style.top=a.clientY+15+"px";document.getElementById("itemTypeLabel").style.left=a.clientX+15+"px"},hide:function(){document.getElementById("showHoverBorder")&&(document.getElementById("template").removeChild(document.getElementById("showHoverBorder")),TRIANGLE.hoveredElem=!1,document.getElementById("itemTypeLabel").style.display="none",document.removeEventListener("mousemove",TRIANGLE.hoverBorder.updateItemLabel))}};
TRIANGLE.selectionBorder={create:function(){if(TRIANGLE.item){TRIANGLE.hoverBorder.hide();TRIANGLE.selectionBorder.remove();var a=TRIANGLE.item.objRef.getBoundingClientRect();document.getElementById("template").appendChild(TRIANGLE.generateBorder(a));document.getElementById("showHoverBorder").setAttribute("id","selectionBorder");a=document.getElementById("selectionBorder");a.style.border=TRIANGLE.item.objRef.isContentEditable?"1px dashed black":"1px solid #00ff00";a.style.zIndex=2;TRIANGLE.resize.showHandles()}else document.getElementById("showHoverBorder")&&
(document.getElementById("showHoverBorder").id="selectionBorder",a=document.getElementById("selectionBorder"),a.style.border="1px solid #00ff00",TRIANGLE.resize.showHandles());TRIANGLE.unsaved=!0},remove:function(){document.getElementById("selectionBorder")&&(document.getElementById("template").removeChild(document.getElementById("selectionBorder")),TRIANGLE.resize.removeHandles())},update:function(){document.getElementById("selectionBorder")&&(TRIANGLE.selectionBorder.remove(),TRIANGLE.selectionBorder.create())}};
TRIANGLE.resize={showHandles:function(){if("table-cell"!==TRIANGLE.item.display&&!TRIANGLE.item.objRef.isContentEditable){var a=TRIANGLE.scrollbarWidth,b=TRIANGLE.item.objRef.getBoundingClientRect(),c=document.getElementById("selectionBorder"),d=TRIANGLE.isType.imageItem(TRIANGLE.item.objRef),e=document.createElement("div");e.style.width="8px";e.style.height="8px";e.style.cursor="row-resize";e.className="marginHandle";e.style.top=b.top-4-2+"px";e.style.left=b.left+(b.width/2-4)+"px";c.appendChild(e);
e.addEventListener("mouseover",TRIANGLE.resize.margin.top);e.addEventListener("mousedown",TRIANGLE.resize.margin.initiate);d||(e=document.createElement("div"),e.style.width="8px",e.style.height="8px",e.style.cursor="s-resize",e.className="resizeHandle",e.style.top=b.bottom-2+"px",e.style.left=b.left+(b.width/2-4)+"px",c.appendChild(e),e.addEventListener("mouseover",TRIANGLE.resize.Y),e.addEventListener("mousedown",TRIANGLE.resize.initiate));d&&("right"!=TRIANGLE.item.align?(e=document.createElement("div"),
e.style.width="8px",e.style.height="8px",e.style.cursor="ne-resize",e.className="resizeHandle",e.style.top=b.top-8+2+"px",e.style.left=b.right>=window.innerWidth-a?window.innerWidth-a-8+"px":b.right-2+"px",c.appendChild(e),e.addEventListener("mouseover",TRIANGLE.resize.XY),e.addEventListener("mousedown",TRIANGLE.resize.initiate),e=document.createElement("div"),e.style.width="8px",e.style.height="8px",e.style.cursor="se-resize",e.className="resizeHandle",e.style.top=b.bottom-2+"px",e.style.left=b.right>=
window.innerWidth-a?window.innerWidth-a-8+"px":b.right-2+"px"):(e=document.createElement("div"),e.style.width="8px",e.style.height="8px",e.style.cursor="nw-resize",e.className="resizeHandle",e.style.top=b.top-8+2+"px",e.style.left=0>=b.left?"5px":b.left-4-2+"px",c.appendChild(e),e.addEventListener("mouseover",TRIANGLE.resize.XY),e.addEventListener("mousedown",TRIANGLE.resize.initiate),e=document.createElement("div"),e.style.width="8px",e.style.height="8px",e.style.cursor="sw-resize",e.className="resizeHandle",
e.style.top=b.bottom-2+"px",e.style.left=0>=b.left?"5px":b.left-4-2+"px"),c.appendChild(e),e.addEventListener("mouseover",TRIANGLE.resize.XY),e.addEventListener("mousedown",TRIANGLE.resize.initiate));"right"!==TRIANGLE.item.align?(e=document.createElement("div"),e.style.width="8px",e.style.height="8px",e.style.cursor="e-resize",e.className="resizeHandle",e.style.top=b.top+(b.height/2-4)+"px",e.style.left=b.right>=window.innerWidth-a?window.innerWidth-a-8+"px":b.right-2+"px",c.appendChild(e),d?e.addEventListener("mouseover",
TRIANGLE.resize.XY):e.addEventListener("mouseover",TRIANGLE.resize.X),e.addEventListener("mousedown",TRIANGLE.resize.initiate),e=document.createElement("div"),e.style.width="8px",e.style.height="8px",e.style.cursor="col-resize",e.className="marginHandle",e.style.top=b.top+(b.height/2-4)+"px",e.style.left=0>=b.left?"5px":b.left-4-2+"px",c.appendChild(e),e.addEventListener("mouseover",TRIANGLE.resize.margin.left)):(e=document.createElement("div"),e.style.width="8px",e.style.height="8px",e.style.cursor=
"e-resize",e.className="resizeHandle",e.style.top=b.top+(b.height/2-4)+"px",e.style.left=0>=b.left?"5px":b.left-4-2+"px",c.appendChild(e),d?e.addEventListener("mouseover",TRIANGLE.resize.XY):e.addEventListener("mouseover",TRIANGLE.resize.X),e.addEventListener("mousedown",TRIANGLE.resize.initiate),e=document.createElement("div"),e.style.width="8px",e.style.height="8px",e.style.cursor="col-resize",e.className="marginHandle",e.style.top=b.top+(b.height/2-4)+"px",e.style.left=b.right>=window.innerWidth-
a?window.innerWidth-a-8+"px":b.right-2+"px",c.appendChild(e),e.addEventListener("mouseover",TRIANGLE.resize.margin.right));e.addEventListener("mousedown",TRIANGLE.resize.margin.initiate)}},activeElem:-1,active:!1,direction:"X or Y or XY",XYratio:null,contentWidth:null,X:function(){TRIANGLE.resize.active||(TRIANGLE.resize.activeElem=TRIANGLE.item.index,TRIANGLE.resize.direction="X")},Y:function(){TRIANGLE.resize.active||(TRIANGLE.resize.activeElem=TRIANGLE.item.index,TRIANGLE.resize.direction="Y")},
XY:function(){if(!TRIANGLE.resize.active){TRIANGLE.resize.activeElem=TRIANGLE.item.index;TRIANGLE.resize.direction="XY";var a=TRIANGLE.item.objRef.getBoundingClientRect();TRIANGLE.resize.XYratio=a.width/a.height}},initiate:function(a){TRIANGLE.resize.active=!0;TRIANGLE.selectItem(TRIANGLE.resize.activeElem);document.body.addEventListener("mouseup",TRIANGLE.resize.stop);document.body.addEventListener("mousemove",TRIANGLE.resize.start);TRIANGLE.item.objRef.style.maxWidth="100%";document.getElementById("dimensionLabels").style.display=
"inline-block";document.getElementById("widthLabel").innerHTML="W: "+TRIANGLE.item.width;document.getElementById("heightLabel").innerHTML="H: "+TRIANGLE.item.minHeight;TRIANGLE.resize.contentWidth=TRIANGLE.contentWidth(TRIANGLE.item.parent);TRIANGLE.text.preventTextSelect()},stop:function(){TRIANGLE.importItem.single(TRIANGLE.item.index);TRIANGLE.resize.activeElem=-1;TRIANGLE.resize.active=!1;TRIANGLE.resize.direction=!1;TRIANGLE.resize.contentWidth=null;document.getElementById("bottomMarker").style.marginTop=
0;TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)||(TRIANGLE.item.objRef.style.maxWidth="");"%"===TRIANGLE.getUnit(TRIANGLE.item.width)&&100<parseFloat(TRIANGLE.item.width)?(TRIANGLE.item.objRef.style.width="100%",TRIANGLE.updateTemplateItems(),TRIANGLE.importItem.single(TRIANGLE.item.index)):"%"!==TRIANGLE.getUnit(TRIANGLE.item.width)&&parseFloat(TRIANGLE.item.width)>TRIANGLE.item.parent.getBoundingClientRect().width&&(TRIANGLE.item.objRef.style.width="100%",TRIANGLE.updateTemplateItems(),TRIANGLE.importItem.single(TRIANGLE.item.index));
TRIANGLE.item.objRef.style.width=document.getElementById("widthLabel").innerHTML.replace(/W: /g,"");document.body.removeEventListener("mouseup",TRIANGLE.resize.stop);document.body.removeEventListener("mousemove",TRIANGLE.resize.start);TRIANGLE.selectionBorder.create();TRIANGLE.text.clearTextSelection();TRIANGLE.saveItem.equalizeUserClasses(TRIANGLE.item.userClass);TRIANGLE.text.allowTextSelect()},start:function(a){function b(){var a=!1,b=TRIANGLE.templateItems.length;for(i=0;i<b;i++)if(TRIANGLE.item.isAbove(i)||
TRIANGLE.item.isBelow(i))e>=TRIANGLE.columnMap.left[i]-3&&e<=TRIANGLE.columnMap.left[i]+3?(e=TRIANGLE.columnMap.left[i],a=!0):e>=TRIANGLE.columnMap.right[i]-3&&e<=TRIANGLE.columnMap.right[i]+3&&(e=TRIANGLE.columnMap.right[i],a=!0);return a}function c(){var a=!1,b=d.nextSibling()?d.nextSibling().getAttribute("index"):null;TRIANGLE.item.isBelow(parseInt(b))||(d.nextSibling()&&g>=d.nextSibling().getBoundingClientRect().bottom-3&&g<=d.nextSibling().getBoundingClientRect().bottom+3?(d.objRef.style.minHeight=
d.nextSibling().getBoundingClientRect().bottom-f.top+"px",a=!0):d.prevSibling()&&g>=d.prevSibling().getBoundingClientRect().bottom-3&&g<=d.prevSibling().getBoundingClientRect().bottom+3&&(d.objRef.style.minHeight=d.prevSibling().getBoundingClientRect().bottom-f.top+"px",a=!0));return a}TRIANGLE.locateColumns();var d=TRIANGLE.item;if(TRIANGLE.resize.active){var e=a.clientX,g=a.clientY,f=TRIANGLE.item.objRef.getBoundingClientRect(),m=TRIANGLE.item.parent.getBoundingClientRect();a=document.getElementById("widthLabel");
var l=document.getElementById("heightLabel");if("X"===TRIANGLE.resize.direction){if("right"!==d.align&&e>f.left+2){b();l=TRIANGLE.item.nextSibling()?TRIANGLE.item.nextSibling().getBoundingClientRect():null;var h=TRIANGLE.item.prevSibling()?TRIANGLE.item.prevSibling().getBoundingClientRect():null;l&&e>=l.left-3&&e<=l.left+3&&(e=l.left);"%"===TRIANGLE.getUnit(d.width)?(d.objRef.style.width=e<=f.left+TRIANGLE.resize.contentWidth/2+3&&e>=f.left+TRIANGLE.resize.contentWidth/2-3?"50%":e<=f.left+TRIANGLE.resize.contentWidth/
3+3&&e>=f.left+TRIANGLE.resize.contentWidth/3-3?"33.33%":e<=f.left+2*TRIANGLE.resize.contentWidth/3+3&&e>=f.left+2*TRIANGLE.resize.contentWidth/3-3?"66.66%":Math.ceil((e-f.left)/TRIANGLE.resize.contentWidth*1E4)/100+"%",100<parseFloat(d.objRef.style.width)?a.innerHTML="W: 100%":a.innerHTML="W: "+d.objRef.style.width):parseFloat(d.objRef.style.width)>m.width?(d.objRef.style.width=Math.floor(e-f.left)+"px",a.innerHTML="W: 100%"):(d.objRef.style.width=Math.floor(e-f.left)+"px",a.innerHTML="W: "+d.objRef.style.width)}else if("right"===
d.align&&e<f.right-2){b();l=TRIANGLE.item.nextSibling()?TRIANGLE.item.nextSibling().getBoundingClientRect():null;if((h=TRIANGLE.item.prevSibling()?TRIANGLE.item.prevSibling().getBoundingClientRect():null)&&e<=h.right+3&&e>=h.right-3)e=h.right;else for(i=0;i<TRIANGLE.templateItems.length;i++)e<=TRIANGLE.columnMap.right[i]+3&&e>=TRIANGLE.columnMap.right[i]-3&&(e=TRIANGLE.columnMap.right[i]);"%"===TRIANGLE.getUnit(d.width)?(d.objRef.style.width=e<=f.right-TRIANGLE.resize.contentWidth/2+3&&e>=f.right-
TRIANGLE.resize.contentWidth/2-3?"50%":e<=f.right-TRIANGLE.resize.contentWidth/3+3&&e>=f.right-TRIANGLE.resize.contentWidth/3-3?"33.33%":e<=f.right-2*TRIANGLE.resize.contentWidth/3+3&&e>=f.right-2*TRIANGLE.resize.contentWidth/3-3?"66.66%":Math.ceil((f.right-e)/TRIANGLE.resize.contentWidth*1E4)/100+"%",100<parseFloat(d.objRef.style.width)?a.innerHTML="W: 100%":a.innerHTML="W: "+d.objRef.style.width):parseFloat(d.objRef.style.width)>m.width?(d.objRef.style.width=Math.floor(f.right-e)+"px",a.innerHTML=
"W: 100%"):(d.objRef.style.width=Math.floor(f.right-e)+"px",a.innerHTML="W: "+d.objRef.style.width)}else return;TRIANGLE.selectionBorder.update()}else if("Y"===TRIANGLE.resize.direction){if(g>f.top+2){d.objRef.style.minHeight=Math.floor(g-f.top)+"px";TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)&&(d.objRef.style.height=d.objRef.style.minHeight);if(d.transform||"table"==d.display)d.objRef.style.height=d.objRef.style.minHeight;d.isLastChild&&(document.getElementById("bottomMarker").style.marginTop=
window.innerHeight+"px");c()}else return;TRIANGLE.selectionBorder.update();l.innerHTML="H: "+d.objRef.style.minHeight}else if("XY"===TRIANGLE.resize.direction){if("right"!==TRIANGLE.item.align){if(e>f.left+2){m=b();h=Math.round(e-f.left);if(h>TRIANGLE.resize.contentWidth)return;d.objRef.style.width=h+"px";d.objRef.style.minHeight=Math.round(h/TRIANGLE.resize.XYratio)+"px";d.objRef.style.height=d.objRef.style.minHeight;h=c();if(m||h){TRIANGLE.selectionBorder.update();return}}}else if(e<f.right-2){m=
b();h=Math.round(f.right-e);if(h>TRIANGLE.resize.contentWidth)return;d.objRef.style.width=h+"px";d.objRef.style.minHeight=Math.round(h/TRIANGLE.resize.XYratio)+"px";d.objRef.style.height=d.objRef.style.minHeight;h=c();if(m||h()){TRIANGLE.selectionBorder.update();return}}a.innerHTML="W: "+d.objRef.style.width;l.innerHTML="H: "+d.objRef.style.minHeight}TRIANGLE.selectionBorder.create();TRIANGLE.saveItem.equalizeUserClasses(TRIANGLE.item.userClass)}TRIANGLE.text.clearTextSelection()},removeHandles:function(){for(;0<
document.getElementsByClassName("resizeHandle").length;){var a=document.getElementsByClassName("resizeHandle");a[0].removeEventListener("mouseover",TRIANGLE.resize.Y);a[0].removeEventListener("mouseover",TRIANGLE.resize.X);a[0].removeEventListener("mouseover",TRIANGLE.resize.XY);a[0].remove()}for(;0<document.getElementsByClassName("marginHandle").length;)a=document.getElementsByClassName("marginHandle"),a[0].removeEventListener("mouseover",TRIANGLE.resize.margin.top),a[0].removeEventListener("mouseover",
TRIANGLE.resize.margin.right),a[0].removeEventListener("mouseover",TRIANGLE.resize.margin.bottom),a[0].removeEventListener("mouseover",TRIANGLE.resize.margin.left),a[0].remove()},margin:{top:function(){TRIANGLE.resize.active||(TRIANGLE.resize.activeElem=TRIANGLE.item.index,TRIANGLE.resize.direction="marginTop")},bottom:function(){TRIANGLE.resize.active||(TRIANGLE.resize.activeElem=TRIANGLE.item.index,TRIANGLE.resize.direction="marginBottom")},left:function(){TRIANGLE.resize.active||(TRIANGLE.resize.activeElem=
TRIANGLE.item.index,TRIANGLE.resize.direction="marginLeft")},right:function(){TRIANGLE.resize.active||(TRIANGLE.resize.activeElem=TRIANGLE.item.index,TRIANGLE.resize.direction="marginRight")},side:null,currentMargin:null,initiate:function(){TRIANGLE.resize.active=!0;TRIANGLE.selectItem(TRIANGLE.resize.activeElem);document.body.addEventListener("mouseup",TRIANGLE.resize.margin.stop);document.body.addEventListener("mousemove",TRIANGLE.resize.margin.start);document.getElementById("dimensionLabels").style.display=
"inline-block";document.getElementById("widthLabel").innerHTML="M: "+TRIANGLE.item[TRIANGLE.resize.direction];document.getElementById("heightLabel").innerHTML="";TRIANGLE.resize.margin.side=TRIANGLE.resize.direction.replace(/margin/,"").toLowerCase();TRIANGLE.resize.margin.currentMargin=TRIANGLE.item.objRef.getBoundingClientRect()[TRIANGLE.resize.margin.side]-parseFloat(window.getComputedStyle(TRIANGLE.item.objRef).getPropertyValue(TRIANGLE.resize.direction.replace(/([A-Z])/,"-$1").toLowerCase()));
TRIANGLE.text.preventTextSelect()},stop:function(){TRIANGLE.importItem.single(TRIANGLE.item.index);TRIANGLE.resize.activeElem=-1;TRIANGLE.resize.active=!1;TRIANGLE.resize.direction=!1;document.getElementById("bottomMarker").style.marginTop=0;TRIANGLE.updateTemplateItems();TRIANGLE.importItem.single(TRIANGLE.item.index);document.body.removeEventListener("mouseup",TRIANGLE.resize.margin.stop);document.body.removeEventListener("mousemove",TRIANGLE.resize.margin.start);TRIANGLE.selectionBorder.create();
TRIANGLE.text.clearTextSelection();TRIANGLE.text.allowTextSelect();TRIANGLE.saveItem.equalizeUserClasses(TRIANGLE.item.userClass)},start:function(a){var b=TRIANGLE.item;if(TRIANGLE.resize.active){b.objRef.getBoundingClientRect();var c=document.getElementById("widthLabel");if("marginTop"===TRIANGLE.resize.direction||"marginBottom"===TRIANGLE.resize.direction){var d="marginTop"===TRIANGLE.resize.direction?"marginBottom":"marginTop";var e=a.clientY;var g=e<TRIANGLE.resize.margin.currentMargin}else if("marginLeft"===
TRIANGLE.resize.direction||"marginRight"===TRIANGLE.resize.direction)d="marginLeft"===TRIANGLE.resize.direction?"marginRight":"marginLeft",e=a.clientX,g="marginLeft"===TRIANGLE.resize.direction?e<TRIANGLE.resize.margin.currentMargin:e>TRIANGLE.resize.margin.currentMargin;else return;"%"===TRIANGLE.getUnit(b[TRIANGLE.resize.direction])?b.objRef.style[TRIANGLE.resize.direction]=Math.abs(Math.ceil((e-TRIANGLE.resize.margin.currentMargin)/b.parent.getBoundingClientRect().width*1E4)/100)+"%":b.objRef.style[TRIANGLE.resize.direction]=
Math.abs(e-TRIANGLE.resize.margin.currentMargin)+"px";g&&(b.objRef.style[TRIANGLE.resize.direction]=0);if("top"===TRIANGLE.resize.margin.side||"bottom"===TRIANGLE.resize.margin.side){g=b.nextSibling()?b.nextSibling().getBoundingClientRect():!1;var f=b.prevSibling()?b.prevSibling().getBoundingClientRect():!1;g&&e>=g[TRIANGLE.resize.margin.side]-3&&e<=g[TRIANGLE.resize.margin.side]+3?b.objRef.style[TRIANGLE.resize.direction]=b.nextSibling().style[TRIANGLE.resize.direction]:f&&e>=f[TRIANGLE.resize.margin.side]-
3&&e<=f[TRIANGLE.resize.margin.side]+3&&(b.objRef.style[TRIANGLE.resize.direction]=b.prevSibling().style[TRIANGLE.resize.direction])}a.altKey&&(b.objRef.style[d]=b.objRef.style[TRIANGLE.resize.direction]);c.innerHTML="M: "+b.objRef.style[TRIANGLE.resize.direction]}}}};
TRIANGLE.importItem={group:[],groupIndex:function(a,b){a=parseInt(a);if(-1===TRIANGLE.importItem.group.indexOf(a))TRIANGLE.importItem.group[TRIANGLE.importItem.group.length]=a,TRIANGLE.importItem.group.sort();else if(1<TRIANGLE.importItem.group.length){var c=TRIANGLE.importItem.group.indexOf(parseInt(a));TRIANGLE.importItem.group.splice(c,1)}},currentUserClass:!1,single:function(a,b){function c(a,b,c){document.getElementById(a).setAttribute("onClick",b+"("+c+");")}if(isNaN(parseInt(a))){b=a;try{a=
this.getAttribute("index")}catch(e){console.log(e.message);return}b.shiftKey?TRIANGLE.importItem.groupIndex(a,b):TRIANGLE.importItem.group=[parseInt(a)]}else b&&b.shiftKey?TRIANGLE.importItem.groupIndex(a,b):isNaN(parseInt(a))||(TRIANGLE.importItem.group=[parseInt(a)]);var d=a;if(1<arguments.length)d=arguments[0];else if(1===arguments.length&&(/\d/.test(arguments[0])||parseInt(arguments[0])))d=arguments[0];else if(this)d=this.getAttribute("index");else return;TRIANGLE.selectItem(d);TRIANGLE.selectionBorder.create(b);
document.body.addEventListener("keyup",TRIANGLE.keyEvents.whichKey.item);(function(){var a=TRIANGLE.item.bgColor;/rgba/.test(a)||(a=TRIANGLE.colors.rgbToHex(TRIANGLE.item.bgColor));document.getElementById("bgColor").value=a})();(function(){var a=TRIANGLE.item.minHeight;document.getElementById("height").value=a;document.getElementById("heightLabel").innerHTML="H: "+a;document.getElementById("dimensionLabels").style.display="inline-block"})();(function(){var a=TRIANGLE.item.width;document.getElementById("width").value=
a;document.getElementById("widthLabel").innerHTML="W: "+a;document.getElementById("dimensionLabels").style.display="inline-block"})();(function(){var a=TRIANGLE.item.display;document.getElementById("display").value=a})();(function(){var a=TRIANGLE.item.paddingLeft,b=TRIANGLE.item.paddingRight,c=TRIANGLE.item.paddingTop,d=TRIANGLE.item.paddingBottom,l=document.getElementById("paddingL"),h=document.getElementById("paddingR"),n=document.getElementById("paddingT"),p=document.getElementById("paddingB");
l.value=a;h.value=b;n.value=c;p.value=d})();(function(){var a=TRIANGLE.item.marginLeft,b=TRIANGLE.item.marginRight,c=TRIANGLE.item.marginTop,d=TRIANGLE.item.marginBottom,l=document.getElementById("marginL"),h=document.getElementById("marginR"),n=document.getElementById("marginT"),p=document.getElementById("marginB");l.value=a;h.value=b;n.value=c;p.value=d})();(function(){var a=TRIANGLE.item.borderLeftWidth,b=TRIANGLE.item.borderLeftStyle,c=TRIANGLE.item.borderLeftColor,d=document.getElementById("borderLwidth"),
l=document.getElementById("borderLtype"),h=document.getElementById("borderLcolor");d.value=a?parseInt(a):"";"solid"===b?l.selectedIndex=0:"dashed"===b?l.selectedIndex=1:"dotted"===b&&(l.selectedIndex=2);""!==d.value&&(/rgb/.test(c)?h.value=TRIANGLE.colors.rgbToHex(c):h.value=c);a=TRIANGLE.item.borderRightWidth;b=TRIANGLE.item.borderRightStyle;c=TRIANGLE.item.borderRightColor;d=document.getElementById("borderRwidth");l=document.getElementById("borderRtype");h=document.getElementById("borderRcolor");
d.value=a?parseInt(a):"";"solid"===b?l.selectedIndex=0:"dashed"===b?l.selectedIndex=1:"dotted"===b&&(l.selectedIndex=2);""!==d.value&&(/rgb/.test(c)?h.value=TRIANGLE.colors.rgbToHex(c):h.value=c);a=TRIANGLE.item.borderTopWidth;b=TRIANGLE.item.borderTopStyle;c=TRIANGLE.item.borderTopColor;d=document.getElementById("borderTwidth");l=document.getElementById("borderTtype");h=document.getElementById("borderTcolor");d.value=a?parseInt(a):"";"solid"===b?l.selectedIndex=0:"dashed"===b?l.selectedIndex=1:"dotted"===
b&&(l.selectedIndex=2);""!==d.value&&(/rgb/.test(c)?h.value=TRIANGLE.colors.rgbToHex(c):h.value=c);a=TRIANGLE.item.borderBottomWidth;b=TRIANGLE.item.borderBottomStyle;c=TRIANGLE.item.borderBottomColor;d=document.getElementById("borderBwidth");l=document.getElementById("borderBtype");h=document.getElementById("borderBcolor");d.value=a?parseInt(a):"";"solid"===b?l.selectedIndex=0:"dashed"===b?l.selectedIndex=1:"dotted"===b&&(l.selectedIndex=2);""!==d.value&&(/rgb/.test(c)?h.value=TRIANGLE.colors.rgbToHex(c):
h.value=c)})();(function(){var a=TRIANGLE.item.boxShadow.replace(/rgb\((\d+), (\d+), (\d+)\)/g,"rgb($1,$2,$3)").split(" "),b=document.getElementById("boxShadowH"),c=document.getElementById("boxShadowV"),d=document.getElementById("boxShadowBlur"),l=document.getElementById("boxShadowColor");isNaN(parseInt(a[0]))?(l.value=a[0],b.value=a[1],c.value=a[2],d.value=a[3]):isNaN(parseInt(a[1]))?(l.value=a[1],b.value=a[0],c.value=a[2],d.value=a[3]):isNaN(parseInt(a[2]))?(l.value=a[2],b.value=a[0],c.value=a[1],
d.value=a[3]):isNaN(parseInt(a[3]))&&(l.value=a[3],b.value=a[0],c.value=a[1],d.value=a[2]);if(""==b.value||"undefined"==b.value)b.value="";if(""==c.value||"undefined"==c.value)c.value="";if(""==d.value||"undefined"==d.value)d.value="";if(""==l.value||"undefined"==l.value)l.value="black"})();TRIANGLE.importItem.importColors();(function(){var a=TRIANGLE.colors.rgbToHex(TRIANGLE.item.fontColor),b=document.getElementById("fontColor"),c=TRIANGLE.item.fontSize,d=document.getElementById("fontSize"),l=TRIANGLE.item.lineHeight,
h=document.getElementById("fontLineHeight"),n=document.getElementById("fontType");b.value=a;d.value=isNaN(parseFloat(c))?null:parseFloat(c);h.value=l;for(i=0;i<n.options.length;i++)if(n.options[i].text==TRIANGLE.item.fontFamily.replace(/'|"/g,"")){n.selectedIndex=i;break}})();TRIANGLE.item.userID?document.getElementById("userID").value=TRIANGLE.item.userID:document.getElementById("userID").value="";TRIANGLE.item.userClass?(document.getElementById("userClass").value=TRIANGLE.item.userClass,TRIANGLE.importItem.currentUserClass=
TRIANGLE.item.objRef):(document.getElementById("userClass").value="",TRIANGLE.importItem.currentUserClass=!1);(function(){if(null===TRIANGLE.text.importedHyperlink){var a=TRIANGLE.item.objRef.firstChild?TRIANGLE.item.objRef.firstChild.tagName:null;TRIANGLE.item.linkTo||"A"===a?(a=TRIANGLE.item.linkTo?TRIANGLE.item.linkTo:TRIANGLE.item.objRef.children[0].getAttribute("href"))?(document.getElementById("hrefHyperlink").disabled=!1,document.getElementById("hrefHyperlink").value=a):document.getElementById("hrefHyperlink").disabled=
!0:document.getElementById("hrefHyperlink").disabled=!0}})();(function(){if(null===TRIANGLE.text.importedHyperlink){var a=TRIANGLE.item.objRef.firstChild?TRIANGLE.item.objRef.firstChild.tagName:null,b=document.getElementById("hrefTarget");if(1===TRIANGLE.item.objRef.children.length&&"A"===a){a=TRIANGLE.item.objRef.children[0].getAttribute("target");b.disabled=!1;var c=0;for(i=0;i<b.length;i++)a===b.options[i].text&&(c=i);b.selectedIndex=c}else if(TRIANGLE.item.linkTo){a=TRIANGLE.item.objRef.getAttribute("target");
b.disabled=!1;for(i=c=0;i<b.length;i++)a===b.options[i].text&&(c=i);b.selectedIndex=c}else b.selectedIndex=0,b.disabled=!0}})();(function(){if(TRIANGLE.isType.snippetItem(TRIANGLE.item.objRef)){var a=TRIANGLE.item.objRef.innerHTML;document.getElementById("snippetInsertion").value=a;"snippetInsertion"===TRIANGLE.developer.currentCode&&(document.getElementById("codeEditor").value=a)}else document.getElementById("snippetInsertion").value="","snippetInsertion"===TRIANGLE.developer.currentCode&&(document.getElementById("codeEditor").value=
"")})();TRIANGLE.item.readEcomData?(document.getElementById("ecomItemName").value=TRIANGLE.item.ecom.itemName?TRIANGLE.item.ecom.itemName:"",document.getElementById("ecomItemID").value=TRIANGLE.item.ecom.itemID?TRIANGLE.item.ecom.itemID:"",document.getElementById("ecomPrice").value=TRIANGLE.item.ecom.price?TRIANGLE.item.ecom.price:"",document.getElementById("ecomQuantity").value=TRIANGLE.item.ecom.quantity?TRIANGLE.item.ecom.quantity:"",document.getElementById("ecomDesc").value=TRIANGLE.item.ecom.description?
TRIANGLE.item.ecom.description:"",document.getElementById("ecomShipping").value=TRIANGLE.item.ecom.shipping?TRIANGLE.item.ecom.shipping:"",document.getElementById("ecomTax").checked=TRIANGLE.item.ecom.tax,document.getElementById("USPSflatRateSelect").selectedIndex=0,document.getElementById("USPSshapeSelect").selectedIndex=0,document.getElementById("USPSweight").style.display="none",document.getElementById("USPSdimensions").style.display="none",TRIANGLE.item.ecom.usps&&/PRIORITY/.test(TRIANGLE.item.ecom.usps.service)?
document.getElementById("USPSflatRateSelect").value=TRIANGLE.item.ecom.usps.value:TRIANGLE.item.ecom.usps&&"FIRST CLASS"===TRIANGLE.item.ecom.usps.service&&(document.getElementById("USPSshapeSelect").value=TRIANGLE.item.ecom.usps.value,0<document.getElementById("USPSshapeSelect").selectedIndex&&(document.getElementById("USPSweight").style.display="block",document.getElementById("USPSpounds").value=TRIANGLE.item.ecom.usps.pounds?TRIANGLE.item.ecom.usps.pounds:"",document.getElementById("USPSounces").value=
TRIANGLE.item.ecom.usps.ounces?TRIANGLE.item.ecom.usps.ounces:"","LARGE"===TRIANGLE.item.ecom.usps.size&&(document.getElementById("USPSdimensions").style.display="block",document.getElementById("USPSlength").value=TRIANGLE.item.ecom.usps.length?TRIANGLE.item.ecom.usps.length:"",document.getElementById("USPSwidth").value=TRIANGLE.item.ecom.usps.width?TRIANGLE.item.ecom.usps.width:"",document.getElementById("USPSheight").value=TRIANGLE.item.ecom.usps.height?TRIANGLE.item.ecom.usps.height:"")))):document.getElementById("ecomTax").checked=
!1;"form"===TRIANGLE.item.tag.toLowerCase()&&TRIANGLE.item.objRef.getAttribute("form-email")?document.getElementById("formEmail").value=TRIANGLE.item.objRef.getAttribute("form-email"):document.getElementById("formEmail").value="";(function(){var a=TRIANGLE.item.objRef.style.cssText.replace(/;\s*/g,";\n");document.getElementById("cssStyles").value=a;"cssStyles"===TRIANGLE.developer.currentCode&&(document.getElementById("codeEditor").value=a)})();(function(){if(TRIANGLE.item.objRef.getAttribute("hover-style")){var a=
TRIANGLE.item.objRef.getAttribute("hover-style").replace(/;\s*/g,";\n");document.getElementById("hoverStyles").value=a;"hoverStyles"===TRIANGLE.developer.currentCode&&(document.getElementById("codeEditor").value=a)}})();document.getElementById("opDuplicateElement").addEventListener("click",TRIANGLE.options.duplicate);document.getElementById("opInsertNewChild").addEventListener("click",TRIANGLE.insertNewChild);c("insert2columns","TRIANGLE.options.insertColumns","2");c("insert3columns","TRIANGLE.options.insertColumns",
"3");c("opDeleteElement","TRIANGLE.deleteItem",TRIANGLE.item.index);c("opShiftUp","TRIANGLE.options.shiftUp",TRIANGLE.item.index);c("opShiftDown","TRIANGLE.options.shiftDown",TRIANGLE.item.index);c("opCopyStyles","TRIANGLE.options.copyStyles",TRIANGLE.item.index);c("opPasteStyles","TRIANGLE.options.pasteStyles",TRIANGLE.item.index);(function(){var a=document.getElementById("menu").getElementsByTagName("input");for(i=0;i<a.length;i++)a[i].removeEventListener("keyup",TRIANGLE.saveItem.applyChanges),
a[i].addEventListener("keyup",TRIANGLE.saveItem.applyChanges)})();document.getElementById("opDeleteElement").style.display="block";document.getElementById("opShiftUp").style.display="block";document.getElementById("opShiftDown").style.display="block";document.getElementById("opCopyStyles").style.display="block";document.getElementById("opDeselect").style.display="block";document.getElementById("insert2columns").style.display="inline-block";document.getElementById("insert3columns").style.display="inline-block";
document.getElementById("opDuplicateElement").style.display="inline-block";document.getElementById("opInsertNewChild").style.display="inline-block";document.getElementById("opHyperlink").style.display="inline-block";TRIANGLE.updateTemplateItems()},importColors:function(){function a(a){return"initial"==a||/-/g.test(a)||"currentColor"==a?!0:!1}var b=TRIANGLE.item,c=document.getElementById("colorListBorderL"),d=document.getElementById("colorListBorderR"),e=document.getElementById("colorListBorderT"),
g=document.getElementById("colorListBorderB"),f=document.getElementById("opColorElementBg"),m=document.getElementById("opColorBorder"),l=document.getElementById("opColorBoxShadow");f.style.display="none";m.style.display="none";l.style.display="none";""!==b.bgColor&&(document.getElementById("opColorElementBg").style.display="inline-block","inherit"==b.bgColor?document.getElementById("colorElementBg").style.backgroundColor=b.parent.style.backgroundColor:document.getElementById("colorElementBg").style.backgroundColor=
b.bgColor);if(""!==b.borderLeftColor||""!==b.borderRightColor||""!==b.borderTopColor||""!==b.borderBottomColor)document.getElementById("opColorBorder").style.display="inline-block",f=0,""!==b.borderLeftColor&&""!==b.borderLeftWidth&&""!==b.borderLeftColor?(c.style.display="inline-block",a(b.borderLeftColor)&&(b.objRef.style.borderLeftColor="black",b.borderLeftColor="black"),c.style.backgroundColor=b.borderLeftColor,f++):c.style.display="none",""!==b.borderRightColor&&""!==b.borderRightWidth&&""!==
b.borderRightColor?(d.style.display="inline-block",a(b.borderRightColor)&&(b.objRef.style.borderRightColor="black",b.borderRightColor="black"),d.style.backgroundColor=b.borderRightColor,f++):d.style.display="none",""!==b.borderTopColor&&""!==b.borderTopWidth&&""!==b.borderTopColor?(e.style.display="inline-block",a(b.borderTopColor)&&(b.objRef.style.borderTopColor="black",b.borderTopColor="black"),e.style.backgroundColor=b.borderTopColor,f++):e.style.display="none",""!==b.borderBottomColor&&""!==b.borderBottomWidth&&
""!==b.borderBottomColor?(g.style.display="inline-block",a(b.borderBottomColor)&&(b.objRef.style.borderBottomColor="black",b.borderBottomColor="black"),g.style.backgroundColor=b.borderBottomColor,f++):g.style.display="none",c.style.width=220/f+"px",d.style.width=220/f+"px",e.style.width=220/f+"px",g.style.width=220/f+"px",document.getElementById("labelColorListBorderL").style.width=220/f+"px",document.getElementById("labelColorListBorderR").style.width=220/f+"px",document.getElementById("labelColorListBorderT").style.width=
220/f+"px",document.getElementById("labelColorListBorderB").style.width=220/f+"px";if(""!==b.boxShadow)for(document.getElementById("opColorBoxShadow").style.display="inline-block",c=document.getElementById("colorBoxShadow"),d=b.boxShadow.split(" "),i=0;i<d.length;i++)/rgb/.test(d[i])?c.style.backgroundColor=TRIANGLE.colors.rgbToHex(d[i]+" "+d[i+1]+" "+d[i+2]):/#/.test(d[i])?c.style.backgroundColor=d[i]:/\d+/g.test(d[i])||(c.style.backgroundColor=d[i]);TRIANGLE.isType.textBox(b.objRef)&&""!==b.fontColor&&
(document.getElementById("opColorFont").style.display="inline-block","inherit"==b.fontColor?document.getElementById("colorFont").style.backgroundColor=b.parent.style.color:document.getElementById("colorFont").style.backgroundColor=b.fontColor)}};
TRIANGLE.saveItem={applyChanges:function(a){function b(){var a=document.getElementById("bgColor");/#*(\d[a-f]*|[a-f]\d*){3,6}/g.test(a.value)&&!/rgb/.test(a.value)?(a=a.value.replace(/#/g,""),TRIANGLE.saveItem.createAnimation("background-color",TRIANGLE.item.bgColor,"#"+a,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.backgroundColor="#"+a,document.getElementById("colorElementBg").style.backgroundColor="#"+a):(TRIANGLE.saveItem.createAnimation("background-color",TRIANGLE.item.bgColor,
a.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.backgroundColor=a.value,document.getElementById("colorElementBg").style.backgroundColor=a.value)}function c(){var a=document.getElementById("height");0==parseInt(a.value)?TRIANGLE.item.objRef.style.minHeight="3px":TRIANGLE.getUnit(a.value)?(TRIANGLE.saveItem.createAnimation("min-height",TRIANGLE.item.minHeight,a.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.minHeight=a.value):(TRIANGLE.saveItem.createAnimation("min-height",
TRIANGLE.item.minHeight,a.value+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.minHeight=a.value+"px");TRIANGLE.item.transform||"table"===TRIANGLE.item.display?TRIANGLE.item.objRef.style.height=TRIANGLE.item.objRef.style.minHeight:TRIANGLE.isType.formField(TRIANGLE.item.objRef)?TRIANGLE.item.objRef.style.height=TRIANGLE.item.objRef.style.minHeight:TRIANGLE.item.objRef.style.height="auto"}function d(){var a=document.getElementById("width");0==parseInt(a.value)?TRIANGLE.item.objRef.style.width=
"3px":TRIANGLE.getUnit(a.value)?(TRIANGLE.saveItem.createAnimation("width",TRIANGLE.item.width,a.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.width=a.value):(TRIANGLE.saveItem.createAnimation("width",TRIANGLE.item.width,a.value+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.width=a.value+"px")}function e(){function a(){TRIANGLE.selectionBorder.remove();var a=TRIANGLE.item.objRef.getBoundingClientRect().height,b=TRIANGLE.item.objRef.getBoundingClientRect().width;
a=Math.round(a*c);document.getElementById("width").value=a+"px";TRIANGLE.saveItem.createAnimation("width",b+"px",a+"px",function(){TRIANGLE.selectionBorder.create()});TRIANGLE.item.objRef.style.width=a+"px"}var b=document.getElementById("height");"auto"==b.value&&(TRIANGLE.item.objRef.style.height="auto");0===parseInt(b.value)?TRIANGLE.item.objRef.style.minHeight="3px":TRIANGLE.getUnit(b.value)?"%"!=TRIANGLE.getUnit(b.value)&&(TRIANGLE.saveItem.createAnimation("min-height",TRIANGLE.item.minHeight,
b.value),TRIANGLE.item.objRef.style.minHeight=b.value,parseFloat(b.value)<parseFloat(TRIANGLE.item.objRef.style.height)&&(TRIANGLE.item.objRef.style.height=b.value)):(TRIANGLE.saveItem.createAnimation("min-height",TRIANGLE.item.minHeight,b.value+"px"),TRIANGLE.item.objRef.style.minHeight=b.value+"px",parseFloat(b.value)<TRIANGLE.item.objRef.getBoundingClientRect().height&&(TRIANGLE.item.objRef.style.height=b.value+"px"));var c=TRIANGLE.item.cropRatio;c&&setTimeout(a,325)}function g(){function a(){TRIANGLE.selectionBorder.remove();
var a=TRIANGLE.item.objRef.getBoundingClientRect().width,b=TRIANGLE.item.objRef.getBoundingClientRect().height,d=Math.round(a/c);document.getElementById("height").value=d+"px";d<b?(TRIANGLE.item.objRef.style.height="1px",TRIANGLE.saveItem.createAnimation("min-height",b+"px",d+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.height=TRIANGLE.item.objRef.style.minHeight=d+"px"):(TRIANGLE.saveItem.createAnimation("height",b+"px",d+"px",function(){TRIANGLE.item.objRef.style.minHeight=
d+"px";TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.height=d+"px")}var b=document.getElementById("width");0===parseInt(b.value)?TRIANGLE.item.objRef.style.width="3px":TRIANGLE.getUnit(b.value)?(TRIANGLE.saveItem.createAnimation("width",TRIANGLE.item.width,b.value),TRIANGLE.item.objRef.style.width=b.value):(TRIANGLE.saveItem.createAnimation("width",TRIANGLE.item.width,b.value+"px"),TRIANGLE.item.objRef.style.width=b.value+"px");var c=TRIANGLE.item.cropRatio;c&&setTimeout(a,325)}function f(){var a=
TRIANGLE.item,b=document.getElementById("display");a.objRef.style.display=b.value;"none"==b.value&&(b.value="block")}function m(){var a=TRIANGLE.item,b=document.getElementById("paddingL"),c=document.getElementById("paddingR"),d=document.getElementById("paddingT"),e=document.getElementById("paddingB");0==parseInt(b.value)?(TRIANGLE.saveItem.createAnimation("padding-left",TRIANGLE.item.paddingLeft,0,function(){TRIANGLE.selectionBorder.create()}),a.objRef.style.paddingLeft=""):TRIANGLE.getUnit(b.value)||
""===b.value?(TRIANGLE.saveItem.createAnimation("padding-left",TRIANGLE.item.paddingLeft,b.value,function(){TRIANGLE.selectionBorder.create()}),a.objRef.style.paddingLeft=b.value):(TRIANGLE.saveItem.createAnimation("padding-left",TRIANGLE.item.paddingLeft,b.value+"px",function(){TRIANGLE.selectionBorder.create()}),a.objRef.style.paddingLeft=b.value+"px");0==parseInt(c.value)?(TRIANGLE.saveItem.createAnimation("padding-right",TRIANGLE.item.paddingRight,0),a.objRef.style.paddingRight=""):TRIANGLE.getUnit(c.value)||
""===c.value?(TRIANGLE.saveItem.createAnimation("padding-right",TRIANGLE.item.paddingRight,c.value,function(){TRIANGLE.selectionBorder.create()}),a.objRef.style.paddingRight=c.value):(TRIANGLE.saveItem.createAnimation("padding-right",TRIANGLE.item.paddingRight,c.value,function(){TRIANGLE.selectionBorder.create()}),a.objRef.style.paddingRight=c.value+"px");0==parseInt(d.value)?(TRIANGLE.saveItem.createAnimation("padding-top",TRIANGLE.item.paddingTop,0,function(){TRIANGLE.selectionBorder.create()}),
a.objRef.style.paddingTop=""):TRIANGLE.getUnit(d.value)||""===d.value?(TRIANGLE.saveItem.createAnimation("padding-top",TRIANGLE.item.paddingTop,d.value,function(){TRIANGLE.selectionBorder.create()}),a.objRef.style.paddingTop=d.value):(TRIANGLE.saveItem.createAnimation("padding-top",TRIANGLE.item.paddingTop,d.value+"px",function(){TRIANGLE.selectionBorder.create()}),a.objRef.style.paddingTop=d.value+"px");0==parseInt(e.value)?(TRIANGLE.saveItem.createAnimation("padding-bottom",TRIANGLE.item.paddingBottom,
0,function(){TRIANGLE.selectionBorder.create()}),a.objRef.style.paddingBottom=""):TRIANGLE.getUnit(e.value)||""===e.value?(TRIANGLE.saveItem.createAnimation("padding-bottom",TRIANGLE.item.paddingBottom,e.value,function(){TRIANGLE.selectionBorder.create()}),a.objRef.style.paddingBottom=e.value):(TRIANGLE.saveItem.createAnimation("padding-bottom",TRIANGLE.item.paddingBottom,e.value+"px",function(){TRIANGLE.selectionBorder.create()}),a.objRef.style.paddingBottom=e.value+"px")}function l(){var a=document.getElementById("marginL"),
b=document.getElementById("marginR"),c=document.getElementById("marginT"),d=document.getElementById("marginB");0===parseInt(a.value)||""==a.value?(TRIANGLE.saveItem.createAnimation("margin-left",TRIANGLE.item.marginLeft,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginLeft=""):TRIANGLE.getUnit(a.value)?(TRIANGLE.saveItem.createAnimation("margin-left",TRIANGLE.item.marginLeft,a.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginLeft=
a.value):(TRIANGLE.saveItem.createAnimation("margin-left",TRIANGLE.item.marginLeft,a.value+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginLeft=a.value+"px");0===parseInt(b.value)||""==b.value?(TRIANGLE.saveItem.createAnimation("margin-right",TRIANGLE.item.marginRight,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginRight=""):TRIANGLE.getUnit(b.value)?(TRIANGLE.saveItem.createAnimation("margin-right",TRIANGLE.item.marginRight,
b.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginRight=b.value):(TRIANGLE.saveItem.createAnimation("margin-right",TRIANGLE.item.marginRight,b.value+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginRight=b.value+"px");0===parseInt(c.value)||""==c.value?(TRIANGLE.saveItem.createAnimation("margin-top",TRIANGLE.item.marginTop,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginTop=""):TRIANGLE.getUnit(c.value)?
(TRIANGLE.saveItem.createAnimation("margin-top",TRIANGLE.item.marginTop,c.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginTop=c.value):(TRIANGLE.saveItem.createAnimation("margin-top",TRIANGLE.item.marginTop,c.value+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginTop=c.value+"px");0===parseInt(d.value)||""==d.value?(TRIANGLE.saveItem.createAnimation("margin-bottom",TRIANGLE.item.marginBottom,"",function(){TRIANGLE.selectionBorder.create()}),
TRIANGLE.item.objRef.style.marginBottom=""):TRIANGLE.getUnit(d.value)?(TRIANGLE.saveItem.createAnimation("margin-bottom",TRIANGLE.item.marginBottom,d.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginBottom=d.value):(TRIANGLE.saveItem.createAnimation("margin-bottom",TRIANGLE.item.marginBottom,d.value+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.marginBottom=d.value+"px")}function h(){var a=document.getElementById("borderLwidth"),
b=document.getElementById("borderLtype"),c=b.options[b.selectedIndex].text;b=document.getElementById("borderLcolor");var d=document.getElementById("borderRwidth"),e=document.getElementById("borderRtype"),f=e.options[e.selectedIndex].text;e=document.getElementById("borderRcolor");var g=document.getElementById("borderTwidth"),h=document.getElementById("borderTtype"),l=h.options[h.selectedIndex].text;h=document.getElementById("borderTcolor");var m=document.getElementById("borderBwidth"),n=document.getElementById("borderBtype"),
p=n.options[n.selectedIndex].text;n=document.getElementById("borderBcolor");var q=document.getElementById("colorListBorderL"),r=document.getElementById("colorListBorderR"),t=document.getElementById("colorListBorderT"),u=document.getElementById("colorListBorderB");0==parseInt(a.value)||""==a.value?(TRIANGLE.saveItem.createAnimation("border-left",TRIANGLE.item.borderLeft,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderLeft=""):(a=parseInt(a.value)+"px "+c+" "+b.value,
TRIANGLE.saveItem.createAnimation("border-left",TRIANGLE.item.borderLeft,a,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderLeft=a,q.style.backgroundColor=b.value);0==parseInt(d.value)||""==d.value?(TRIANGLE.saveItem.createAnimation("border-right",TRIANGLE.item.borderRight,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderRight=""):(a=parseInt(d.value)+"px "+f+" "+e.value,TRIANGLE.saveItem.createAnimation("border-right",TRIANGLE.item.borderRight,
a,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderRight=a,r.style.backgroundColor=e.value);0==parseInt(g.value)||""==g.value?(TRIANGLE.saveItem.createAnimation("border-top",TRIANGLE.item.borderTop,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderTop=""):(a=parseInt(g.value)+"px "+l+" "+h.value,TRIANGLE.saveItem.createAnimation("border-top",TRIANGLE.item.borderTop,a,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderTop=
a,t.style.backgroundColor=h.value);0==parseInt(m.value)||""==m.value?(TRIANGLE.saveItem.createAnimation("border-bottom",TRIANGLE.item.borderBottom,"",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderBottom=""):(a=parseInt(m.value)+"px "+p+" "+n.value,TRIANGLE.saveItem.createAnimation("border-bottom",TRIANGLE.item.borderBottom,a,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.borderBottom=a,u.style.backgroundColor=n.value)}function n(){var a=
TRIANGLE.item,b=document.getElementById("boxShadowH"),c=document.getElementById("boxShadowV"),d=document.getElementById("boxShadowBlur"),e=document.getElementById("boxShadowColor");0==parseInt(b.value)&&0==parseInt(c.value)&&0==parseInt(d.value)||""==b.value&&""==c.value&&""==d.value?(TRIANGLE.saveItem.createAnimation("box-shadow",TRIANGLE.item.boxShadow,"",function(){TRIANGLE.selectionBorder.create()}),a.objRef.style.boxShadow=""):(b=parseInt(b.value)+"px "+parseInt(c.value)+"px "+parseInt(d.value)+
"px "+e.value,TRIANGLE.saveItem.createAnimation("box-shadow",TRIANGLE.item.boxShadow,b,function(){TRIANGLE.selectionBorder.create()}),a.objRef.style.boxShadow=b)}function p(){if(TRIANGLE.isType.textBox(TRIANGLE.item.objRef)){var a=document.getElementById("fontColor"),b=document.getElementById("fontSize"),c=document.getElementById("fontLineHeight");TRIANGLE.saveItem.createAnimation("color",TRIANGLE.item.fontColor,a.value,function(){TRIANGLE.selectionBorder.create()});TRIANGLE.item.objRef.style.color=
a.value;/\D/g.test(b.value)?(TRIANGLE.saveItem.createAnimation("font-size",TRIANGLE.item.fontSize,b.value,function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.fontSize=b.value):(TRIANGLE.saveItem.createAnimation("font-size",TRIANGLE.item.fontSize,b.value+"px",function(){TRIANGLE.selectionBorder.create()}),TRIANGLE.item.objRef.style.fontSize=b.value+"px");TRIANGLE.item.objRef.style.lineHeight=c.value}}function q(){var a=document.getElementById("userID").value.replace(/ /g,"-");
""!==a?(a=TRIANGLE.library.removeDuplicateUserIDs(a),TRIANGLE.item.objRef.setAttribute("user-id",a),setTimeout(TRIANGLE.selectionBorder.create,TRIANGLE.saveItem.animationTime)):TRIANGLE.item.objRef.removeAttribute("user-id")}function r(){var a=document.getElementById("userClass").value.replace(/ /g,"-");if(""!==a&&document.getElementById("userClass")===document.activeElement){TRIANGLE.item.objRef.setAttribute("user-class",a);setTimeout(TRIANGLE.selectionBorder.create,TRIANGLE.saveItem.animationTime);
var b=document.getElementById("template").querySelectorAll("[user-class="+a+"]");1<b.length?TRIANGLE.item.objRef.style.cssText=b[0]!=TRIANGLE.item.objRef?b[0].style.cssText:b[1].style.cssText:TRIANGLE.userClasses&&TRIANGLE.userClasses[a]&&(TRIANGLE.item.objRef.style.cssText=TRIANGLE.userClasses[a])}else""!==a&&document.getElementById("userClass")!=document.activeElement?TRIANGLE.saveItem.equalizeUserClasses(a):TRIANGLE.item.objRef.removeAttribute("user-class")}function t(){var a=document.getElementById("hrefHyperlink").value;
""!==a&&(null!=TRIANGLE.text.importedHyperlink?TRIANGLE.text.importedHyperlink.setAttribute("href",a):TRIANGLE.isType.textBox(TRIANGLE.item.objRef)?TRIANGLE.item.objRef.children[0].setAttribute("href",a):TRIANGLE.item.objRef.setAttribute("link-to",a),setTimeout(TRIANGLE.selectionBorder.create,TRIANGLE.saveItem.animationTime))}function u(){if("form"===TRIANGLE.item.tag.toLowerCase()){var a=document.getElementById("formEmail");TRIANGLE.item.objRef.setAttribute("form-email",a.value);setTimeout(TRIANGLE.selectionBorder.create,
TRIANGLE.saveItem.animationTime)}}TRIANGLE.selectionBorder.remove();TRIANGLE.hoverBorder.hide();"string"!==typeof a?(b(),this&&"height"===this.id?TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)?e():c():(this&&"width"===this.id||(TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)?e():c()),TRIANGLE.isType.imageItem(TRIANGLE.item.objRef)?g():d()),f(),m(),l(),h(),n(),p(),q(),r(),t(),TRIANGLE.saveItem.saveEcomData(),u()):eval(a);TRIANGLE.selectItem(TRIANGLE.item.index);TRIANGLE.importItem.importColors();
TRIANGLE.updateTemplateItems()},applyAll:function(a,b){var c=document.getElementById(a[0]).value;for(i=1;i<a.length;i++)document.getElementById(a[i]).value=c;b||TRIANGLE.saveItem.applyChanges()},saveEcomData:function(){if(TRIANGLE.item.ecomParent){var a=document.getElementById("ecomItemName"),b=document.getElementById("ecomItemID"),c=document.getElementById("ecomPrice"),d=document.getElementById("ecomQuantity"),e=document.getElementById("ecomDesc"),g=document.getElementById("ecomTax");document.getElementsByName("ecomShippingType");
var f=document.getElementById("ecomShipping"),m=document.getElementById("USPSflatRateSelect"),l=document.getElementById("USPSshapeSelect"),h={};h.name=a.value;h.itemID=TRIANGLE.ecommerce.formatItemID(b.value);h.price=TRIANGLE.ecommerce.formatCurrency(c.value);h.quantity=parseFloat(d.value);h.description=e.value;h.tax=g.checked?1:0;h.shipping=TRIANGLE.ecommerce.formatCurrency(f.value);h.usps="";0<m.selectedIndex?(a=m.value.split(","),h.usps={value:m.value,service:a[0],container:a[1],size:"REGULAR",
pounds:0,ounces:1}):0<l.selectedIndex&&(a=l.value.split(","),h.usps={value:l.value,service:a[0],mailType:a[1]},0<l.selectedIndex&&(m=parseFloat(document.getElementById("USPSpounds").value),l=parseFloat(document.getElementById("USPSounces").value),isNaN(m)&&(m=0),isNaN(l)&&(l=0),h.usps.pounds=m,h.usps.ounces=l,13<16*h.usps.pounds+h.usps.ounces&&(h.usps.service="PRIORITY"),a[2]&&(h.usps.size=a[2],"LARGE"===a[2]&&(m=document.getElementsByName("packageRect"),h.usps.container=m[0].checked?m[0].value:m[1].value,
h.usps.length=parseFloat(document.getElementById("USPSlength").value),h.usps.width=parseFloat(document.getElementById("USPSwidth").value),h.usps.height=parseFloat(document.getElementById("USPSheight").value)))));if(m=TRIANGLE.item.ecomParent.querySelector(".ecomName"))m.innerHTML="<b>"+h.name+"</b>";if(m=TRIANGLE.item.ecomParent.querySelector(".ecomPrice"))m.innerHTML="$"+h.price;h=JSON.stringify(h);TRIANGLE.item.ecomParent.setAttribute("ecommerce",h);setTimeout(TRIANGLE.selectionBorder.create,TRIANGLE.saveItem.animationTime)}},
codeSnippet:function(a){TRIANGLE.item&&TRIANGLE.isType.snippetItem(TRIANGLE.item.objRef)&&TRIANGLE.developer.insertSnippet()},cssStyles:function(a){if(TRIANGLE.item){a=a.value.match(/[^:]+:\s*[^;]+;\s*/g);var b="";for(i=0;i<a.length;i++)b+=a[i];TRIANGLE.item.objRef.style.cssText=b;TRIANGLE.selectionBorder.update()}},hoverStyles:function(a){if(TRIANGLE.item){(a=a.value.match(/[^:]+:\s*[^;]+;\s*/g))||(a=[]);var b="";for(i=0;i<a.length;i++)b+=a[i];TRIANGLE.item.objRef.setAttribute("hover-style",b)}},
equalizeUserClasses:function(a){a=document.getElementById("template").querySelectorAll("[user-class="+a+"]");for(i=0;i<a.length;i++)TRIANGLE.importItem.currentUserClass&&a[i]!=TRIANGLE.importItem.currentUserClass&&(a[i].style.cssText=TRIANGLE.importItem.currentUserClass.style.cssText)},animationActive:!1,animationTime:320,createAnimation:function(a,b,c,d){TRIANGLE.enable.animations?(a="@keyframes updateAnimation {from{"+a+":"+b+"}to{"+a+":"+c+"}}#"+TRIANGLE.item.id+"{"+a+":"+c+";animation-name:updateAnimation;animation-duration:300ms}",
b!==c&&(document.getElementById("updateAnimation").innerHTML=a,TRIANGLE.saveItem.animationActive=!0,setTimeout(function(){document.getElementById("updateAnimation").innerHTML="";TRIANGLE.saveItem.animationActive=!1;d&&"function"==typeof d&&d()},TRIANGLE.saveItem.animationTime))):b!==c&&d&&"function"==typeof d&&d()}};
TRIANGLE.metaData={title:"",keywords:"",description:"",commaSplit:function(a){var b=a.value;" "===b.slice(-1)&&", "!=b.slice(-2)&&(b=b.slice(0,-1)+", ",a.value=b)},fixCommas:function(a){var b=a.value;b=b.replace(/(\w+)(,+|\s+)(\w+)/g,"$1, $3");b=b.replace(/(\w+)(,+|\s+)(\w+)/g,"$1, $3");b=b.replace(/\s+/g," ");b=b.replace(/,+/g,",");b=b.replace(/\s+,+/g,"");" "===b.slice(-1)&&(b=b.slice(0,-1));","===b.slice(-1)&&(b=b.slice(0,-1));a.value=b}};
TRIANGLE.clearSelection=function(){function a(a,b){document.getElementById(b).removeAttribute(a)}TRIANGLE.selectionBorder.remove();for(i=0;i<TRIANGLE.templateItems.length;i++){var b=document.getElementById("item"+i);TRIANGLE.isType.textBox(b)&&b.isContentEditable&&b!==document.activeElement&&(b.blur(),TRIANGLE.text.checkTextEditing())}(function(){var a=document.createElement("input");document.getElementById("dummyDiv").appendChild(a);a.focus();a.blur();document.getElementById("dummyDiv").removeChild(a)})();
b=document.getElementById("menu");var c=b.querySelectorAll("input[type=text]");for(i=0;i<c.length;i++)"true"!=c[i].getAttribute("no-clear")&&(c[i].removeEventListener("keyup",TRIANGLE.saveItem.applyChanges),c[i].value="");c=b.querySelectorAll("input[type=checkbox]");for(i=0;i<c.length;i++)"true"!=c[i].getAttribute("no-clear")&&(c[i].checked=!1);c=b.getElementsByTagName("textarea");for(i=0;i<c.length;i++)"true"!=c[i].getAttribute("no-clear")&&(c[i].value="");c=b.querySelectorAll("input[type=radio]");
for(i=0;i<c.length;i++)c[i].checked=!1;b=b.getElementsByClassName("hideOnClear");for(i=0;i<b.length;i++)b[i].style.display="none";b=document.getElementById("USPSotherOptions").querySelectorAll("input[type=text]");for(i=0;i<b.length;i++)b[i].value="";document.getElementById("fontType").selectedIndex=0;TRIANGLE.colors.cancelCanvasMenu();a("onClick","insert2columns");a("onClick","insert3columns");document.getElementById("opDuplicateElement").removeEventListener("click",TRIANGLE.options.duplicate);document.getElementById("opInsertNewChild").removeEventListener("click",
TRIANGLE.insertNewChild);a("onClick","opDeleteElement");a("onClick","opShiftUp");a("onClick","opShiftDown");a("onClick","opCopyStyles");document.getElementById("insert2columns").style.display="none";document.getElementById("insert3columns").style.display="none";document.getElementById("opDuplicateElement").style.display="none";document.getElementById("opInsertNewChild").style.display="none";document.getElementById("opHyperlink").style.display="none";document.getElementById("opColorElementBg").style.display=
"none";document.getElementById("opColorBorder").style.display="none";document.getElementById("opColorBoxShadow").style.display="none";document.getElementById("opColorFont").style.display="none";document.getElementById("colorListBorderL").style.display="none";document.getElementById("colorListBorderR").style.display="none";document.getElementById("colorListBorderT").style.display="none";document.getElementById("colorListBorderB").style.display="none";document.body.removeEventListener("keyup",TRIANGLE.keyEvents.whichKey.item);
document.getElementById("updateAnimation").innerHTML="";document.getElementById("dimensionLabels").style.display="none";document.getElementById("hrefTarget").value=0;document.getElementById("hrefTarget").disabled=!0;TRIANGLE.text.importedHyperlink=null;TRIANGLE.updateTemplateItems();TRIANGLE.item=!1};
TRIANGLE.deleteItem=function(a){if(!TRIANGLE.isType.preventDelete(TRIANGLE.item.objRef)){if(0===arguments.length||1===arguments.length&&isNaN(arguments[0]))TRIANGLE.item.objRef.removeEventListener("mousedown",TRIANGLE.importItem.single,!0),TRIANGLE.item.objRef.removeEventListener("mouseover",TRIANGLE.hoverBorder.show,!0),TRIANGLE.isType.textBox(TRIANGLE.sv_item.objRef)&&(TRIANGLE.sv_item.objRef.removeEventListener("dblclick",TRIANGLE.text.editText),TRIANGLE.sv_item.objRef.removeEventListener("paste",
TRIANGLE.text.clearPastedStyles)),TRIANGLE.item.hoverVersion&&document.getElementById("hoverItems").removeChild(TRIANGLE.item.hoverObj),TRIANGLE.item.parent.removeChild(TRIANGLE.item.objRef);else if(0<TRIANGLE.templateItems.length){var b=document.getElementById("item"+a),c=document.getElementById("item"+a+":hover");b.removeEventListener("mousedown",TRIANGLE.importItem.single,!0);b.removeEventListener("mouseover",TRIANGLE.hoverBorder.show,!0);TRIANGLE.isType.textBox(b)&&(b.removeEventListener("dblclick",
TRIANGLE.text.editText),b.removeEventListener("paste",TRIANGLE.text.clearPastedStyles));c&&document.getElementById("hoverItems").removeChild(c);b.remove()}TRIANGLE.text.deleteUnusedFonts();TRIANGLE.updateTemplateItems();TRIANGLE.clearSelection()}};
TRIANGLE.keyEvents={shiftKey:!1,whichKey:{document:function(a){0<TRIANGLE.keyEvents.countActiveInputs()||(a.ctrlKey&&86===a.keyCode&&TRIANGLE.keyEvents.keyCtrlV(),a.ctrlKey&&83===a.keyCode&&TRIANGLE.keyEvents.keyCtrlS(),a.ctrlKey&&90===a.keyCode&&TRIANGLE.keyEvents.keyCtrlZ(),a.shiftKey&&84===a.keyCode&&TRIANGLE.keyEvents.keyShiftT(),a.shiftKey&&80===a.keyCode&&TRIANGLE.keyEvents.keyShiftP(),76===a.keyCode&&TRIANGLE.keyEvents.keyL(),77===a.keyCode&&TRIANGLE.keyEvents.keyM(),!a.ctrlKey||38!==a.keyCode&&
38!==a.charCode&&37!==a.keyCode&&37!==a.charCode||TRIANGLE.template.decreaseOpacity(),!a.ctrlKey||40!==a.keyCode&&40!==a.charCode&&39!==a.keyCode&&39!==a.charCode||TRIANGLE.template.increaseOpacity())},item:function(a){27!==a.keyCode&&27!==a.charCode||TRIANGLE.keyEvents.keyEsc();0<TRIANGLE.keyEvents.countActiveInputs()||(13===a.keyCode&&TRIANGLE.keyEvents.keyEnter(),46!==a.keyCode&&46!==a.charCode&&8!==a.keyCode&&8!==a.charCode||TRIANGLE.keyEvents.keyDelete(),a.ctrlKey||38!==a.keyCode&&38!==a.charCode&&
37!==a.keyCode&&37!==a.charCode||TRIANGLE.keyEvents.keyUpArrow(),a.ctrlKey||40!==a.keyCode&&40!==a.charCode&&39!==a.keyCode&&39!==a.charCode||TRIANGLE.keyEvents.keyDownArrow(),73!==a.keyCode&&73!==a.charCode||TRIANGLE.keyEvents.keyI(),a.ctrlKey&&67===a.keyCode&&TRIANGLE.keyEvents.keyCtrlC(),a.ctrlKey&&88===a.keyCode&&TRIANGLE.keyEvents.keyCtrlX(),68===a.keyCode&&TRIANGLE.keyEvents.keyD())}},paste:function(a){a.ctrlKey&&86===a.keyCode&&TRIANGLE.keyEvents.keyCtrlV()},keyDelete:function(a){TRIANGLE.item&&
(TRIANGLE.deleteItem(TRIANGLE.item.index),document.body.removeAttribute("onKeyUp"))},keyUpArrow:function(a){TRIANGLE.options.shiftUp(TRIANGLE.item.index);TRIANGLE.updateTemplateItems()},keyDownArrow:function(a){TRIANGLE.options.shiftDown(TRIANGLE.item.index);TRIANGLE.updateTemplateItems()},keyEsc:function(a){TRIANGLE.item.objRef.isContentEditable&&(TRIANGLE.item.objRef.blur(),TRIANGLE.text.checkTextEditing());document.getElementById("cropImgBorder")&&TRIANGLE.images.crop.cancel();-1<TRIANGLE.colors.colorDropIndex&&
TRIANGLE.colors.cancelColorDropper();TRIANGLE.clearSelection();/sideMenuOpen/g.test(document.getElementById("sideMenu").className)&&TRIANGLE.menu.closeSideMenu()},keyEnter:function(a){TRIANGLE.images.crop.active&&TRIANGLE.images.crop.applyCrop()},keyI:function(a){TRIANGLE.colors.colorDropper()},keyCtrlC:function(){TRIANGLE.item&&TRIANGLE.options.copyStyles(TRIANGLE.item.index)},keyCtrlV:function(){TRIANGLE.options.pasteStyles()},keyCtrlS:function(){"none"!=document.getElementById("saveCurrentTemplate").parentNode.style.display&&
"default"!=TRIANGLE.currentTemplate?TRIANGLE.saveTemplate.saveCurrent():TRIANGLE.saveTemplate.getSaveName()},keyCtrlZ:function(){TRIANGLE.item&&TRIANGLE.item.objRef.isContentEditable||TRIANGLE.options.undo()},keyCtrlX:function(){TRIANGLE.item&&!TRIANGLE.isType.preventDelete(TRIANGLE.item.objRef)&&(TRIANGLE.options.copyStyles(TRIANGLE.item.index),TRIANGLE.item.remove(),TRIANGLE.updateTemplateItems())},keyShiftT:function(){TRIANGLE.text.insertTextBox()},keyShiftP:function(){TRIANGLE.exportCode.format("preview")},
keyL:function(){TRIANGLE.library.load();TRIANGLE.menu.openSideMenu("libraryMenu")},keyM:function(){TRIANGLE.images.load();TRIANGLE.menu.openSideMenu("imageLibraryMenu")},keyD:function(){TRIANGLE.options.duplicate()},countActiveInputs:function(){var a=document.getElementsByTagName("input"),b=document.getElementsByTagName("textarea"),c=document.getElementsByClassName("textBox"),d=0;for(i=0;i<a.length;i++)a[i]===document.activeElement?d++:d+=0;for(i=0;i<b.length;i++)b[i]===document.activeElement?d++:
d+=0;for(i=0;i<c.length;i++)c[i].isContentEditable?d++:d+=0;return d}};
TRIANGLE.options={insertColumns:function(a){TRIANGLE.selectItem(TRIANGLE.item.index);if(!(0<TRIANGLE.item.objRef.children.length||TRIANGLE.isType.bannedInsertion(TRIANGLE.item.objRef))){var b=TRIANGLE.item,c=Math.floor(100*parseFloat(b.width)/a)/100,d=1;for(i=0;i<a;i++){var e=document.createElement("div");e.style.backgroundColor=TRIANGLE.randomColor();e.style.minHeight=b.minHeight;e.style.height="auto";e.style.width=c+TRIANGLE.getUnit(b.width);e.style.position="relative";e.setAttribute("item-align",
b.align);if("right"!==b.align){e.style.cssFloat="left";var g="Right",f="Left"}else e.style.cssFloat="right",g="Left",f="Right";e.style.paddingLeft=b.paddingLeft;e.style.paddingRight=b.paddingRight;e.style.paddingTop=b.paddingTop;e.style.paddingBottom=b.paddingBottom;1===d?(e.style["margin"+g]=b["margin"+g],e.style["border"+g+"Width"]=b["border"+g+"Width"],e.style["border"+g+"Style"]=b["border"+g+"Style"],e.style["border"+g+"Color"]=b["border"+g+"Color"]):d===a&&(e.style["margin"+f]=b["margin"+f],
e.style["border"+f+"Width"]=b["border"+f+"Width"],e.style["border"+f+"Style"]=b["border"+f+"Style"],e.style["border"+f+"Color"]=b["border"+f+"Color"]);e.style.marginTop=b.marginTop;e.style.marginBottom=b.marginBottom;e.style.borderTopWidth=b.borderTopWidth;e.style.borderTopStyle=b.borderTopStyle;e.style.borderTopColor=b.borderTopColor;e.style.borderBottomWidth=b.borderBottomWidth;e.style.borderBottomStyle=b.borderBottomStyle;e.style.borderBottomColor=b.borderBottomColor;e.style.boxShadow=b.boxShadow;
e.className=b.className;b.parent.insertBefore(e,TRIANGLE.templateItems[b.index]);d++}TRIANGLE.deleteItem(b.index);TRIANGLE.updateTemplateItems()}},shiftUp:function(a){if(!TRIANGLE.isType.preventDelete(TRIANGLE.item.objRef)){var b=TRIANGLE.item;TRIANGLE.resetClearFloat();TRIANGLE.selectItem(a);if(b.isFirstChild)TRIANGLE.updateTemplateItems();else{a=b.prevSibling();var c=a.getAttribute("index"),d=TRIANGLE.createAnother(b.objRef);b.parent.insertBefore(d,a);TRIANGLE.deleteItem(b.index);TRIANGLE.updateTemplateItems();
TRIANGLE.importItem.single(c);TRIANGLE.selectionBorder.update()}}},shiftDown:function(a){if(!TRIANGLE.isType.preventDelete(TRIANGLE.item.objRef)){var b=TRIANGLE.item;TRIANGLE.resetClearFloat();TRIANGLE.selectItem(a);var c;b.nextSibling()&&(c=new TRIANGLE.TemplateItem(b.nextSibling().getAttribute("index")));if(b.isLastChild)TRIANGLE.updateTemplateItems();else{b.nextSibling();a=b.index;var d=TRIANGLE.createAnother(b.objRef);c&&c.nextSibling()?b.parent.insertBefore(d,c.nextSibling()):b.parent.appendChild(d);
TRIANGLE.deleteItem(b.index);TRIANGLE.updateTemplateItems();TRIANGLE.selectItem(a);TRIANGLE.importItem.single(TRIANGLE.item.nextSibling().getAttribute("index"));TRIANGLE.selectionBorder.update()}}},duplicate:function(){if(!TRIANGLE.isType.ecommerceComponent(TRIANGLE.item.objRef)){var a=TRIANGLE.item,b=a.parent,c="";for(i=0;i<b.childNodes.length;i++)b.childNodes[i]==a.objRef&&(c=i);var d=TRIANGLE.createAnother(a.objRef);d.removeAttribute("user-id");d.innerHTML=d.innerHTML.replace(/user\-class="[^"]*"/g,
"");TRIANGLE.isType.ecommerceItem(TRIANGLE.item.objRef)&&TRIANGLE.item.objRef.setAttribute("replace-ecom-id","true");1===b.childNodes.length?b.appendChild(d):b.insertBefore(d,b.childNodes[c+1]);TRIANGLE.updateTemplateItems();TRIANGLE.clearSelection();TRIANGLE.selectItem(b.childNodes[c+1].getAttribute("index"));"100%"!==a.width&&(a.align&&"center"!==a.align||a.cssFloat)?TRIANGLE.saveItem.createAnimation("width",0,TRIANGLE.item.width,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)}):TRIANGLE.saveItem.createAnimation("min-height",
0,TRIANGLE.item.minHeight,function(){TRIANGLE.importItem.single(TRIANGLE.item.index)})}},clipboard:{},isClipboardFull:!1,itemStyles:null,copyStyles:function(a){TRIANGLE.isType.preventDelete(TRIANGLE.item.objRef)||(TRIANGLE.clearSelection(),TRIANGLE.selectItem(a),TRIANGLE.options.clipboard.tag=TRIANGLE.item.tag,TRIANGLE.options.clipboard.src=TRIANGLE.item.objRef.src,TRIANGLE.options.clipboard.itemStyles=TRIANGLE.getStyles(TRIANGLE.item.objRef),TRIANGLE.options.isClipboardFull=!0)},pasteStyles:function(a){var b=
document.createElement(TRIANGLE.options.clipboard.tag);for(i=0;i<TRIANGLE.options.clipboard.itemStyles.length;i++)TRIANGLE.styleFunctions[i](b,TRIANGLE.options.clipboard.itemStyles[i]);TRIANGLE.options.clipboard.src&&(b.src=TRIANGLE.options.clipboard.src);b.removeAttribute("user-id");b.innerHTML=b.innerHTML.replace(/user\-class="[^"]*"/g,"");TRIANGLE.isType.ecommerceItem(b)&&b.setAttribute("replace-ecom-id","true");TRIANGLE.item?(a||(a=TRIANGLE.item.index),TRIANGLE.checkPadding(TRIANGLE.item.objRef),
TRIANGLE.item.append(b),TRIANGLE.importItem.single(a)):(document.getElementById("template").appendChild(b),TRIANGLE.importItem.single(TRIANGLE.templateItems.length-1));setTimeout(TRIANGLE.selectionBorder.update,50);TRIANGLE.updateTemplateItems(!0)},undoList:[],undoIndex:!1,maxUndo:20,compareUndoList:function(){var a=document.getElementById("templateWrapper").innerHTML.trim();a=a.replace(/\r|\n/g,"");a=a.replace(/&nbsp;/g," ");a=a.replace(/(\s)+/g,"$1");a=a.replace(/((<div[^>]+id="selectionBorder"[^>]*>)|(<div[^>]+id="noClickThru"[^>]*>[^<]*<\/div>)|(<div[^>]+class="resizeHandle"[^>]*>[^<]*<\/div>))(<\/div>)?/gi,
"");a=a.replace(/<div[^>]+id="showHoverBorder"[^>]*>[^<]*<\/div>?/gi,"");var b=TRIANGLE.options.undoList[TRIANGLE.options.undoList.length-1];0===TRIANGLE.options.undoList.length?TRIANGLE.options.undoList[0]=a:a!=b&&(TRIANGLE.options.undoList[TRIANGLE.options.undoList.length]=a,TRIANGLE.options.undoIndex=TRIANGLE.options.undoList.length-1)},undo:function(){0!==TRIANGLE.options.undoList.length&&(0<TRIANGLE.options.undoIndex&&TRIANGLE.options.undoIndex--,TRIANGLE.options.undoList.splice(TRIANGLE.options.undoIndex+
1,TRIANGLE.options.undoList.length-TRIANGLE.options.undoIndex-1),document.getElementById("templateWrapper").innerHTML=TRIANGLE.options.undoList[TRIANGLE.options.undoIndex],TRIANGLE.colors.updateBodyBg(),TRIANGLE.updateTemplateItems(),TRIANGLE.resize.removeHandles())},redo:function(a){var b=[0,1,2,3,4,5,6,7,8,9];console.log(b);console.log("arr.length: "+b.length+"   index: "+a);console.log("removing "+(b.length-a-1)+" items");b.splice(a+1,b.length-a-1)}};
TRIANGLE.publish={prompt:function(){TRIANGLE.popUp.open("FTPprofileCell")},begin:function(){0<document.getElementById("FTPselect").selectedIndex&&(TRIANGLE.exportCode.format("publish"),TRIANGLE.publish.cancel())},cancel:function(){TRIANGLE.popUp.close()}};TRIANGLE.loading={start:function(a){TRIANGLE.popUp.open("loadingCell");"function"==typeof a&&setTimeout(a,10)},stop:function(){TRIANGLE.popUp.close()}};TRIANGLE.maxAllowedItems=100;
TRIANGLE.exportCode={format:function(a){if(TRIANGLE.unsavedPremade)TRIANGLE.saveTemplate.getSaveName();else switch(a){case "publish":TRIANGLE.exportCode.postZip(0);a=document.getElementById("FTPselect");a=a.options[a.selectedIndex];var b={};b.instance=TRIANGLE.instance;b.ftpURL=a.innerHTML;b.ftpID=a.getAttribute("ftp");TRIANGLE.exportCode.postTemplate("publish",b);break;case "zip":TRIANGLE.exportCode.postZip(1);break;case "raw":TRIANGLE.saveTemplate.saveCurrent();b={};b.instance=TRIANGLE.instance;
TRIANGLE.exportCode.postTemplate("exportRaw",b);break;case "preview":TRIANGLE.exportCode.previewTemplate()}},callbackAfterSave:!1,postZip:function(a){TRIANGLE.saveTemplate.saveCurrent();var b=document.getElementById("exportCompress").checked?1:0,c="askZip="+a+"&instance="+TRIANGLE.instance+"&compress="+b;setTimeout(function(){AJAX.post("scripts/exportZip.php",c,function(b){console.log(b.responseText);a&&window.open(b.responseText)})},100)},postTemplate:function(a,b){var c=document.getElementById("exportRawPost");
c.innerHTML="";c.setAttribute("action","scripts/"+a+".php");var d=document.getElementById("exportCompress").checked?1:0;b.compress=d;for(var e in b)b.hasOwnProperty(e)&&(d=document.createElement("input"),d.setAttribute("type","hidden"),d.setAttribute("name",e),d.setAttribute("value",b[e]),c.appendChild(d));document.body.appendChild(c);c.submit();TRIANGLE.loading.stop()},postTemplateAJAX:function(a,b){var c=document.getElementById("exportCompress").checked?1:0;b.compress=c;c="";for(var d in b)b.hasOwnProperty(d)&&
(c+=d+"="+b[d]+"&");c=c.slice(0,-1);AJAX.post("scripts/"+a+".php",c,function(a){TRIANGLE.loading.stop()})},previewTemplate:function(){TRIANGLE.unsavedPremade?(TRIANGLE.exportCode.callbackAfterSave=function(){setTimeout(TRIANGLE.exportCode.previewTemplate,100);setTimeout(function(){TRIANGLE.popUp.close();location.href="index.php?pagename="+TRIANGLE.currentPage+"&loadTemplate="+TRIANGLE.currentTemplate},500)},TRIANGLE.saveTemplate.getSaveName()):(TRIANGLE.exportCode.callbackAfterSave=function(){var a=
document.getElementById("exportCompress").checked?1:0;AJAX.post("scripts/exportZip.php","askZip=0&instance="+TRIANGLE.instance+"&compress="+a,function(a){console.log(a.responseText);TRIANGLE.exportCode.postTemplate("previewTemplate",{instance:TRIANGLE.instance})})},TRIANGLE.saveTemplate.saveCurrent())},error:function(){alert("Your template contains too many items to export. Please remove "+(TRIANGLE.templateItems.length-TRIANGLE.maxAllowedItems)+" items to export it.")},exportZip:function(){TRIANGLE.exportCode.format("zip");
setTimeout(TRIANGLE.loading.stop,1E3)},clearZip:function(){AJAX.get("scripts/clearZip.php","",function(a){})}};
TRIANGLE.styleFunctions=[function(a,b){a.style.backgroundColor=b},function(a,b){a.style.backgroundImage=b},function(a,b){a.style.height=b},function(a,b){a.style.minHeight=b},function(a,b){a.style.width=b},function(a,b){a.style.maxWidth=b},function(a,b){a.style.display=b},function(a,b){a.style.position=b},function(a,b){a.style.cssFloat=b},function(a,b){a.style.overflow=b},function(a,b){a.style.paddingLeft=b},function(a,b){a.style.paddingRight=b},function(a,b){a.style.paddingTop=b},function(a,b){a.style.paddingBottom=
b},function(a,b){a.style.marginLeft=b},function(a,b){a.style.marginRight=b},function(a,b){a.style.marginTop=b},function(a,b){a.style.marginBottom=b},function(a,b){a.style.borderLeftWidth=b},function(a,b){a.style.borderLeftStyle=b},function(a,b){a.style.borderLeftColor=b},function(a,b){a.style.borderRightWidth=b},function(a,b){a.style.borderRightStyle=b},function(a,b){a.style.borderRightColor=b},function(a,b){a.style.borderTopWidth=b},function(a,b){a.style.borderTopStyle=b},function(a,b){a.style.borderTopColor=
b},function(a,b){a.style.borderBottomWidth=b},function(a,b){a.style.borderBottomStyle=b},function(a,b){a.style.borderBottomColor=b},function(a,b){a.style.boxShadow=b},function(a,b){a.style.color=b},function(a,b){a.style.fontSize=b},function(a,b){a.style.lineHeight=b},function(a,b){a.style.textAlign=b},function(a,b){a.style.fontFamily=b},function(a,b){a.style.textDecoration=b},function(a,b){a.innerHTML=b},function(a,b){a.className=b},function(a,b){b&&a.setAttribute("item-align",b)},function(a,b){b&&
a.setAttribute("user-id",b)},function(a,b){b&&a.setAttribute("hover-style",b)},function(a,b){b&&a.setAttribute("link-to",b)},function(a,b){b&&a.setAttribute("name",b)},function(a,b){b&&a.setAttribute("onClick",b)},function(a,b){b&&a.setAttribute("crop-map",b)},function(a,b){b&&a.setAttribute("crop-ratio",b)},function(a,b){b&&a.setAttribute("target",b)},function(a,b){b&&a.setAttribute("user-class",b)},function(a,b){b&&a.setAttribute("ecommerce",b)},function(a,b){b&&a.setAttribute("form-email",b)}];
TRIANGLE.getStyles=function(a){return[a.style.backgroundColor,a.style.backgroundImage,a.style.height,a.style.minHeight,a.style.width,a.style.maxWidth,a.style.display,a.style.position,a.style.cssFloat,a.style.overflow,a.style.paddingLeft,a.style.paddingRight,a.style.paddingTop,a.style.paddingBottom,a.style.marginLeft,a.style.marginRight,a.style.marginTop,a.style.marginBottom,a.style.borderLeftWidth,a.style.borderLeftStyle,a.style.borderLeftColor,a.style.borderRightWidth,a.style.borderRightStyle,a.style.borderRightColor,
a.style.borderTopWidth,a.style.borderTopStyle,a.style.borderTopColor,a.style.borderBottomWidth,a.style.borderBottomStyle,a.style.borderBottomColor,a.style.boxShadow,a.style.color,a.style.fontSize,a.style.lineHeight,a.style.textAlign,a.style.fontFamily,a.style.textDecoration,a.innerHTML,a.className,a.getAttribute("item-align"),a.getAttribute("user-id"),a.getAttribute("hover-style"),a.getAttribute("link-to"),a.getAttribute("name"),a.getAttribute("onClick"),a.getAttribute("crop-map"),a.getAttribute("crop-ratio"),
a.getAttribute("target"),a.getAttribute("user-class"),a.getAttribute("ecommerce"),a.getAttribute("form-email")]};TRIANGLE.createAnother=function(a){var b=document.createElement(a.tagName),c=TRIANGLE.getStyles(a);for(x=0;x<c.length;x++)TRIANGLE.styleFunctions[x](b,c[x]);TRIANGLE.isType.imageItem(a)&&(b.src=a.src);return b};
TRIANGLE.style={convertWidth:function(a){if("inline"==a.style.display||"inline-block"==a.style.display||"inline-table"==a.style.display){var b=a.getBoundingClientRect();"auto"==a.style.width&&(a.style.width=b.width+"px")}},itemAlignLeft:function(){TRIANGLE.item.objRef.style.cssFloat="left";TRIANGLE.item.objRef.setAttribute("item-align","left");TRIANGLE.importItem.single(TRIANGLE.item.index);TRIANGLE.selectionBorder.update()},itemAlignCenter:function(){var a=TRIANGLE.item;a.cssFloat&&(a.objRef.style.cssFloat=
"");"inline"!=a.display&&"inline-block"!=a.display&&"inline-table"!=a.display&&a.display||(TRIANGLE.style.convertWidth(a.objRef),a.objRef.style.display="block");a.objRef.style.marginLeft="auto";a.objRef.style.marginRight="auto";a.objRef.setAttribute("item-align","center");TRIANGLE.importItem.single(a.index);TRIANGLE.selectionBorder.update()},itemAlignRight:function(){TRIANGLE.item.objRef.style.cssFloat="right";TRIANGLE.item.objRef.setAttribute("item-align","right");TRIANGLE.importItem.single(TRIANGLE.item.index);
TRIANGLE.selectionBorder.update()},verticalMiddle:function(){var a=TRIANGLE.item;if("table-cell"!=a.display&&"table-cell"!=a.parent.style.display&&"template"!=a.parent.getAttribute("id")){TRIANGLE.selectionBorder.remove();TRIANGLE.checkPadding(a.parent);a.parent.style.display="table";a.parent.style.height=a.parent.style.minHeight;var b=document.createElement("div");b.style.display="table-cell";b.style.verticalAlign="middle";b.style.backgroundColor="inherit";b.style.width="100%";b.style.minHeight=
"auto";b.style.height="auto";b.className="templateItem childItem";b.innerHTML=a.parent.innerHTML;a.parent.removeChild(a.objRef);a.parent.innerHTML="";a.parent.appendChild(b);TRIANGLE.updateTemplateItems(!0);TRIANGLE.clearSelection()}},itemAlignDefault:function(){TRIANGLE.item.objRef.style.cssFloat="";"auto"===TRIANGLE.item.marginLeft&&(TRIANGLE.item.objRef.style.marginLeft="");"auto"===TRIANGLE.item.marginRight&&(TRIANGLE.item.objRef.style.marginRight="");if("table-cell"===TRIANGLE.item.parent.style.display){var a=
TRIANGLE.item.parent.parentNode,b=TRIANGLE.item.parent,c=b.innerHTML;a.removeChild(b);a.innerHTML+=c;a.style.display="block"}TRIANGLE.item.objRef.removeAttribute("item-align");TRIANGLE.importItem.single(TRIANGLE.item.index);TRIANGLE.selectionBorder.update()}};TRIANGLE.getElementByUserId=function(a){for(i=0;i<TRIANGLE.templateItems.length;i++)if(TRIANGLE.templateItems[i].getAttribute("user-id")===a)return TRIANGLE.templateItems[i]};
TRIANGLE.effects={enterStudio:function(){document.getElementById("effectStudioMenu").style.display="block"},exitStudio:function(){document.getElementById("effectStudioMenu").style.display="none"}};
TRIANGLE.effects.hover={transferStyles:function(a){if(a.getAttribute("hover-style")){var b=new RegExp("#"+a.getAttribute("id")+"(:hover)*{[^}]}","g"),c=document.getElementById("hoverData");b.test(c.innerHTML)&&(c.innerHTML=c.innerHTML.replace(b,""));c.innerHTML+="#"+a.getAttribute("id")+"{"+a.getAttribute("style")+"}#"+a.getAttribute("id")+":hover{"+a.getAttribute("hover-style")+"}"}},prepareStyles:function(){document.getElementById("hoverData").innerHTML="";for(i=0;i<TRIANGLE.templateItems.length;i++)TRIANGLE.effects.hover.transferStyles(TRIANGLE.templateItems[i])},
createHoverVersion:function(a){var b=document.createElement(a.tagName);b.style.cssText=a.getAttribute("hover-style");b.setAttribute("id",a.getAttribute("id")+":hover");document.getElementById("hoverItems").appendChild(b)},addStyle:function(){TRIANGLE.item.hoverVersion||TRIANGLE.effects.hover.createHoverVersion(TRIANGLE.item.objRef);TRIANGLE.updateTemplateItems()}};
TRIANGLE.forms={insertForm:function(){var a=TRIANGLE.item;if(!a||"FORM"!==a.tag)if(!a||!TRIANGLE.isType.bannedInsertion(a.objRef))if(!a||!a.objRef.children[0]||"table-cell"!==a.objRef.children[0].style.display){var b=document.createElement("form");b.className="templateItem childItem";b.style.backgroundColor="inherit";b.style.minHeight="100px";b.style.height="auto";b.style.width="100%";b.style.position="relative";b.style.borderLeft="1px dashed gray";b.style.borderRight="1px dashed gray";b.style.borderTop=
"1px dashed gray";b.style.borderBottom="1px dashed gray";a||(TRIANGLE.appendRow(),TRIANGLE.updateTemplateItems(),TRIANGLE.selectItem(TRIANGLE.templateItems[TRIANGLE.templateItems.length-1].getAttribute("index")),a=TRIANGLE.item);TRIANGLE.checkPadding(a.objRef);a.append(b);TRIANGLE.updateTemplateItems();TRIANGLE.selectionBorder.remove();a=a.objRef.children[a.objRef.children.length-1].getAttribute("index");TRIANGLE.selectItem(a);TRIANGLE.saveItem.createAnimation("min-height",0,"100px",function(){TRIANGLE.importItem.single(TRIANGLE.item.index)});
TRIANGLE.updateTemplateItems()}},insertField:function(){for(i=0;i<TRIANGLE.templateItems.length;i++){0===i&&(TRIANGLE.sv_item=new TRIANGLE.TemplateItem(TRIANGLE.item.index));if("template"===TRIANGLE.sv_item.parent.getAttribute("id"))return;if("FORM"===TRIANGLE.sv_item.parent.tagName.toUpperCase()||"FORM"===TRIANGLE.item.tag.toUpperCase())break;else TRIANGLE.sv_item=new TRIANGLE.TemplateItem(TRIANGLE.sv_item.parent.getAttribute("index"))}TRIANGLE.text.insertTextBox("Field Label");var a=document.createElement("div");
a.className="templateItem childItem formField";a.style.backgroundColor="white";a.style.minHeight="24px";a.style.height="24px";a.style.width="100%";a.style.position="relative";a.style.paddingLeft="2px";a.style.paddingRight="2px";a.style.paddingTop="2px";a.style.paddingBottom="2px";a.style.borderLeft="1px solid gray";a.style.borderRight="1px solid gray";a.style.borderTop="1px solid gray";a.style.borderBottom="1px solid gray";a.style.marginTop="3px";a.style.marginBottom="8px";a.style.font="inherit";
TRIANGLE.item.append(a);TRIANGLE.updateTemplateItems();TRIANGLE.importItem.single(TRIANGLE.item.index)},insertButton:function(){if(!TRIANGLE.item||"FORM"===TRIANGLE.item.tag){for(i=0;i<TRIANGLE.item.objRef.children.length;i++)if("BUTTON"===TRIANGLE.item.objRef.children[i].tagName)return;var a=document.createElement("button");a.className="templateItem childItem";a.innerHTML="Submit";a.style.display="block";a.style.margin="0 auto";a.setAttribute("onClick","event.preventDefault();");TRIANGLE.item.append(a);
TRIANGLE.updateTemplateItems(!0);TRIANGLE.importItem.single(TRIANGLE.item.index)}}};TRIANGLE.columnMap={template:{left:null,right:null},left:[],right:[],leftRound:[],rightRound:[]};
TRIANGLE.locateColumns=function(){var a=document.getElementById("template").getBoundingClientRect();TRIANGLE.columnMap.template.left=a.left;TRIANGLE.columnMap.template.right=a.right;for(y=x=0;x<TRIANGLE.templateItems.length;x++)a=TRIANGLE.templateItems[x].getBoundingClientRect(),TRIANGLE.columnMap.left[x]=a.left,TRIANGLE.columnMap.right[x]=a.right,TRIANGLE.columnMap.leftRound[x]=Math.round(a.left),TRIANGLE.columnMap.rightRound[x]=Math.round(a.right);return TRIANGLE.columnMap};
function hex2dec(a){console.log(parseInt(a,16))}function dec2hex(a){console.log(a.toString(16))}
TRIANGLE.saveTemplate={getSaveName:function(){TRIANGLE.popUp.open("getSaveNameCell");document.getElementById("saveTemplateName").focus();TRIANGLE.menu.closeSideMenu()},getPageName:function(){TRIANGLE.popUp.open("getPageNameCell");document.getElementById("savePageName").focus();TRIANGLE.menu.closeSideMenu()},saveTemplate:function(a,b){TRIANGLE.popUp.close();TRIANGLE.popUp.open("savingCell");a=encodeURIComponent(a);b&&""!=b||(b="");b=encodeURIComponent(b);var c=TRIANGLE.json.encode();c=TRIANGLE.json.compress(c);
c=encodeURIComponent(c);var d=encodeURIComponent(TRIANGLE.developer.globalStyleTagContent),e=encodeURIComponent(TRIANGLE.developer.globalScriptTagContent),g=TRIANGLE.ecommerce.generateCartPage(),f=TRIANGLE.ecommerce.logEcomItems();f=encodeURIComponent(f);var m=document.getElementById("businessProfile").value,l=TRIANGLE.ecommerce.shipping.settings;l=JSON.stringify(l);l=encodeURIComponent(l);AJAX.post("scripts/saveTemplate.php","templateName="+a+"&pageName="+b+"&instance="+TRIANGLE.instance+"&content="+
c+"&globalStyle="+d+"&globalScript="+e+"&cartPage="+g+"&ecomItems="+f+"&busProfile="+m+"&shippingSetup="+l,function(c){TRIANGLE.saveTemplate.saveUserIDs();TRIANGLE.saveTemplate.saveUserClasses();TRIANGLE.popUp.close();document.getElementById("saveTemplateName").value="";document.getElementById("savePageName").value="";TRIANGLE.updateTemplateItems();TRIANGLE.clearSelection();TRIANGLE.pages.loadPages(a,"menu");document.getElementById("saveCurrentTemplate").parentNode.style.display="block";document.getElementById("saveNewPage").parentNode.style.display=
"block";a&&(TRIANGLE.currentTemplate=a);TRIANGLE.currentPage=b;TRIANGLE.unsaved=!1;TRIANGLE.unsavedPremade=!1;TRIANGLE.popUp.close();TRIANGLE.popUp.open("savedCell");TRIANGLE.exportCode.callbackAfterSave?(TRIANGLE.exportCode.callbackAfterSave(),TRIANGLE.exportCode.callbackAfterSave=!1):setTimeout(function(){TRIANGLE.popUp.close();location.href="index.php?pagename="+TRIANGLE.currentPage+"&loadTemplate="+TRIANGLE.currentTemplate},1E3)})},cancelSave:function(){TRIANGLE.popUp.close();document.getElementById("saveTemplateName").value=
""},saveCurrent:function(a){TRIANGLE.popUp.close();TRIANGLE.popUp.open("savingCell");a=TRIANGLE.json.encode();a=TRIANGLE.json.compress(a);a=encodeURIComponent(a);var b=encodeURIComponent(TRIANGLE.developer.globalStyleTagContent),c=encodeURIComponent(TRIANGLE.developer.globalScriptTagContent),d=TRIANGLE.ecommerce.generateCartPage(),e=TRIANGLE.ecommerce.logEcomItems();e=encodeURIComponent(e);var g=document.getElementById("businessProfile").value,f=TRIANGLE.ecommerce.shipping.settings;f=JSON.stringify(f);
f=encodeURIComponent(f);AJAX.post("scripts/saveCurrent.php","instance="+TRIANGLE.instance+"&content="+a+"&globalStyle="+b+"&globalScript="+c+"&cartPage="+d+"&ecomItems="+e+"&busProfile="+g+"&shippingSetup="+f+"&changesMade="+TRIANGLE.changesMade,function(a){TRIANGLE.saveTemplate.saveUserIDs();TRIANGLE.saveTemplate.saveUserClasses();"none"!=document.getElementById("sideMenu").display?TRIANGLE.menu.closeSideMenu():null;TRIANGLE.updateTemplateItems();TRIANGLE.clearSelection();TRIANGLE.unsaved=!1;TRIANGLE.popUp.close();
TRIANGLE.popUp.open("savedCell");setTimeout(TRIANGLE.popUp.close,1E3);TRIANGLE.exportCode.callbackAfterSave&&(TRIANGLE.exportCode.callbackAfterSave(),TRIANGLE.exportCode.callbackAfterSave=!1)})},saveUserIDs:function(){var a=document.getElementById("template").querySelectorAll("*[user-id]"),b={};for(i=0;i<a.length;i++){var c=a[i].getAttribute("user-id");if(c){var d=a[i].nextSibling,e=a[i].previousSibling;b[c]={};var g={};b[c]["user-class"]=a[i].getAttribute("user-class");b[c].tagName=a[i].tagName;
b[c].id=c;g[a[i].id]=c;b[c].className=a[i].className;b[c].name=a[i].getAttribute("name");b[c].style=a[i].style.cssText;b[c].clearFloat=TRIANGLE.isType.clearFloat(e)?1:0;if(TRIANGLE.isType.textBox(a[i])||TRIANGLE.isType.imageItem(a[i])||TRIANGLE.isType.formBtn(a[i])||TRIANGLE.isType.snippetItem(a[i]))b[c].innerHTML=a[i].innerHTML.replace(/&nbsp;/g,encodeURIComponent("&nbsp;"));b[c].src=a[i].src;b[c].childof=0;b[c].nextSib=d&&TRIANGLE.isType.templateItem(d)?d.id:0;b[c].prevSib=e&&TRIANGLE.isType.templateItem(e)?
e.id:0;b[c].isLastChild=!d||d&&!TRIANGLE.isType.templateItem(d)?1:0;b[c]["item-align"]=a[i].getAttribute("item-align");b[c]["hover-style"]=a[i].getAttribute("hover-style");b[c]["link-to"]=a[i].getAttribute("link-to");b[c].onClick=a[i].getAttribute("onclick");b[c]["crop-map"]=a[i].getAttribute("crop-map");b[c]["crop-ratio"]=a[i].getAttribute("crop-ratio");b[c].target=a[i].getAttribute("target");b[c].ecommerce=encodeURIComponent(a[i].getAttribute("ecommerce"));b[c]["form-email"]=a[i].getAttribute("form-email");
b[c].responsive=[a[i].style.width,a[i].getBoundingClientRect().width,a[i].getBoundingClientRect().top];b[c].children={};a[i].querySelector("*[user-id]");var f=a[i].querySelectorAll(".templateItem");for(x=0;x<f.length;x++){d=f[x].nextSibling;e=f[x].previousSibling;var m=c+x;g[f[x].id]=m;b[c].children[m]={};b[c].children[m]["user-id"]=f[x].getAttribute("user-id");b[c].children[m]["user-class"]=f[x].getAttribute("user-class");b[c].children[m].tagName=f[x].tagName;b[c].children[m].className=f[x].className;
b[c].children[m].name=f[x].getAttribute("name");b[c].children[m].style=f[x].style.cssText;b[c].children[m].clearFloat=TRIANGLE.isType.clearFloat(d)?1:0;if(TRIANGLE.isType.textBox(f[x])||TRIANGLE.isType.imageItem(f[x])||TRIANGLE.isType.formBtn(f[x])||TRIANGLE.isType.snippetItem(f[x]))b[c].children[m].innerHTML=f[x].innerHTML.replace(/&nbsp;/g,encodeURIComponent("&nbsp;"));b[c].children[m].src=f[x].src;b[c].children[m].children=f[x].querySelector(".templateItem")?1:0;b[c].children[m].childof=g[f[x].getAttribute("childof")];
b[c].children[m].nextSib=d&&TRIANGLE.isType.templateItem(d)?c+(x+1):0;b[c].children[m].prevSib=e&&TRIANGLE.isType.templateItem(e)?g[e.id]:0;b[c].children[m].isLastChild=!d||d&&!TRIANGLE.isType.templateItem(d)?1:0;b[c].children[m]["item-align"]=f[x].getAttribute("item-align");b[c].children[m]["hover-style"]=f[x].getAttribute("hover-style");b[c].children[m]["link-to"]=f[x].getAttribute("link-to");b[c].children[m].onClick=f[x].getAttribute("onclick");b[c].children[m]["crop-map"]=f[x].getAttribute("crop-map");
b[c].children[m]["crop-ratio"]=f[x].getAttribute("crop-ratio");b[c].children[m].target=f[x].getAttribute("target");b[c].children[m].ecommerce=encodeURIComponent(f[x].getAttribute("ecommerce"));b[c].children[m]["form-email"]=f[x].getAttribute("form-email");b[c].children[m].responsive=[f[x].style.width,f[x].getBoundingClientRect().width,f[x].getBoundingClientRect().top]}}}a=JSON.stringify(b);AJAX.post("scripts/saveUserIDs.php","instance="+TRIANGLE.instance+"&content="+a,function(a){})},saveUserClasses:function(){var a=
document.getElementById("template").querySelectorAll("[user-class]");if(a){var b=[];for(k=i=0;i<a.length;i++){var c=a[i].getAttribute("user-class");c&&-1===b.indexOf(c)&&(b[k]=c,k++)}a={};for(i=0;i<b.length;i++)c=document.getElementById("template").querySelector("[user-class="+b[i]+"]").style.cssText,a[b[i]]=c;b=JSON.stringify(a);AJAX.post("scripts/saveUserClasses.php","instance="+TRIANGLE.instance+"&content="+b,function(a){})}},saveAll:function(){console.log("saving all...");var a=document.getElementById("echoPageList").querySelectorAll(".pageThumbnail");
for(i=0;i<a.length;i++){var b=a[i].innerHTML;console.log(b);setTimeout(function(a){TRIANGLE.loadTemplate.loadTemplate(TRIANGLE.currentTemplate,a);console.log(a);setTimeout(TRIANGLE.saveTemplate.saveCurrent,1E3)},3E3*i,b)}},newPage:null,createNewPage:function(a){var b=document.getElementById("newPageNameInput");""!==b.value?(a=b.value,TRIANGLE.saveTemplate.saveCurrent(),AJAX.get("scripts/createPage.php","instance="+TRIANGLE.instance+"&pageName="+a,function(a){console.log(a.responseText)}),document.getElementById("createNewPage").style.display=
"none",b.value="",TRIANGLE.menu.closeSideMenu(),TRIANGLE.saveTemplate.newPage=a,setTimeout(function(){TRIANGLE.loadTemplate.loadTemplate(TRIANGLE.currentTemplate,TRIANGLE.saveTemplate.newPage)},500)):(TRIANGLE.error("Please enter a page name"),b.focus())}};
TRIANGLE.loadTemplate={getLoadList:function(){AJAX.get("scripts/loadList.php","",function(a){document.getElementById("echoLoadList").innerHTML=a.responseText;a=document.getElementById("echoLoadList").querySelectorAll(".loadListItem");for(i=0;i<a.length;i++)a[i].style.backgroundColor=""!==TRIANGLE.currentTemplate&&a[i].innerHTML==TRIANGLE.currentTemplate?"#dce5ee":""})},loadTemplate:function(a,b){var c="";b&&"string"==typeof b?c="&pageName="+b:"object"!=typeof b&&(b="");AJAX.post("scripts/loadTemplate.php",
"templateName="+a+c+"&instance="+TRIANGLE.instance,function(c){"none"===document.getElementById("loadingCell").style.display&&TRIANGLE.popUp.close();document.getElementById("loadTemplatesCell").style.display="none";TRIANGLE.template.blank();c=TRIANGLE.json.decompress(c.responseText);TRIANGLE.json.decode(c);TRIANGLE.library.loadUserIDs();TRIANGLE.updateTemplateItems();TRIANGLE.loadTemplate.updateUserIDs();"trianglecms.com"==location.host&&(document.getElementById("template").innerHTML=document.getElementById("template").innerHTML.replace(/http:\/\/(localhost|braydengregerson\.com)\/triangle/g,
"http://trianglecms.com"));TRIANGLE.updateTemplateItems();TRIANGLE.loadTemplate.updateUserClasses();TRIANGLE.updateTemplateItems();TRIANGLE.clearSelection();TRIANGLE.colors.updateBodyBg();TRIANGLE.pages.loadPages(a);TRIANGLE.dragDrop.updateItemMap();document.getElementById("saveCurrentTemplate").parentNode.style.display="";document.getElementById("saveNewPage").parentNode.style.display="";TRIANGLE.currentTemplate=a;TRIANGLE.currentPage=b;setTimeout(TRIANGLE.updateTemplateItems,100);document.getElementById("FTPselect").selectedIndex=
0;TRIANGLE.options.compareUndoList()})},cancelLoad:function(){TRIANGLE.popUp.close()},updateUserIDs:function(){AJAX.post("scripts/readUserIDs.php","instance="+TRIANGLE.instance,function(a){if(a.responseText){a=JSON.parse(a.responseText);var b=document.getElementById("template").querySelectorAll("[update-user-id]"),c={};for(i=0;i<b.length;i++)c[b[i].getAttribute("update-user-id")]=i;for(var d in a){if(isNaN(c[d]))if(TRIANGLE.getElementByUserId(d))var e=TRIANGLE.getElementByUserId(d);else continue;
else e=b[parseInt(c[d])];var g=document.createElement(a[d].tagName);g.id=a[d].id;g.setAttribute("user-id",d);g=TRIANGLE.json.convertItem(a[d],g);e.parentNode.insertBefore(g,e);e.parentNode.removeChild(e);e=a[d].children;for(var f in e){g=document.createElement(e[f].tagName);g.id=f;e[f]["user-id"]?g.setAttribute("user-id",e[f]["user-id"]):null;g=TRIANGLE.json.convertItem(e[f],g);var m=e[f].childof;m&&document.getElementById(m).appendChild(g)}TRIANGLE.updateTemplateItems()}TRIANGLE.updateTemplateItems()}})},
updateUserIDsOld:function(){AJAX.post("scripts/readUserIDs.php","instance="+TRIANGLE.instance,function(a){if(a.responseText){a=JSON.parse(a.responseText);for(var b in a){var c=TRIANGLE.getElementByUserId(b);if(c){var d=document.createElement(a[b].tagName);d.id=a[b].id;d.setAttribute("user-id",b);d=TRIANGLE.json.convertItem(a[b],d);c.parentNode.insertBefore(d,c);c.parentNode.removeChild(c);c=a[b].children;for(var e in c){d=document.createElement(c[e].tagName);d.id=e;c[e]["user-id"]?d.setAttribute("user-id",
c[e]["user-id"]):null;d=TRIANGLE.json.convertItem(c[e],d);var g=c[e].childof;g&&document.getElementById(g).appendChild(d)}TRIANGLE.updateTemplateItems()}}TRIANGLE.updateTemplateItems()}})},updateUserClasses:function(){AJAX.post("scripts/readUserClasses.php","instance="+TRIANGLE.instance,function(a){if(a.responseText){a=JSON.parse(a.responseText);TRIANGLE.userClasses=a;for(var b in a){var c=document.getElementById("template").querySelectorAll("[user-class="+b+"]");for(i=0;i<c.length;i++)c[i].style.cssText=
a[b]}}})},importWebsite:function(a){TRIANGLE.popUp.close();if(!a||a&&"string"!==typeof a)a=document.getElementById("importWebsiteURL").value;TRIANGLE.importWebsiteURL=a;AJAX.get("scripts/importWebsite.php","url="+encodeURIComponent(a),function(b){if(b.responseText){var c=b.responseText;b=document.getElementById("importWebsite");b.innerHTML=c;c=b.querySelector("title");document.getElementById("metaTitle").value=TRIANGLE.metaData.title=c.innerHTML;c=b.querySelectorAll("link");for(i=0;i<c.length;i++)c[i].getAttribute("defer")&&
(c[i].setAttribute("href",c[i].getAttribute("defer")),c[i].removeAttribute("defer"));b=b.querySelectorAll("img");for(i=0;i<b.length;i++)b[i].getAttribute("lazyload")&&(b[i].src=b[i].getAttribute("lazyload"),b[i].removeAttribute("lazyload")),c="/"===b[i].getAttribute("src")[0]?"":"/",b[i].src=a+c+b[i].getAttribute("src")}})}};
TRIANGLE.json={encode:function(){var a={};a.hoverData=document.getElementById("hoverData").innerHTML;a.hoverItems=document.getElementById("hoverItems").innerHTML;a.animationData=document.getElementById("animationData").innerHTML;a.bodyBgData=document.getElementById("bodyBgData").style.cssText;a.fontData=document.getElementById("fontData").innerHTML;a.metaTitle=TRIANGLE.metaData.title;a.metaKeywords=TRIANGLE.metaData.keywords;a.metaDescription=TRIANGLE.metaData.description;a.fixedWidth=document.getElementById("template").style.width;
a.businessProfile=document.getElementById("businessProfile").value;a.exportCompress=document.getElementById("exportCompress").checked;a.importWebsiteURL=TRIANGLE.importWebsiteURL;a.styleTag=TRIANGLE.developer.styleTagContent;a.scriptTag=TRIANGLE.developer.scriptTagContent;a.imageList={itemNums:[],paths:[],dimensions:[]};var b=document.getElementById("template").querySelectorAll(".imageItem[crop-map]"),c=b.length;for(i=0;i<c;i++){TRIANGLE.sv_item=new TRIANGLE.TemplateItem(b[i].getAttribute("index"));
a.imageList.itemNums[i]=TRIANGLE.sv_item.index;a.imageList.paths[i]=TRIANGLE.sv_item.image.src;var d=TRIANGLE.sv_item.objRef.getBoundingClientRect(),e=TRIANGLE.sv_item.image.getBoundingClientRect();a.imageList.dimensions[i]=[d.width/e.width,d.height/e.height,(d.left-e.left)/e.width,(d.top-e.top)/e.height]}a.items={};b=[];for(i=0;i<TRIANGLE.templateItems.length;i++)if(TRIANGLE.sv_item=new TRIANGLE.TemplateItem(i),!(-1<b.indexOf(TRIANGLE.sv_item.id)))if(c="item"+i,TRIANGLE.sv_item.userID)for(a.items[c]=
TRIANGLE.sv_item.userID,"template"!==TRIANGLE.sv_item.parent.id&&(a.items[c]+=" "+TRIANGLE.sv_item.parent.id),c=TRIANGLE.sv_item.objRef.querySelectorAll("*"),x=0;x<c.length;x++)b.push(c[x].getAttribute("id"));else{a.items[c]={};a.items[c]["user-class"]=TRIANGLE.sv_item.userClass;a.items[c].tagName=TRIANGLE.sv_item.tag;a.items[c].className=TRIANGLE.sv_item.className;a.items[c].name=TRIANGLE.sv_item.objRef.getAttribute("name");a.items[c].style=TRIANGLE.sv_item.objRef.style.cssText;a.items[c].clearFloat=
TRIANGLE.isType.clearFloat(TRIANGLE.sv_item.objRef.nextSibling)?1:0;if(TRIANGLE.isType.textBox(TRIANGLE.sv_item.objRef)||TRIANGLE.isType.imageItem(TRIANGLE.sv_item.objRef)||TRIANGLE.isType.formBtn(TRIANGLE.sv_item.objRef)||TRIANGLE.isType.snippetItem(TRIANGLE.sv_item.objRef))a.items[c].innerHTML=TRIANGLE.sv_item.objRef.innerHTML.replace(/&nbsp;/g," ");a.items[c].src=TRIANGLE.sv_item.objRef.src;a.items[c].children=TRIANGLE.sv_item.objRef.querySelector(".templateItem")?1:0;a.items[c].childof=TRIANGLE.sv_item.childOf;
a.items[c].nextSib=TRIANGLE.sv_item.nextSibling()?TRIANGLE.sv_item.nextSibling().id:0;a.items[c].prevSib=TRIANGLE.sv_item.prevSibling()?TRIANGLE.sv_item.prevSibling().id:0;a.items[c].isLastChild=TRIANGLE.sv_item.isLastChild;a.items[c]["item-align"]=TRIANGLE.sv_item.align;a.items[c]["hover-style"]=TRIANGLE.sv_item.hover.cssText;a.items[c]["link-to"]=TRIANGLE.sv_item.linkTo;a.items[c].onClick=TRIANGLE.sv_item.objRef.getAttribute("onclick");a.items[c]["crop-map"]=TRIANGLE.sv_item.cropMap;a.items[c]["crop-ratio"]=
TRIANGLE.sv_item.cropRatio;a.items[c].target=TRIANGLE.sv_item.objRef.getAttribute("target");a.items[c].ecommerce=encodeURIComponent(TRIANGLE.sv_item.objRef.getAttribute("ecommerce"));TRIANGLE.isType.addToCartBtn(TRIANGLE.sv_item.objRef)&&(a.items[c].addToCart=TRIANGLE.sv_item.ecom.itemID);a.items[c]["form-email"]=TRIANGLE.sv_item.objRef.getAttribute("form-email")}a.responsiveItems=TRIANGLE.responsive.prepare();return JSON.stringify(a)},decode:function(a){a=JSON.parse(a);TRIANGLE.json.convertTemplateData(a);
a=a.items;for(var b in a)if("string"==typeof a[b]){var c=a[b].split(" "),d=document.createElement("div");d.setAttribute("update-user-id",c[0]);c[1]?document.getElementById(c[1]).appendChild(d):document.getElementById("template").appendChild(d)}else d=document.createElement(a[b].tagName),d.id=b,a[b]["user-id"]&&d.setAttribute("user-id",a[b]["user-id"]),d=TRIANGLE.json.convertItem(a[b],d),(c=a[b].childof)&&document.getElementById(c)?document.getElementById(c).appendChild(d):(!c||document.getElementById(c))&&
document.getElementById("template").appendChild(d)},decodeOld:function(a){a=JSON.parse(a);TRIANGLE.json.convertTemplateData(a);a=a.items;for(var b in a){var c=document.createElement(a[b].tagName);c.id=b;a[b]["user-id"]?c.setAttribute("user-id",a[b]["user-id"]):null;c=TRIANGLE.json.convertItem(a[b],c);var d=a[b].childof;d?document.getElementById(d).appendChild(c):document.getElementById("template").appendChild(c)}},toHTML:function(a){document.getElementById("JSONtoHTML").innerHTML="";a=JSON.parse(a);
for(var b in a){var c=document.createElement(a[b].tagName);c.id=a[b].id;c.setAttribute("user-id",b);c=TRIANGLE.json.convertItem(a[b],c);document.getElementById("JSONtoHTML").appendChild(c);c=a[b].children;for(var d in c){var e=document.createElement(c[d].tagName);e.id=d;c[d]["user-id"]?e.setAttribute("user-id",c[d]["user-id"]):null;e=TRIANGLE.json.convertItem(c[d],e);var g=c[d].childof;g&&document.getElementById("JSONtoHTML").querySelector("#"+g).appendChild(e)}}return document.getElementById("JSONtoHTML").innerHTML},
convertTemplateData:function(a){document.getElementById("hoverData").innerHTML=a.hoverData;document.getElementById("hoverItems").innerHTML=a.hoverItems;document.getElementById("animationData").innerHTML=a.hoverItems;document.getElementById("bodyBgData").style.cssText=a.bodyBgData;document.getElementById("fontData").innerHTML=a.fontData;document.getElementById("template").style.width=a.fixedWidth;"px"===TRIANGLE.getUnit(a.fixedWidth)&&(document.getElementById("template").style.margin="0 auto");document.getElementById("metaTitle").value=
a.metaTitle?a.metaTitle:"";TRIANGLE.metaData.title=document.getElementById("metaTitle").value;document.getElementById("metaKeywords").value=a.metaKeywords?a.metaKeywords:"";TRIANGLE.metaData.keywords=document.getElementById("metaKeywords").value;document.getElementById("metaDescription").value=a.metaDescription?a.metaDescription:"";TRIANGLE.metaData.description=document.getElementById("metaDescription").value;a.businessProfile&&(document.getElementById("businessProfile").value=a.businessProfile);
document.getElementById("exportCompress").checked=a.exportCompress;a.importWebsiteURL&&TRIANGLE.loadTemplate.importWebsite(a.importWebsiteURL);TRIANGLE.developer.styleTagContent=document.getElementById("styleTag").value=a.styleTag?a.styleTag:"";TRIANGLE.developer.globalStyleTagContent=document.getElementById("globalStyleTag").value=a.globalStyleTag?a.globalStyleTag:"";TRIANGLE.developer.scriptTagContent=document.getElementById("scriptTag").value=a.scriptTag?a.scriptTag:"";TRIANGLE.developer.globalScriptTagContent=
document.getElementById("globalScriptTag").value=a.globalScriptTag?a.globalScriptTag:""},convertItem:function(a,b){b.className=a.className;a["user-class"]?b.setAttribute("user-class",a["user-class"]):null;a.name?b.setAttribute("name",a.name):null;b.style.cssText=a.style;b.innerHTML=a.innerHTML?a.innerHTML:"";b.src=a.src?a.src:"";a["item-align"]?b.setAttribute("item-align",a["item-align"]):null;a["hover-style"]?b.setAttribute("hover-style",a["hover-style"]):null;a["link-to"]?b.setAttribute("link-to",
a["link-to"]):null;a.onClick?b.setAttribute("onClick",a.onClick):null;a["crop-map"]?b.setAttribute("crop-map",a["crop-map"]):null;a["crop-ratio"]?b.setAttribute("crop-ratio",a["crop-ratio"]):null;a.target?b.setAttribute("target",a.target):null;a.ecommerce&&"null"!==a.ecommerce?b.setAttribute("ecommerce",decodeURIComponent(a.ecommerce)):null;a["form-email"]?b.setAttribute("form-email",a["form-email"]):null;return b},toNVP:function(a){a=JSON.parse(a);var b="",c;for(c in a)b+=c+":"+a[c]+";";return b},
readNVP:function(a){a=a.split(";");var b={};for(i=0;i<a.length;i++){var c=a[i].split(":");b[c[0]]=c[1]}return JSON.stringify(b)},compress:function(a){a=JSON.parse(a);for(var b in a.items)if("string"!=typeof a.items[b]){for(var c in TRIANGLE.json.compressionMap)a.items[b].style=a.items[b].style.replace(c+":","%"+TRIANGLE.json.compressionMap[c]);var d=a.items[b].style,e=d.split(";");for(i=0;i<e.length;i++)e[i]=e[i].trim();for(var g in a.items){if(a.items[b]===a.items[g])break;var f=a.items[g].style;
if(f){f=f.split(";");for(i=0;i<f.length;i++)f[i]=f[i].trim();if(e.sort().toString()===f.sort().toString()){d=g;break}}}a.items[b].style=d}for(b in a.responsiveItems){c=a.responsiveItems[b];for(g in a.responsiveItems){if(a.responsiveItems[b]===a.responsiveItems[g])break;d=a.responsiveItems[g];if(JSON.stringify(c)===JSON.stringify(d)){c=g;break}}a.responsiveItems[b]=c}return JSON.stringify(a)},decompress:function(a){a=JSON.parse(a);for(var b in a.items)if("string"!=typeof a.items[b]){var c=a.items[b].style;
a.items[c]&&(a.items[b].style=a.items[c].style);for(var d in TRIANGLE.json.compressionMap)a.items[b].style=a.items[b].style.replace("%"+TRIANGLE.json.compressionMap[d],d+":")}return JSON.stringify(a)},compressionMap:{"background-color":"bC","background-image":"bI","background-size":"bSz",background:"bg","min-height":"mH",height:"h","max-width":"mW",width:"w",display:"d",position:"po","float":"cF",overflow:"o","vertical-align":"vA",padding:"p",margin:"m","box-shadow":"bS","border-radius":"bR","border-width":"bW",
border:"b",left:"L",right:"R",top:"T",bottom:"B",color:"c","font-size":"fS","line-height":"lH","text-align":"tA","font-family":"fF","text-decoration":"tD"}};
TRIANGLE.pages={loadPages:function(a,b){a||(a="");var c="templateName="+encodeURIComponent(a)+"&listType="+b+"&instance="+TRIANGLE.instance;AJAX.get("scripts/pageList.php",c,function(a){if("menu"==b)for(document.getElementById("echoPageList").innerHTML=a.responseText,a=document.getElementById("echoPageList").querySelectorAll(".pageThumbnail"),i=0;i<a.length;i++)a[i].style.backgroundColor=""!==TRIANGLE.currentPage&&a[i].innerHTML==TRIANGLE.currentPage?"#dce5ee":"";else document.getElementById("hyperlinkPage").innerHTML=
'<option value="default" selected="selected">- Select a page -</option>'+a.responseText})},confirmDeletePage:function(a){document.getElementById("confirmDeletePage").innerHTML=a;document.getElementById("confirmDeletePageBtn").setAttribute("onClick","TRIANGLE.pages.deletePage('"+a+"');");TRIANGLE.popUp.open("deletePageCell")},deletePage:function(a){AJAX.get("scripts/deletePage.php","instance="+TRIANGLE.instance+"&page="+a,function(b){if(parseInt(b.responseText)){b=document.getElementsByClassName("pageThumbnail");
for(i=0;i<b.length;i++)if(b[i].innerHTML===a){b[i].className+=" fadeOut";b[i].nextSibling.className+=" fadeOut";var c=b[i];setTimeout(function(){c.parentNode.removeChild(c.nextSibling);c.parentNode.removeChild(c)},200);break}(TRIANGLE.currentPage=a)&&TRIANGLE.loadTemplate.loadTemplate(TRIANGLE.currentTemplate,"index");TRIANGLE.popUp.close()}else TRIANGLE.error("Error deleting page")})}};
TRIANGLE.responsive={prepare:function(){var a={};for(i=0;i<TRIANGLE.templateItems.length;i++){var b=TRIANGLE.templateItems[i],c=b.getBoundingClientRect();a[b.id]=[b.style.width,Math.round(1E4*c.width)/1E4,c.top]}return a}};
TRIANGLE.defaultSettings=function(){TRIANGLE.colors.updateBodyBg();TRIANGLE.menu.displaySubMenu("displayGeneralOptions");TRIANGLE.menu.addMenuBtnEvent();TRIANGLE.menu.menuBtnActive(document.getElementById("opGeneralOptions"));TRIANGLE.menu.addOptionLabelEvents();document.getElementById("colorMainBg").style.backgroundColor=document.body.style.backgroundColor;document.getElementById("templateWrapper").addEventListener("mousedown",TRIANGLE.clearSelection,!0);document.getElementById("bottomMarker").addEventListener("mousedown",
TRIANGLE.clearSelection,!0);document.getElementById("templateWrapper").addEventListener("mouseup",TRIANGLE.text.checkTextEditing,!0);document.getElementById("bottomMarker").addEventListener("mouseup",TRIANGLE.text.checkTextEditing,!0);document.body.addEventListener("mouseover",TRIANGLE.hoverBorder.hide,!0);TRIANGLE.ecommerce.shipping.settings=TRIANGLE.savedShippingSetup;TRIANGLE.ecommerce.shipping.loadSetup(TRIANGLE.ecommerce.shipping.settings);document.addEventListener("scroll",function(){TRIANGLE.hoverBorder.hide();
TRIANGLE.selectionBorder.update();TRIANGLE.dragDrop.updateItemMap()});document.addEventListener("keyup",function(a){TRIANGLE.keyEvents.whichKey.document(a);setTimeout(TRIANGLE.options.compareUndoList,330)});document.addEventListener("mouseup",function(){TRIANGLE.dragDrop.stop();setTimeout(TRIANGLE.options.compareUndoList,330)});document.addEventListener("mouseup",function(){TRIANGLE.item&&TRIANGLE.item.objRef.isContentEditable&&(TRIANGLE.text.originalTextPosition=TRIANGLE.text.getSelectionCoords().r)});
document.addEventListener("keydown",function(a){document.getElementById("updateAnimation").innerHTML="";a.ctrlKey&&83===a.keyCode&&a.preventDefault();TRIANGLE.item&&TRIANGLE.item.objRef.isContentEditable||!a.ctrlKey||90!==a.keyCode||a.preventDefault();a.ctrlKey&&86==a.keyCode&&TRIANGLE.item&&TRIANGLE.item.objRef.isContentEditable&&(TRIANGLE.text.originalTextPosition=TRIANGLE.text.getSelectionCoords().r)});window.addEventListener("resize",TRIANGLE.selectionBorder.update);TRIANGLE.images.load();TRIANGLE.library.load();
TRIANGLE.colors.fillCanvas("red");TRIANGLE.colors.setColorBoxEvents();document.getElementById("colorPaletteBar").addEventListener("mousedown",TRIANGLE.colors.dragPalette.initiate,!0);TRIANGLE.images.crop.addHandleEventListeners();var a=document.createElement("div");a.className="scrollbar-measure";document.body.appendChild(a);TRIANGLE.scrollbarWidth=a.offsetWidth-a.clientWidth;document.body.removeChild(a);document.body.addEventListener("mousedown",function(a){"img"===a.target.tagName.toLowerCase()&&
a.preventDefault()});a=function(a){a=a||window.event;for(var b=a.target||a.srcElement;b.tagName&&"a"!=b.tagName.toLowerCase()&&!TRIANGLE.isType.textBox(b);)b=b.parentNode;if(b.tagName&&"a"===b.tagName.toLowerCase()&&(a.preventDefault||(a.returnValue=!1,a.cancelBubble=!0),a.preventDefault(),a.stopPropagation(),TRIANGLE.text.importedHyperlink=b,TRIANGLE.item)){document.getElementById("hrefHyperlink").disabled=!1;document.getElementById("hrefHyperlink").value=TRIANGLE.text.importedHyperlink.getAttribute("href");
a=document.getElementById("hrefTarget");a.disabled=!1;b=TRIANGLE.text.importedHyperlink.getAttribute("target");var d=0;for(i=0;i<a.length;i++)b===a.options[i].text&&(d=i);a.selectedIndex=d}};window.addEventListener?document.getElementById("template").addEventListener("click",a,!1):document.getElementById("template").attachEvent("onclick",a);window.onbeforeunload=function(){if(TRIANGLE.unsaved)return"Changes you made may not be saved"}};TRIANGLE.defaultSettings();
TRIANGLE.popUp={open:function(a){var b=document.getElementsByClassName("popUp");for(i=0;i<b.length;i++)b[i].style.display="none";document.getElementById("darkWrapper").style.display="table";document.getElementById(a).style.display="table-cell";document.getElementById("darkWrapper").className="fadeIn"},close:function(){document.getElementById("darkWrapper").style.display="none";var a=document.getElementsByClassName("popUp");for(i=0;i<a.length;i++)a[i].style.display="none"}};
TRIANGLE.error=function(a,b){document.getElementById("errorMsg").innerHTML="";a&&b&&"string"==typeof a&&"string"==typeof b?(document.getElementById("errorTitle").innerHTML=a,document.getElementById("errorMsg").innerHTML=b):a&&(b=a,a="Error",document.getElementById("errorTitle").innerHTML=a,document.getElementById("errorMsg").innerHTML=b);TRIANGLE.popUp.open("errorCell")};
